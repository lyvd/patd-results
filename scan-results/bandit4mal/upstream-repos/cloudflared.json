{
  "errors": [
    {
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\vendor\\github.com\\google\\gopacket\\layers\\test_creator.py",
      "reason": "syntax error while parsing AST from file"
    }
  ],
  "generated_at": "2024-10-27T17:09:03Z",
  "metrics": {
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\cli.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 100,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\config.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 74,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\conftest.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 49,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\constants.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 8,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\setup.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 116,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_config.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 48,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_edge_discovery.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 144,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_logging.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 81,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py": {
      "CONFIDENCE.HIGH": 9,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 9,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 90,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_pq.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 14,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_proxy_dns.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 47,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_quicktunnels.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 31,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_reconnect.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 39,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py": {
      "CONFIDENCE.HIGH": 13,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 13,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 128,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 161,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_termination.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 94,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_token.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 23,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tunnel.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 38,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 136,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\github_message.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 2,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 139,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\github_release.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 2,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 253,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py": {
      "CONFIDENCE.HIGH": 11,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 11,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 322,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\ssh_server_tests\\tests.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 1,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 150,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\vendor\\github.com\\google\\gopacket\\layers\\test_creator.py": {
      "loc": 80,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\cloudflared\\vendor\\github.com\\urfave\\cli\\v2\\altsrc\\fg.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 36,
      "nosec": 0,
      "skipped_tests": 0
    },
    "_totals": {
      "CONFIDENCE.HIGH": 84,
      "CONFIDENCE.LOW": 3,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 3,
      "SEVERITY.LOW": 81,
      "SEVERITY.MEDIUM": 3,
      "SEVERITY.UNDEFINED": 0,
      "loc": 2401,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "1 import json\n2 import subprocess\n3 from time import sleep\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 2,
      "line_range": [
        2
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "68         self.basecmd += [\"run\"]\n69         self.process = subprocess.Popen(self.basecmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n70         self.logger.info(f\"Run cmd {self.basecmd}\")\n",
      "col_offset": 23,
      "end_col_offset": 101,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 69,
      "line_range": [
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "116     try:\n117         result = subprocess.run(cmd, **kargs)\n118         logger.debug(f\"{cmd} log: {result.stdout}\", extra={\"cmd\": cmd_name})\n",
      "col_offset": 17,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 117,
      "line_range": [
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "5 import os\n6 import subprocess\n7 import uuid\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\setup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 6,
      "line_range": [
        6
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "56     LOGGER.info(f\"Creating tunnel with {create_cmd}\")\n57     subprocess.run(create_cmd, check=True)\n58 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\setup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "61     LOGGER.info(f\"Listing tunnel with {list_cmd}\")\n62     cloudflared = subprocess.run(list_cmd, check=True, capture_output=True)\n63     return json.loads(cloudflared.stdout)[0][\"id\"]\n",
      "col_offset": 18,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\setup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "71     LOGGER.info(f\"Deleting tunnel with {delete_cmd}\")\n72     subprocess.run(delete_cmd, check=True)\n73 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\setup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "56 \n57         assert f\"Matched rule #{rule_num}\" .encode() in match_rule.stdout\n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "87                 (c for c in info[\"conns\"] if c[\"id\"] == connector_id), None)\n88             assert connector, f\"Expected connection info from get tunnel info for the connected instance: {info}\"\n89             conns = connector[\"conns\"]\n",
      "col_offset": 12,
      "end_col_offset": 113,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_edge_discovery.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 88,
      "line_range": [
        88
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89             conns = connector[\"conns\"]\n90             assert conns == None or len(\n91                 conns) == 4, f\"There should be 4 connections registered: {conns}\"\n92             for conn in conns:\n",
      "col_offset": 12,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_edge_discovery.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90,
        91
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "93                 origin_ip = conn[\"origin_ip\"]\n94                 assert origin_ip, f\"No available origin_ip for this connection: {conn}\"\n95                 assert_address_type(origin_ip)\n",
      "col_offset": 16,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_edge_discovery.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "97     def expect_ipv4_address(self, address):\n98         assert type(ipaddress.ip_address(\n99             address)) is ipaddress.IPv4Address, f\"Expected connection from origin to be a valid IPv4 address: {address}\"\n100 \n",
      "col_offset": 8,
      "end_col_offset": 120,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_edge_discovery.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 98,
      "line_range": [
        98,
        99
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "101     def expect_ipv6_address(self, address):\n102         assert type(ipaddress.ip_address(\n103             address)) is ipaddress.IPv6Address, f\"Expected connection from origin to be a valid IPv6 address: {address}\"\n104 \n",
      "col_offset": 8,
      "end_col_offset": 120,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_edge_discovery.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 102,
      "line_range": [
        102,
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "110             \"region1.v2.argotunnel.com\", 7844, socket.AF_UNSPEC, socket.SOCK_STREAM)\n111         assert len(\n112             host_addresses) > 0, \"No addresses returned from getaddrinfo\"\n113         return host_addresses\n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_edge_discovery.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 111,
      "line_range": [
        111,
        112
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "36     def assert_in_json(j, key):\n37         assert key in j, f\"{key} is not in j\"\n38 \n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_logging.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 37,
      "line_range": [
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "57             stats = os.stat(current_file)\n58             assert stats.st_size > 0\n59             assert_json_log(current_file)\n",
      "col_offset": 12,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_logging.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 58,
      "line_range": [
        58
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "64             stats = os.stat(rotated_file)\n65             assert stats.st_size > rotate_after_size\n66             assert_log_in_file(rotated_file)\n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_logging.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 65,
      "line_range": [
        65
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "41             # Assert response json.\n42             assert resp.status_code == 200, \"Expected cloudflared to return 200 for host details\"\n43             assert resp.json()[\"hostname\"] == \"custom:test\", \"Expected cloudflared to return hostname\"\n",
      "col_offset": 12,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 42,
      "line_range": [
        42
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "42             assert resp.status_code == 200, \"Expected cloudflared to return 200 for host details\"\n43             assert resp.json()[\"hostname\"] == \"custom:test\", \"Expected cloudflared to return hostname\"\n44             assert resp.json()[\"ip\"] != \"\", \"Expected cloudflared to return ip\"\n",
      "col_offset": 12,
      "end_col_offset": 102,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 43,
      "line_range": [
        43
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "43             assert resp.json()[\"hostname\"] == \"custom:test\", \"Expected cloudflared to return hostname\"\n44             assert resp.json()[\"ip\"] != \"\", \"Expected cloudflared to return ip\"\n45             assert resp.json()[\"connector_id\"] == connector_id, \"Expected cloudflared to return connector_id\"\n",
      "col_offset": 12,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 44,
      "line_range": [
        44
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44             assert resp.json()[\"ip\"] != \"\", \"Expected cloudflared to return ip\"\n45             assert resp.json()[\"connector_id\"] == connector_id, \"Expected cloudflared to return connector_id\"\n46     \n",
      "col_offset": 12,
      "end_col_offset": 109,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "64             # Assert response.\n65             assert resp.status_code == 200, \"Expected cloudflared to return 200 for /metrics\"\n66             assert \"# HELP build_info Build and version information\" in resp.text, \"Expected /metrics to have with the build_info details\"\n",
      "col_offset": 12,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 65,
      "line_range": [
        65
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "65             assert resp.status_code == 200, \"Expected cloudflared to return 200 for /metrics\"\n66             assert \"# HELP build_info Build and version information\" in resp.text, \"Expected /metrics to have with the build_info details\"\n67 \n",
      "col_offset": 12,
      "end_col_offset": 138,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 66,
      "line_range": [
        66
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "85             # Assert response.\n86             assert resp.status_code == 200, \"Expected cloudflared to return 200 for /debug/pprof/heap\"\n87             assert resp.headers[\"Content-Type\"] == \"application/octet-stream\", \"Expected /debug/pprof/heap to have return a binary response\"\n",
      "col_offset": 12,
      "end_col_offset": 102,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 86,
      "line_range": [
        86
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "86             assert resp.status_code == 200, \"Expected cloudflared to return 200 for /debug/pprof/heap\"\n87             assert resp.headers[\"Content-Type\"] == \"application/octet-stream\", \"Expected /debug/pprof/heap to have return a binary response\"\n88     \n",
      "col_offset": 12,
      "end_col_offset": 140,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 87,
      "line_range": [
        87
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "106             # Assert response.\n107             assert resp.status_code == 404, \"Expected cloudflared to return 404 for /metrics\"\n108 \n",
      "col_offset": 12,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_management.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 107,
      "line_range": [
        107
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "34     else:\n35         assert False, f\"Unknown cfd_mode {cfd_mode}\"\n36 \n",
      "col_offset": 8,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_proxy_dns.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 35,
      "line_range": [
        35
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55         if should_be_running:\n56             assert False, \"Expected Proxy DNS to be running, but it was not.\"\n57         had_failure = True\n",
      "col_offset": 12,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_proxy_dns.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "61     if not should_be_running and not had_failure:\n62         assert False, \"Proxy DNS should not have been running, but it was.\"\n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_proxy_dns.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "29         failed_start = start_cloudflared(tmp_path, config, cfd_args=[\"--url\", f\"http://localhost:{METRICS_PORT}/\"], expect_success=False)\n30         assert failed_start.returncode == 1, \"Expected cloudflared to fail to run with `proxy-dns` and `hello-world`\"\n31     \n",
      "col_offset": 8,
      "end_col_offset": 117,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_quicktunnels.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 30,
      "line_range": [
        30
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "35         failed_start = start_cloudflared(tmp_path, config, cfd_args=[\"--hello-world\"], expect_success=False)\n36         assert failed_start.returncode == 1, \"Expected cloudflared to fail to run with `proxy-dns` and `url`\"\n",
      "col_offset": 8,
      "end_col_offset": 109,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_quicktunnels.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 36,
      "line_range": [
        36
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3 import pathlib\n4 import subprocess\n5 from contextlib import contextmanager\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 4,
      "line_range": [
        4
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "113             # We need the folder to have executable permissions for the \"stat\" command in the assertions to work.\n114             subprocess.check_call(['sudo', 'chmod', 'o+x', log_dir])\n115             test_logging.assert_log_to_dir(config, log_dir)\n",
      "col_offset": 12,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 114,
      "line_range": [
        114
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "113             # We need the folder to have executable permissions for the \"stat\" command in the assertions to work.\n114             subprocess.check_call(['sudo', 'chmod', 'o+x', log_dir])\n115             test_logging.assert_log_to_dir(config, log_dir)\n",
      "col_offset": 12,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 114,
      "line_range": [
        114
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "131         config_path = write_config(tmp_path, config.base_config())\n132         subprocess.run([\"sudo\", \"cp\", config_path, \"/etc/cloudflared/config.yml\"], check=True)\n133 \n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 132,
      "line_range": [
        132
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "131         config_path = write_config(tmp_path, config.base_config())\n132         subprocess.run([\"sudo\", \"cp\", config_path, \"/etc/cloudflared/config.yml\"], check=True)\n133 \n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 132,
      "line_range": [
        132
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "143         # Service install copies config file to /etc/cloudflared/config.yml\n144         subprocess.run([\"sudo\", \"rm\", \"/etc/cloudflared/config.yml\"])\n145         self.sysv_cmd(\"status\", success=False)\n",
      "col_offset": 8,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 144,
      "line_range": [
        144
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "143         # Service install copies config file to /etc/cloudflared/config.yml\n144         subprocess.run([\"sudo\", \"rm\", \"/etc/cloudflared/config.yml\"])\n145         self.sysv_cmd(\"status\", success=False)\n",
      "col_offset": 8,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 144,
      "line_range": [
        144
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "162     def launchctl_cmd(self, action, success=True):\n163         cmd = subprocess.run(\n164             [\"launchctl\", action, \"com.cloudflare.cloudflared\"], check=success)\n165         if not success:\n",
      "col_offset": 14,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 163,
      "line_range": [
        163,
        164
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "162     def launchctl_cmd(self, action, success=True):\n163         cmd = subprocess.run(\n164             [\"launchctl\", action, \"com.cloudflare.cloudflared\"], check=success)\n165         if not success:\n",
      "col_offset": 14,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 163,
      "line_range": [
        163,
        164
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "165         if not success:\n166             assert cmd.returncode != 0, f\"Expect {cmd.args} to fail, but it succeed\"\n167 \n",
      "col_offset": 12,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 166,
      "line_range": [
        166
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "168     def sysv_cmd(self, action, success=True):\n169         cmd = subprocess.run(\n170             [\"sudo\", \"service\", \"cloudflared\", action], check=success)\n171         if not success:\n",
      "col_offset": 14,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 169,
      "line_range": [
        169,
        170
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "168     def sysv_cmd(self, action, success=True):\n169         cmd = subprocess.run(\n170             [\"sudo\", \"service\", \"cloudflared\", action], check=success)\n171         if not success:\n",
      "col_offset": 14,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 169,
      "line_range": [
        169,
        170
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "171         if not success:\n172             assert cmd.returncode != 0, f\"Expect {cmd.args} to fail, but it succeed\"\n",
      "col_offset": 12,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_service.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 172,
      "line_range": [
        172
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "112                 count = await generate_and_validate_http_events(websocket, config.get_url(), 10)\n113                 assert count < (10 * 2) # There are typically always two log lines for http requests (request and response)\n114                 # send stop_streaming\n",
      "col_offset": 16,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 113,
      "line_range": [
        113
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132             await asyncio.wait([task, override_task])\n133             assert task.exception() == None, task.exception()\n134             assert override_task.exception() == None, override_task.exception()\n",
      "col_offset": 12,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "133             assert task.exception() == None, task.exception()\n134             assert override_task.exception() == None, override_task.exception()\n135 \n",
      "col_offset": 12,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 134,
      "line_range": [
        134
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "140             await asyncio.sleep(10)\n141             assert websocket.closed, \"expected this request to be forcibly closed by the override\"\n142         except websockets.ConnectionClosed:\n",
      "col_offset": 12,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 141,
      "line_range": [
        141
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "164             log_line = json.loads(req_line)\n165             assert log_line[\"type\"] == \"logs\"\n166             assert log_line[\"logs\"][0][\"event\"] == \"http\"\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 165,
      "line_range": [
        165
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "165             assert log_line[\"type\"] == \"logs\"\n166             assert log_line[\"logs\"][0][\"event\"] == \"http\"\n167             count += 1\n",
      "col_offset": 12,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 166,
      "line_range": [
        166
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "178         req_line = await asyncio.wait_for(websocket.recv(), 5)\n179         assert req_line == None, \"expected no logs for the specified filters\"\n180     except asyncio.TimeoutError:\n",
      "col_offset": 8,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 179,
      "line_range": [
        179
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "186         resp = s.get(url, timeout=BACKOFF_SECS, headers=headers)\n187         assert resp.status_code == 200, f\"{url} returned {resp}\"\n188         return resp.status_code == 200\n",
      "col_offset": 8,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 187,
      "line_range": [
        187
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91         thread.join(timeout)\n92         assert thread.is_alive() == False, \"eyeball thread is still alive\"\n93 \n",
      "col_offset": 8,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_termination.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "109             # Here we truncate to ensure that we don't fail on minute differences like 10.1 instead of 10\n110             assert minimum <= int(duration) <= self.grace_period\n111 \n",
      "col_offset": 12,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_termination.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 110,
      "line_range": [
        110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "126             # /sse returns count followed by 2 new lines\n127             assert lines >= (self.grace_period * 2)\n",
      "col_offset": 12,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_termination.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 127,
      "line_range": [
        127
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "15 \n16         assert parse_token(config.get_token()) == parse_token(output.stdout)\n17 \n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_token.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 16,
      "line_range": [
        16
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "26         with open(cred_file) as json_file:\n27             assert config.get_credentials_json() == json.load(json_file)\n28 \n",
      "col_offset": 12,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_token.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 27,
      "line_range": [
        27
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "36             resp = send_request(config.get_url()+\"/\")\n37             assert resp.status_code == 503, \"Expected cloudflared to return 503 for all requests with no ingress defined\"\n38             resp = send_request(config.get_url()+\"/test\")\n",
      "col_offset": 12,
      "end_col_offset": 121,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tunnel.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 37,
      "line_range": [
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "38             resp = send_request(config.get_url()+\"/test\")\n39             assert resp.status_code == 503, \"Expected cloudflared to return 503 for all requests with no ingress defined\"\n40 \n",
      "col_offset": 12,
      "end_col_offset": 121,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\test_tunnel.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 39,
      "line_range": [
        39
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3 import platform\n4 import subprocess\n5 from contextlib import contextmanager\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 4,
      "line_range": [
        4
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "56     # By setting check=True, it will raise an exception if the process exits with non-zero exit code\n57     return subprocess.run(cmd, check=expect_success, capture_output=capture_output)\n58 \n",
      "col_offset": 11,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "79     try:\n80         cfd = subprocess.Popen(cmd, stdin=stdin, stdout=output, stderr=output)\n81         yield cfd\n",
      "col_offset": 14,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 80,
      "line_range": [
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "94         hostname = resp.json()[\"hostname\"]\n95         assert hostname, \\\n96             f\"Quicktunnel endpoint returned {hostname} but we expected a url\"\n97 \n",
      "col_offset": 8,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 95,
      "line_range": [
        95,
        96
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "117 \n118         assert ready_connections >= require_min_connections, \\\n119             f\"Ready endpoint returned {resp.json()} but we expect at least {require_min_connections} connections\"\n120 \n",
      "col_offset": 8,
      "end_col_offset": 113,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 118,
      "line_range": [
        118,
        119
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "142         resp = requests.get(url, timeout=BACKOFF_SECS)\n143         assert resp.status_code == 503, f\"Expect {url} returns 503, got {resp.status_code}\"\n144         assert resp.json()[\n",
      "col_offset": 8,
      "end_col_offset": 91,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 143,
      "line_range": [
        143
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "143         assert resp.status_code == 503, f\"Expect {url} returns 503, got {resp.status_code}\"\n144         assert resp.json()[\n145             \"readyConnections\"] == 0, \"Expected all connections to be terminated (pending reconnect)\"\n146     # cloudflared might already terminate\n",
      "col_offset": 8,
      "end_col_offset": 101,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 144,
      "line_range": [
        144,
        145
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "179     if require_ok:\n180         assert resp.status_code == 200, f\"{url} returned {resp}\"\n181     return resp if resp.status_code == 200 else None\n",
      "col_offset": 8,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\component-tests\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 180,
      "line_range": [
        180
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "22     \"\"\" get the KV keys for a given prefix \"\"\"\n23     response = requests.get(\n24         BASE_KV_URL + account + \"/storage/kv/namespaces/\" +\n25         namespace + \"/keys\" + \"?prefix=\" + prefix,\n26         headers={\n27             \"Content-Type\": \"application/json\",\n28             \"Authorization\": \"Bearer \" + api_token,\n29         },\n30     )\n31     if response.status_code != 200:\n",
      "col_offset": 15,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\github_message.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 23,
      "line_range": [
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "40     \"\"\" get the KV value for a provided key \"\"\"\n41     response = requests.get(\n42         BASE_KV_URL + account + \"/storage/kv/namespaces/\" + namespace + \"/values/\" + key,\n43         headers={\n44             \"Content-Type\": \"application/json\",\n45             \"Authorization\": \"Bearer \" + api_token,\n46         },\n47     )\n48     if response.status_code != 200:\n",
      "col_offset": 15,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\github_message.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 41,
      "line_range": [
        41,
        42,
        43,
        44,
        45,
        46,
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "15 import re\n16 import subprocess\n17 \n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\github_release.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 16,
      "line_range": [
        16
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "42     }\n43     response = requests.put(\n44             BASE_KV_URL + account + \"/storage/kv/namespaces/\" + namespace + \"/values/\" + key,\n45             headers=headers,\n46             data=pkg_hash\n47     )\n48 \n",
      "col_offset": 15,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\github_release.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 43,
      "line_range": [
        43,
        44,
        45,
        46,
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "190         zipfile = tarfile.open(binary_path, \"r:gz\")\n191         zipfile.extractall('cfd') # specify which folder to extract to\n192         zipfile.close()\n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\github_release.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 22,
        "link": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "tarfile.extractall used without any validation. Please check and discard dangerous members.",
      "line_number": 191,
      "line_range": [
        191
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b202_tarfile_unsafe_members.html",
      "test_id": "B202",
      "test_name": "tarfile_unsafe_members"
    },
    {
      "code": "227     cmd = ['go','version', '-m', binary_path]\n228     process = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n229     output, _ = process.communicate()\n",
      "col_offset": 14,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\github_release.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 228,
      "line_range": [
        228
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "256         tar = tarfile.open(binary_path, \"r:gz\")\n257         tar.extractall(\"tmp\")\n258         tar.close()\n",
      "col_offset": 8,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\github_release.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 22,
        "link": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "tarfile.extractall used without any validation. Please check and discard dangerous members.",
      "line_number": 257,
      "line_range": [
        257
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b202_tarfile_unsafe_members.html",
      "test_id": "B202",
      "test_name": "tarfile_unsafe_members"
    },
    {
      "code": "16 from pathlib import Path\n17 from subprocess import Popen, PIPE\n18 \n",
      "col_offset": 0,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 17,
      "line_range": [
        17
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "107         print(f\"creating deb pkgs: {release} : {deb_file}\")\n108         p = Popen([\"reprepro\", \"includedeb\", release, deb_file], stdout=PIPE, stderr=PIPE)\n109         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 108,
      "line_range": [
        108
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "107         print(f\"creating deb pkgs: {release} : {deb_file}\")\n108         p = Popen([\"reprepro\", \"includedeb\", release, deb_file], stdout=PIPE, stderr=PIPE)\n109         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 108,
      "line_range": [
        108
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "115         self._setup_rpm_pkg_directories(artifacts_path, gpg_key_name)\n116         p = Popen([\"createrepo\", \"./rpm\"], stdout=PIPE, stderr=PIPE)\n117         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 116,
      "line_range": [
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "115         self._setup_rpm_pkg_directories(artifacts_path, gpg_key_name)\n116         p = Popen([\"createrepo\", \"./rpm\"], stdout=PIPE, stderr=PIPE)\n117         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 116,
      "line_range": [
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "145     def _sign_rpms(self, file_path):\n146         p = Popen([\"rpm\", \"--define\", f\"_gpg_name {gpg_key_name}\", \"--addsign\", file_path], stdout=PIPE, stderr=PIPE)\n147         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 117,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 146,
      "line_range": [
        146
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "145     def _sign_rpms(self, file_path):\n146         p = Popen([\"rpm\", \"--define\", f\"_gpg_name {gpg_key_name}\", \"--addsign\", file_path], stdout=PIPE, stderr=PIPE)\n147         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 117,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 146,
      "line_range": [
        146
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "152     def _sign_repomd(self):\n153         p = Popen([\"gpg\", \"--batch\", \"--detach-sign\", \"--armor\", \"./rpm/repodata/repomd.xml\"], stdout=PIPE, stderr=PIPE)\n154         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 120,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 153,
      "line_range": [
        153
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "152     def _sign_repomd(self):\n153         p = Popen([\"gpg\", \"--batch\", \"--detach-sign\", \"--armor\", \"./rpm/repodata/repomd.xml\"], stdout=PIPE, stderr=PIPE)\n154         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 120,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 153,
      "line_range": [
        153
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "205 \n206         p = Popen([\"rpm\", \"--import\", file_name], stdout=PIPE, stderr=PIPE)\n207         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 206,
      "line_range": [
        206
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "205 \n206         p = Popen([\"rpm\", \"--import\", file_name], stdout=PIPE, stderr=PIPE)\n207         out, err = p.communicate()\n",
      "col_offset": 12,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\release_pkgs.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 206,
      "line_range": [
        206
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "5 import unittest\n6 import subprocess\n7 import os\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\ssh_server_tests\\tests.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 6,
      "line_range": [
        6
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "84         proc = subprocess.Popen(\n85             cmd, stderr=subprocess.PIPE, stdout=subprocess.PIPE, shell=shell\n86         )\n87         raw_out, raw_err = proc.communicate()\n88 \n",
      "col_offset": 15,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\cloudflared\\ssh_server_tests\\tests.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 85,
      "line_range": [
        84,
        85,
        86
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    }
  ]
}