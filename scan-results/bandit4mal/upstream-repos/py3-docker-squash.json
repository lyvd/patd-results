{
  "errors": [],
  "generated_at": "2024-10-27T17:38:07Z",
  "metrics": {
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 2,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\cli.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 128,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\errors.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 6,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\image.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 2,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 718,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\lib\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 0,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\lib\\common.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 55,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\squash.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 121,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\v1_image.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 60,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\v2_image.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 243,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\version.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\setup.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 24,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\support\\run_formatter.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 49,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 0,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py": {
      "CONFIDENCE.HIGH": 9,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 9,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1086,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_qa.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 17,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_squash.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 65,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v1_image.py": {
      "CONFIDENCE.HIGH": 5,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 338,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 10,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 10,
      "SEVERITY.UNDEFINED": 0,
      "loc": 220,
      "nosec": 0,
      "skipped_tests": 0
    },
    "_totals": {
      "CONFIDENCE.HIGH": 21,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 11,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 2,
      "SEVERITY.LOW": 19,
      "SEVERITY.MEDIUM": 11,
      "SEVERITY.UNDEFINED": 0,
      "loc": 3133,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "364         with tarfile.open(fileobj=fileobj, mode=\"r|\") as tar:\n365             tar.extractall(path=directory)\n366 \n",
      "col_offset": 12,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\image.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 22,
        "link": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "tarfile.extractall used without any validation. Please check and discard dangerous members.",
      "line_number": 365,
      "line_range": [
        365
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b202_tarfile_unsafe_members.html",
      "test_id": "B202",
      "test_name": "tarfile_unsafe_members"
    },
    {
      "code": "421         with tarfile.open(tar_file, \"r\") as tar:\n422             tar.extractall(path=directory)\n423 \n",
      "col_offset": 12,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\docker_squash\\image.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 22,
        "link": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "tarfile.extractall used without any validation. Please check and discard dangerous members.",
      "line_number": 422,
      "line_range": [
        422
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b202_tarfile_unsafe_members.html",
      "test_id": "B202",
      "test_name": "tarfile_unsafe_members"
    },
    {
      "code": "5 from pathlib import Path\n6 from subprocess import CalledProcessError, run\n7 \n",
      "col_offset": 0,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\support\\run_formatter.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 6,
      "line_range": [
        6
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "46             with Chdir(repo_root):\n47                 run(formatter + options + verbose_opt + [\".\"], check=True)\n48         except CalledProcessError as err:\n",
      "col_offset": 16,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\support\\run_formatter.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "56             with Chdir(repo_root):\n57                 run(formatter + verbose_opt + [\".\"], check=True)\n58         except CalledProcessError as err:\n",
      "col_offset": 16,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\support\\run_formatter.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "119                 with tarfile.open(fileobj=layer_file, mode=\"r\") as layer_tar:\n120                     assert (\n121                         name in layer_tar.getnames()\n122                     ), \"File '%s' was not found in layer files: %s\" % (\n123                         name,\n124                         layer_tar.getnames(),\n125                     )\n126 \n",
      "col_offset": 20,
      "end_col_offset": 21,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 120,
      "line_range": [
        120,
        121,
        122,
        123,
        124,
        125
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "228             with tarfile.open(fileobj=self.squashed_layer, mode=\"r\") as tar:\n229                 assert (\n230                     name in tar.getnames()\n231                 ), \"File '%s' was not found in the squashed files: %s\" % (\n232                     name,\n233                     tar.getnames(),\n234                 )\n235 \n",
      "col_offset": 16,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 229,
      "line_range": [
        229,
        230,
        231,
        232,
        233,
        234
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "238             with tarfile.open(fileobj=self.squashed_layer, mode=\"r\") as tar:\n239                 assert (\n240                     name not in tar.getnames()\n241                 ), \"File '%s' was found in the squashed layer files: %s\" % (\n242                     name,\n243                     tar.getnames(),\n244                 )\n245 \n",
      "col_offset": 16,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 239,
      "line_range": [
        239,
        240,
        241,
        242,
        243,
        244
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "249                 member = tar.getmember(name)\n250                 assert member.islnk() is False, (\n251                     \"File '%s' should not be a hard link, but it is\" % name\n252                 )\n253 \n",
      "col_offset": 16,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 250,
      "line_range": [
        250,
        251,
        252
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "282             with tarfile.open(fileobj=self.content, mode=\"r\") as tar:\n283                 assert (\n284                     name in tar.getnames()\n285                 ), \"File %s was not found in the container files: %s\" % (\n286                     name,\n287                     tar.getnames(),\n288                 )\n289 \n",
      "col_offset": 16,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 283,
      "line_range": [
        283,
        284,
        285,
        286,
        287,
        288
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "292             with tarfile.open(fileobj=self.content, mode=\"r\") as tar:\n293                 assert (\n294                     name not in tar.getnames()\n295                 ), \"File %s was found in the container files: %s\" % (\n296                     name,\n297                     tar.getnames(),\n298                 )\n299 \n",
      "col_offset": 16,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 293,
      "line_range": [
        293,
        294,
        295,
        296,
        297,
        298
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "319                 squashed_image.assert_target_tag_exists()\n320         assert \"Tag is the same as image; preventing cleanup\" in self.caplog.text\n321 \n",
      "col_offset": 8,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 320,
      "line_range": [
        320
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "814 \n815         assert tmp_location\n816         assert \"Cleaning up %s temporary directory\", (\n",
      "col_offset": 8,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 815,
      "line_range": [
        815
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "815         assert tmp_location\n816         assert \"Cleaning up %s temporary directory\", (\n817             tmp_location.group(1) in self.caplog.text\n818         )\n819 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 816,
      "line_range": [
        816,
        817,
        818
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "827 \n828         tmp_dir = \"/tmp/docker-squash-integ-tmp-dir\"\n829         log = mock.Mock()\n",
      "col_offset": 18,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_integ_squash.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 828,
      "line_range": [
        828
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "1 from pathlib import Path\n2 from subprocess import PIPE, run\n3 \n",
      "col_offset": 0,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_qa.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 2,
      "line_range": [
        2
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "12     monkeypatch.delenv(\"PYTHONPATH\", raising=False)\n13     ret = run(cmd, stdout=PIPE, stderr=PIPE, encoding=\"utf-8\", check=False)\n14     if ret.returncode:\n",
      "col_offset": 10,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_qa.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 13,
      "line_range": [
        13
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "360 \n361         assert len(markers) == 2\n362         assert markers[marker_1] == \"filecontent1\"\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v1_image.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 361,
      "line_range": [
        361
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "361         assert len(markers) == 2\n362         assert markers[marker_1] == \"filecontent1\"\n363         assert markers[marker_2] == \"filecontent2\"\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v1_image.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 362,
      "line_range": [
        362
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "362         assert markers[marker_1] == \"filecontent1\"\n363         assert markers[marker_2] == \"filecontent2\"\n364 \n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v1_image.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 363,
      "line_range": [
        363
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "384 \n385         assert len(markers) == 1\n386         assert markers[marker_1] == \"filecontent1\"\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v1_image.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 385,
      "line_range": [
        385
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "385         assert len(markers) == 1\n386         assert markers[marker_1] == \"filecontent1\"\n387 \n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v1_image.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 386,
      "line_range": [
        386
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "22         ):\n23             manifest = self.image._read_json_file(\"/tmp/old/manifest.json\")\n24 \n",
      "col_offset": 50,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 23,
      "line_range": [
        23
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "84     def test_generate_image_metadata_without_any_layers_to_squash(self):\n85         self.image.old_image_dir = \"/tmp/old\"\n86         self.image.squash_id = \"squash_id\"\n",
      "col_offset": 35,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 85,
      "line_range": [
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "128     def test_generate_image_metadata(self):\n129         self.image.old_image_dir = \"/tmp/old\"\n130         self.image.squash_id = \"squash_id\"\n",
      "col_offset": 35,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 129,
      "line_range": [
        129
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "179         self.image.date = \"squashed_date\"\n180         self.image.old_image_dir = \"/tmp/old\"\n181         self.image.squash_id = \"squash_id\"\n",
      "col_offset": 35,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 180,
      "line_range": [
        180
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "245     def test_write_image_metadata(self, mock_method):\n246         self.image.new_image_dir = \"/tmp/new\"\n247         metadata = OrderedDict([(\"a\", \"something\"), (\"b\", 12)])\n",
      "col_offset": 35,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 246,
      "line_range": [
        246
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "251             '{\"a\":\"something\",\"b\":12}\\n',\n252             \"/tmp/new/b3a8bc9dad2103f11e99ebc5ce113c08d1dc31299c247ddd87aca1f048560db3.json\",\n253         )\n254 \n255         self.assertEqual(\n256             image_id, \"b3a8bc9dad2103f11e99ebc5ce113c08d1dc31299c247ddd87aca1f048560db3\"\n",
      "col_offset": 12,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 252,
      "line_range": [
        250,
        251,
        252,
        253
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "260     def test_write_squashed_layer_metadata(self, mock_method):\n261         self.image.squashed_dir = \"/tmp/squashed\"\n262         metadata = OrderedDict([(\"a\", \"something\"), (\"b\", 12)])\n",
      "col_offset": 34,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 261,
      "line_range": [
        261
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "263         self.image._write_squashed_layer_metadata(metadata)\n264         mock_method.assert_called_with('{\"a\":\"something\",\"b\":12}', \"/tmp/squashed/json\")\n265 \n",
      "col_offset": 67,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 264,
      "line_range": [
        264
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "267     def test_write_manifest_metadata(self, mock_method):\n268         self.image.new_image_dir = \"/tmp/new\"\n269         metadata = OrderedDict([(\"a\", \"something\"), (\"b\", 12)])\n",
      "col_offset": 35,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 268,
      "line_range": [
        268
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    },
    {
      "code": "271         mock_method.assert_called_with(\n272             '{\"a\":\"something\",\"b\":12}\\n', \"/tmp/new/manifest.json\"\n273         )\n274 \n275 \n",
      "col_offset": 42,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\py3-docker-squash\\tests\\test_unit_v2_image.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 377,
        "link": "https://cwe.mitre.org/data/definitions/377.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Probable insecure usage of temp file/directory.",
      "line_number": 272,
      "line_range": [
        271,
        272,
        273
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b108_hardcoded_tmp_directory.html",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory"
    }
  ]
}