{
  "errors": [],
  "generated_at": "2024-10-27T17:29:51Z",
  "metrics": {
    "D:\\bandit\\upstream-repos\\neon\\pre-commit.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 104,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\scripts\\benchmark_durations.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 152,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\scripts\\download_basebackup.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 49,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\scripts\\flaky_tests.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 118,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\scripts\\force_layer_download.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 258,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\scripts\\ingest_perf_test_result.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 134,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\scripts\\ingest_regress_test_result-new-format.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 174,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py": {
      "CONFIDENCE.HIGH": 11,
      "CONFIDENCE.LOW": 2,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 11,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 99,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\cloud_regress\\test_cloud_regress.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 91,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\conftest.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 15,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\auth_tokens.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 28,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\benchmark_fixture.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 432,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\common_types.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 188,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\compare_fixtures.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 298,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\compute_reconfigure.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 55,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\endpoint\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\endpoint\\http.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 39,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\flaky.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 51,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\httpserver.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 32,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\log_helper.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 29,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\metrics.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 150,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py": {
      "CONFIDENCE.HIGH": 11,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 11,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 256,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_cli.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 561,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py": {
      "CONFIDENCE.HIGH": 116,
      "CONFIDENCE.LOW": 5,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 5,
      "SEVERITY.LOW": 111,
      "SEVERITY.MEDIUM": 5,
      "SEVERITY.UNDEFINED": 0,
      "loc": 3920,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\overlayfs.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 16,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\allowed_errors.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 90,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\common_types.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 104,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py": {
      "CONFIDENCE.HIGH": 40,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 40,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 913,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\many_tenants.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 54,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 101,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py": {
      "CONFIDENCE.HIGH": 13,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 13,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 363,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\parametrize.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 83,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 208,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pg_stats.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 47,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pg_version.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 52,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\port_distributor.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 53,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\remote_storage.py": {
      "CONFIDENCE.HIGH": 7,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 7,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 351,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 250,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\utils.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 17,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\slow.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 24,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\storage_controller_proxy.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 53,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py": {
      "CONFIDENCE.HIGH": 13,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 13,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 512,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\workload.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 3,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 3,
      "SEVERITY.UNDEFINED": 0,
      "loc": 161,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_clickhouse.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 1,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 77,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 175,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\interactive\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 8,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\interactive\\test_many_small_tenants.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 58,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\pagebench\\__init__.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 9,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\pagebench\\test_large_slru_basebackup.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 155,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\pagebench\\test_ondemand_download_churn.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 150,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\pagebench\\test_pageserver_max_throughput_getpage_at_latest_lsn.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 195,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\util.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 47,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pgvector\\loaddata.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 55,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_branch_creation.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 172,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_branching.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 62,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_bulk_insert.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 40,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_bulk_tenant_create.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 30,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_bulk_update.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 39,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py": {
      "CONFIDENCE.HIGH": 9,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 4,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 9,
      "SEVERITY.MEDIUM": 4,
      "SEVERITY.UNDEFINED": 0,
      "loc": 90,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compare_pg_stats.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 107,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_copy.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 49,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_dup_key.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 42,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_gc_feedback.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 144,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_gist_build.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 19,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_hot_page.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 37,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_hot_table.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 40,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_latency.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 19,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_layer_map.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 32,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_lazy_startup.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 67,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_logical_replication.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 281,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_parallel_copy_to.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 53,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_perf_olap.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 212,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_perf_pgbench.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 181,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_perf_pgvector_queries.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 12,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_physical_replication.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 258,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_random_writes.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 47,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_seqscans.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 46,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_sharding_autosplit.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 196,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_startup.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 37,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py": {
      "CONFIDENCE.HIGH": 13,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 13,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 271,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 222,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_write_amplification.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 22,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\pg_clients\\python\\asyncpg\\asyncpg_example.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 20,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\pg_clients\\python\\pg8000\\pg8000_example.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 18,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\pg_clients\\test_pg_clients.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 44,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ancestor_branch.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 76,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py": {
      "CONFIDENCE.HIGH": 20,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 20,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 174,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_auth.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 165,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_backpressure.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 112,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_bad_connection.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 58,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_basebackup_error.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 9,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_and_gc.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 93,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_behind.py": {
      "CONFIDENCE.HIGH": 7,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 7,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 119,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branching.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 293,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 150,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_build_info_metric.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 16,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py": {
      "CONFIDENCE.HIGH": 11,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 11,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 103,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_clog_truncate.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 43,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_close_fds.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 40,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py": {
      "CONFIDENCE.HIGH": 12,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 4,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 12,
      "SEVERITY.MEDIUM": 4,
      "SEVERITY.UNDEFINED": 0,
      "loc": 103,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py": {
      "CONFIDENCE.HIGH": 21,
      "CONFIDENCE.LOW": 2,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 21,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 292,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py": {
      "CONFIDENCE.HIGH": 20,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 1,
      "SEVERITY.LOW": 19,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 375,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compute_catalog.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 23,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compute_metrics.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 14,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_config.py": {
      "CONFIDENCE.HIGH": 5,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 48,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_crafted_wal_end.py": {
      "CONFIDENCE.HIGH": 5,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 66,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createdropdb.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 67,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createuser.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 13,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py": {
      "CONFIDENCE.HIGH": 27,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 28,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 260,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py": {
      "CONFIDENCE.HIGH": 42,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 42,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 640,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_download_extensions.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 97,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_endpoint_crash.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 21,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 67,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_extensions.py": {
      "CONFIDENCE.HIGH": 5,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 37,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_fsm_truncate.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 9,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_fullbackup.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 47,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gc_aggressive.py": {
      "CONFIDENCE.HIGH": 5,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 104,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gin_redo.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 16,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py": {
      "CONFIDENCE.HIGH": 11,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 11,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 218,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_import.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 206,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py": {
      "CONFIDENCE.HIGH": 12,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 12,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 117,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 57,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_large_schema.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 55,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_bloating.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 55,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py": {
      "CONFIDENCE.HIGH": 26,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 26,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 230,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_writers_fail.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 72,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py": {
      "CONFIDENCE.HIGH": 20,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 20,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 196,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_resize.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 58,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_working_set_approximation.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 95,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_local_file_cache.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 58,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logging.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 37,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py": {
      "CONFIDENCE.HIGH": 24,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 7,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 27,
      "SEVERITY.MEDIUM": 4,
      "SEVERITY.UNDEFINED": 0,
      "loc": 427,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py": {
      "CONFIDENCE.HIGH": 16,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 16,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 197,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_migrations.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 23,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_multixact.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 47,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py": {
      "CONFIDENCE.HIGH": 14,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 14,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 164,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_extension.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 65,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_local_cli.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 76,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py": {
      "CONFIDENCE.HIGH": 9,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 3,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 12,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 78,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py": {
      "CONFIDENCE.HIGH": 10,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 10,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 316,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_normal_work.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 42,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_oid_overflow.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 34,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_old_request_lsn.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 40,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py": {
      "CONFIDENCE.HIGH": 42,
      "CONFIDENCE.LOW": 2,
      "CONFIDENCE.MEDIUM": 4,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 42,
      "SEVERITY.MEDIUM": 6,
      "SEVERITY.UNDEFINED": 0,
      "loc": 548,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_slru_download.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 107,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py": {
      "CONFIDENCE.HIGH": 15,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 15,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 103,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_catchup.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 41,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_crash_consistency.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 71,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py": {
      "CONFIDENCE.HIGH": 51,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 51,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 485,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_getpage_throttle.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 142,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py": {
      "CONFIDENCE.HIGH": 13,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 13,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 211,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py": {
      "CONFIDENCE.HIGH": 19,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 19,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 360,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_reconnect.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 50,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py": {
      "CONFIDENCE.HIGH": 16,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 16,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 147,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restarts_under_workload.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 22,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py": {
      "CONFIDENCE.HIGH": 51,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 51,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 604,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_parallel_copy.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 31,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py": {
      "CONFIDENCE.HIGH": 10,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 10,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 221,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_regress.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 279,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_waldump.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 45,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_physical_replication.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 35,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pitr_gc.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 47,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_postgres_version.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 4,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 27,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py": {
      "CONFIDENCE.HIGH": 83,
      "CONFIDENCE.LOW": 6,
      "CONFIDENCE.MEDIUM": 13,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 96,
      "SEVERITY.MEDIUM": 6,
      "SEVERITY.UNDEFINED": 0,
      "loc": 471,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py": {
      "CONFIDENCE.HIGH": 4,
      "CONFIDENCE.LOW": 4,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 4,
      "SEVERITY.UNDEFINED": 0,
      "loc": 49,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py": {
      "CONFIDENCE.HIGH": 8,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 8,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 87,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py": {
      "CONFIDENCE.HIGH": 36,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 38,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 153,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py": {
      "CONFIDENCE.HIGH": 15,
      "CONFIDENCE.LOW": 4,
      "CONFIDENCE.MEDIUM": 5,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 15,
      "SEVERITY.MEDIUM": 9,
      "SEVERITY.UNDEFINED": 0,
      "loc": 136,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py": {
      "CONFIDENCE.HIGH": 9,
      "CONFIDENCE.LOW": 2,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 9,
      "SEVERITY.MEDIUM": 4,
      "SEVERITY.UNDEFINED": 0,
      "loc": 206,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_recovery.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 42,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py": {
      "CONFIDENCE.HIGH": 36,
      "CONFIDENCE.LOW": 3,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 36,
      "SEVERITY.MEDIUM": 4,
      "SEVERITY.UNDEFINED": 0,
      "loc": 584,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py": {
      "CONFIDENCE.HIGH": 29,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 29,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 436,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_role_grants.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 29,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py": {
      "CONFIDENCE.HIGH": 7,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 7,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 94,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_setup.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 11,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py": {
      "CONFIDENCE.HIGH": 83,
      "CONFIDENCE.LOW": 5,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 83,
      "SEVERITY.MEDIUM": 5,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1140,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sni_router.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 6,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 120,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py": {
      "CONFIDENCE.HIGH": 210,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 210,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 2161,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py": {
      "CONFIDENCE.HIGH": 42,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 42,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 384,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_subscriber_restart.py": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 1,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 42,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_subxacts.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 16,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py": {
      "CONFIDENCE.HIGH": 74,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 74,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 271,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py": {
      "CONFIDENCE.HIGH": 18,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 19,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 315,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py": {
      "CONFIDENCE.HIGH": 18,
      "CONFIDENCE.LOW": 2,
      "CONFIDENCE.MEDIUM": 2,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 19,
      "SEVERITY.MEDIUM": 3,
      "SEVERITY.UNDEFINED": 0,
      "loc": 335,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py": {
      "CONFIDENCE.HIGH": 13,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 13,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 359,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py": {
      "CONFIDENCE.HIGH": 33,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 8,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 33,
      "SEVERITY.MEDIUM": 8,
      "SEVERITY.UNDEFINED": 0,
      "loc": 577,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_tasks.py": {
      "CONFIDENCE.HIGH": 5,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 58,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py": {
      "CONFIDENCE.HIGH": 23,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 23,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 376,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py": {
      "CONFIDENCE.HIGH": 13,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 3,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 14,
      "SEVERITY.MEDIUM": 2,
      "SEVERITY.UNDEFINED": 0,
      "loc": 198,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_threshold_based_eviction.py": {
      "CONFIDENCE.HIGH": 7,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 7,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 138,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py": {
      "CONFIDENCE.HIGH": 20,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 20,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 266,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py": {
      "CONFIDENCE.HIGH": 25,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 25,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 621,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py": {
      "CONFIDENCE.HIGH": 93,
      "CONFIDENCE.LOW": 6,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 93,
      "SEVERITY.MEDIUM": 6,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1045,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_gc_blocking.py": {
      "CONFIDENCE.HIGH": 3,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 3,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 91,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py": {
      "CONFIDENCE.HIGH": 42,
      "CONFIDENCE.LOW": 1,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 42,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 807,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_truncate.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 3,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 3,
      "SEVERITY.UNDEFINED": 0,
      "loc": 33,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_twophase.py": {
      "CONFIDENCE.HIGH": 5,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 110,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_unlogged.py": {
      "CONFIDENCE.HIGH": 2,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 2,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 35,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py": {
      "CONFIDENCE.HIGH": 11,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 11,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 168,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py": {
      "CONFIDENCE.HIGH": 126,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 3,
      "SEVERITY.LOW": 123,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 1817,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py": {
      "CONFIDENCE.HIGH": 20,
      "CONFIDENCE.LOW": 2,
      "CONFIDENCE.MEDIUM": 3,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 20,
      "SEVERITY.MEDIUM": 5,
      "SEVERITY.UNDEFINED": 0,
      "loc": 533,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py": {
      "CONFIDENCE.HIGH": 10,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 1,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 10,
      "SEVERITY.MEDIUM": 1,
      "SEVERITY.UNDEFINED": 0,
      "loc": 107,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_restore.py": {
      "CONFIDENCE.HIGH": 6,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 1,
      "SEVERITY.LOW": 5,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 167,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_walredo_not_left_behind_on_detach.py": {
      "CONFIDENCE.HIGH": 7,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 7,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 69,
      "nosec": 0,
      "skipped_tests": 0
    },
    "D:\\bandit\\upstream-repos\\neon\\test_runner\\test_broken.py": {
      "CONFIDENCE.HIGH": 0,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 22,
      "nosec": 0,
      "skipped_tests": 0
    },
    "_totals": {
      "CONFIDENCE.HIGH": 2150,
      "CONFIDENCE.LOW": 58,
      "CONFIDENCE.MEDIUM": 102,
      "CONFIDENCE.UNDEFINED": 0,
      "SEVERITY.HIGH": 11,
      "SEVERITY.LOW": 2165,
      "SEVERITY.MEDIUM": 134,
      "SEVERITY.UNDEFINED": 0,
      "loc": 39497,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "results": [
    {
      "code": "7 import os\n8 import subprocess\n9 import sys\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\pre-commit.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 8,
      "line_range": [
        8
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "59 def get_commit_files() -> list[str]:\n60     files = subprocess.check_output(\"git diff --cached --name-only --diff-filter=ACM\".split())\n61     return files.decode().splitlines()\n",
      "col_offset": 12,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\pre-commit.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 60,
      "line_range": [
        60
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "71     cmd = f'{cmd} {\" \".join(applicable_files)}'\n72     res = subprocess.run(cmd.split(), capture_output=True)\n73     if res.returncode != 0:\n",
      "col_offset": 10,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\pre-commit.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "73         v = toml.loads(toml_table)\n74         assert isinstance(v, dict)\n75         return v\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\flaky_tests.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "196             gathered = await asyncio.gather(*get_timeline_id_coros, return_exceptions=True)\n197             assert len(tenant_ids) == len(gathered)\n198             tenant_and_timline_ids = []\n",
      "col_offset": 12,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\force_layer_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 197,
      "line_range": [
        197
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "217     tmp = list(set(tenant_and_timline_ids))\n218     assert len(tmp) <= len(tenant_and_timline_ids)\n219     if len(tmp) != len(tenant_and_timline_ids):\n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\force_layer_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 218,
      "line_range": [
        218
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "248             break\n249     assert task_q.empty()\n250 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\force_layer_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 249,
      "line_range": [
        249
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "158     columns = \",\".join(f.name for f in dataclasses.fields(Row))\n159     query = f\"INSERT INTO results ({columns}) VALUES %s ON CONFLICT DO NOTHING\"\n160     execute_values(cur, query, rows)\n",
      "col_offset": 14,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\ingest_regress_test_result-new-format.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 159,
      "line_range": [
        159
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "34 \n35 assert trash_dir.is_dir()\n36 \n",
      "col_offset": 0,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 35,
      "line_range": [
        35
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "40 def console_get(rel_url):\n41     r = requests.get(\n42         f\"{endpoint}{rel_url}\",\n43         headers={\n44             \"Authorization\": f\"Bearer {access_key}\",\n45             \"Content-Type\": \"application/json\",\n46             \"Accept\": \"application/json\",\n47         },\n48     )\n49     r.raise_for_status()\n",
      "col_offset": 8,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 41,
      "line_range": [
        41,
        42,
        43,
        44,
        45,
        46,
        47,
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "56     results = r[\"data\"]\n57     assert len(results) == 1, f\"unexpected results len: {results}\"\n58     r = results[0]\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "58     r = results[0]\n59     assert r[\"tenant\"] == tenant_id, f\"tenant id doesn't match: {r}\"\n60     assert r[\"safekeepers\"] is not None, f\"safekeepers is None: {r}\"\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 59,
      "line_range": [
        59
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "59     assert r[\"tenant\"] == tenant_id, f\"tenant id doesn't match: {r}\"\n60     assert r[\"safekeepers\"] is not None, f\"safekeepers is None: {r}\"\n61     assert any(sk[\"id\"] == sk_id for sk in r[\"safekeepers\"]), f\"safekeeper id not found: {r}\"\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 60,
      "line_range": [
        60
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "60     assert r[\"safekeepers\"] is not None, f\"safekeepers is None: {r}\"\n61     assert any(sk[\"id\"] == sk_id for sk in r[\"safekeepers\"]), f\"safekeeper id not found: {r}\"\n62     assert \"deleted\" in r, f\"{r}\"\n",
      "col_offset": 4,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 61,
      "line_range": [
        61
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "61     assert any(sk[\"id\"] == sk_id for sk in r[\"safekeepers\"]), f\"safekeeper id not found: {r}\"\n62     assert \"deleted\" in r, f\"{r}\"\n63     return r[\"deleted\"] is True\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "66 def call_delete_tenant_api(tenant_id):\n67     r = requests.delete(f\"http://{sk_host}:7676/v1/tenant/{tenant_id}\")\n68     r.raise_for_status()\n",
      "col_offset": 8,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 67,
      "line_range": [
        67
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "92 \n93     assert not tenant_dir_in_trash.exists(), f\"{tenant_dir_in_trash}\"\n94     assert tenant_dir_in_trash.parent.exists(), f\"{tenant_dir_in_trash}\"\n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "93     assert not tenant_dir_in_trash.exists(), f\"{tenant_dir_in_trash}\"\n94     assert tenant_dir_in_trash.parent.exists(), f\"{tenant_dir_in_trash}\"\n95     # double-check\n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "95     # double-check\n96     assert tenant_dir.exists(), f\"{tenant_dir}\"\n97     assert tenant_dir.is_dir(), f\"{tenant_dir}\"\n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 96,
      "line_range": [
        96
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "96     assert tenant_dir.exists(), f\"{tenant_dir}\"\n97     assert tenant_dir.is_dir(), f\"{tenant_dir}\"\n98 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 97,
      "line_range": [
        97
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "105     logging.info(\"tenant is now deleted, checking that it's gone\")\n106     assert not tenant_dir.exists(), f\"{tenant_dir}\"\n107 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\scripts\\sk_cleanup_tenants\\script.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 106,
      "line_range": [
        106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "277             if property_name.startswith(cls.PROPERTY_PREFIX):\n278                 assert isinstance(recorded_property, dict)\n279                 yield recorded_property[\"name\"], recorded_property\n",
      "col_offset": 16,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\benchmark_fixture.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 278,
      "line_range": [
        278
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "490     path = target_dir / f\"{ts}_{revision}.json\"\n491     assert not path.exists()\n492     return path\n",
      "col_offset": 4,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\benchmark_fixture.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 491,
      "line_range": [
        491
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "33             self.lsn_int = (int(left, 16) << 32) + int(right, 16)\n34         assert 0 <= self.lsn_int <= 0xFFFFFFFF_FFFFFFFF\n35 \n",
      "col_offset": 8,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\common_types.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 34,
      "line_range": [
        34
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "122         self.id = bytearray.fromhex(x)\n123         assert len(self.id) == 16\n124 \n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\common_types.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 123,
      "line_range": [
        123
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "146         \"\"\"Generate a random ID\"\"\"\n147         return cls(random.randbytes(16).hex())\n148 \n",
      "col_offset": 19,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\common_types.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 147,
      "line_range": [
        147
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "201         self.shard_count = shard_count\n202         assert self.shard_number < self.shard_count or self.shard_count == 0\n203 \n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\common_types.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 202,
      "line_range": [
        202
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "98                 row = cur.fetchone()\n99                 assert row is not None\n100                 assert len(row) == len(pg_stat.columns)\n",
      "col_offset": 16,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\compare_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 99,
      "line_range": [
        99
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "99                 assert row is not None\n100                 assert len(row) == len(pg_stat.columns)\n101 \n",
      "col_offset": 16,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\compare_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 100,
      "line_range": [
        100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "369     fixture = request.getfixturevalue(request.param)\n370     assert isinstance(fixture, PgCompare), f\"test error: fixture {fixture} is not PgCompare\"\n371     return fixture\n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\compare_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 370,
      "line_range": [
        370
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55     def handler(request: Request) -> Response:\n56         assert request.json is not None\n57         body: dict[str, Any] = request.json\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\compute_reconfigure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "36         res = self.query_all(name, filter or {})\n37         assert len(res) == 1, f\"expected single sample for {name} {filter}, found {res}\"\n38         return res[0]\n",
      "col_offset": 8,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\metrics.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 37,
      "line_range": [
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "57             return None\n58         assert len(results) == 1, f\"metric {name} with given filters is not unique, got: {results}\"\n59         return results[0].value\n",
      "col_offset": 8,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\metrics.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 58,
      "line_range": [
        58
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "105 def histogram(prefix_without_trailing_underscore: str) -> list[str]:\n106     assert not prefix_without_trailing_underscore.endswith(\"_\")\n107     return [f\"{prefix_without_trailing_underscore}_{x}\" for x in [\"bucket\", \"count\", \"sum\"]]\n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\metrics.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 106,
      "line_range": [
        106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "68 \n69         assert resp.status_code == 201\n70 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 69,
      "line_range": [
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "81         )\n82         assert resp.status_code == 200\n83         return cast(\"dict[str, Any]\", resp.json())\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "97 \n98         assert resp.status_code == 200\n99 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 98,
      "line_range": [
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "114 \n115         assert resp.status_code == 200\n116 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 115,
      "line_range": [
        115
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "131 \n132         assert resp.status_code == 200\n133 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 132,
      "line_range": [
        132
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "148 \n149         assert resp.status_code == 200\n150 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 149,
      "line_range": [
        149
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "180 \n181         assert resp.status_code == 201\n182 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 181,
      "line_range": [
        181
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "208 \n209         assert resp.status_code == 200\n210 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 209,
      "line_range": [
        209
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "221 \n222         assert resp.status_code == 200\n223 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 222,
      "line_range": [
        222
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "234 \n235         assert resp.status_code == 200\n236 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 235,
      "line_range": [
        235
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "248 \n249         assert resp.status_code == 200\n250 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 249,
      "line_range": [
        249
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "5 import re\n6 import subprocess\n7 import tempfile\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 6,
      "line_range": [
        6
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "66 \n67         assert isinstance(arguments, list)\n68         assert isinstance(self.COMMAND, str)\n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 67,
      "line_range": [
        67
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "67         assert isinstance(arguments, list)\n68         assert isinstance(self.COMMAND, str)\n69 \n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 68,
      "line_range": [
        68
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "90         try:\n91             res = subprocess.run(\n92                 args,\n93                 env=env_vars,\n94                 check=False,\n95                 text=True,\n96                 capture_output=True,\n97                 timeout=timeout,\n98             )\n99         except subprocess.TimeoutExpired as e:\n",
      "col_offset": 18,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 91,
      "line_range": [
        91,
        92,
        93,
        94,
        95,
        96,
        97,
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "10 import shutil\n11 import subprocess\n12 import threading\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 11,
      "line_range": [
        11
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "169         return 0\n170     assert worker_id.startswith(\"gw\")\n171     return int(worker_id[2:])\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 170,
      "line_range": [
        170
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "415 \n416         assert test_name.startswith(\n417             \"test_\"\n418         ), \"Unexpectedly instantiated from outside a test function\"\n419         self.test_name = test_name\n",
      "col_offset": 8,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 416,
      "line_range": [
        416,
        417,
        418
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "424         if self.version_combination is not None:\n425             assert (\n426                 self.compatibility_neon_binpath is not None\n427             ), \"the environment variable COMPATIBILITY_NEON_BIN is required when using mixed versions\"\n428             assert (\n",
      "col_offset": 12,
      "end_col_offset": 102,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 425,
      "line_range": [
        425,
        426,
        427
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "427             ), \"the environment variable COMPATIBILITY_NEON_BIN is required when using mixed versions\"\n428             assert (\n429                 self.compatibility_pg_distrib_dir is not None\n430             ), \"the environment variable COMPATIBILITY_POSTGRES_DISTRIB_DIR is required when using mixed versions\"\n431             self.mixdir.mkdir(mode=0o755, exist_ok=True)\n",
      "col_offset": 12,
      "end_col_offset": 114,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 428,
      "line_range": [
        428,
        429,
        430
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "435         # Cannot create more than one environment from one builder\n436         assert self.env is None, \"environment already initialized\"\n437         if default_remote_storage_if_missing and self.pageserver_remote_storage is None:\n",
      "col_offset": 8,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 436,
      "line_range": [
        436
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "471         )\n472         assert env.initial_tenant == initial_tenant\n473         assert env.initial_timeline == initial_timeline\n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 472,
      "line_range": [
        472
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "472         assert env.initial_tenant == initial_tenant\n473         assert env.initial_timeline == initial_timeline\n474         log.info(f\"Initial timeline {initial_tenant}/{initial_timeline} created successfully\")\n",
      "col_offset": 8,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 473,
      "line_range": [
        473
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "489                 self._build_and_use_snapshot_impl(snapshot_dir, create_env_for_snapshot)\n490                 assert snapshot_dir.is_initialized()\n491 \n",
      "col_offset": 16,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 490,
      "line_range": [
        490
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "505             # the upperdir as the snapshot. This is equivalent to docker `FROM scratch`.\n506             assert not self.repo_dir.exists()\n507             assert self.repo_dir.parent.exists()\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 506,
      "line_range": [
        506
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "506             assert not self.repo_dir.exists()\n507             assert self.repo_dir.parent.exists()\n508             snapshot_dir.path.mkdir()\n",
      "col_offset": 12,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 507,
      "line_range": [
        507
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "512         env = create_env_for_snapshot(self)\n513         assert self.env is not None\n514         assert self.env == env\n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 513,
      "line_range": [
        513
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "513         assert self.env is not None\n514         assert self.env == env\n515 \n",
      "col_offset": 8,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 514,
      "line_range": [
        514
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "530             log.info(\"make repo_dir an overlayfs mount of the snapshot we just created\")\n531         assert not env.repo_dir.exists(), \"both branches above should remove it\"\n532         snapshot_dir.set_initialized()\n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 531,
      "line_range": [
        531
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "595         log.info(f\"Copying storage_controller_db from {storcon_db_from_dir} to {storcon_db_to_dir}\")\n596         assert storcon_db_from_dir.is_dir()\n597         assert not storcon_db_to_dir.exists()\n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 596,
      "line_range": [
        596
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "596         assert storcon_db_from_dir.is_dir()\n597         assert not storcon_db_to_dir.exists()\n598 \n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 597,
      "line_range": [
        597
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "604         shutil.copytree(storcon_db_from_dir, storcon_db_to_dir, ignore=ignore_postgres_log)\n605         assert not (storcon_db_to_dir / \"postgres.log\").exists()\n606         # NB: neon_local rewrites postgresql.conf on each start based on neon_local config. No need to patch it.\n",
      "col_offset": 8,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 605,
      "line_range": [
        605
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "610         patch_script_path = self.repo_dir / \"storage_controller_db.startup.sql\"\n611         assert not patch_script_path.exists()\n612         patch_script = \"\"\n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 611,
      "line_range": [
        611
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "613         for ps in self.env.pageservers:\n614             patch_script += f\"UPDATE nodes SET listen_http_port={ps.service_port.http}, listen_pg_port={ps.service_port.pg}  WHERE node_id = '{ps.id}';\"\n615         patch_script_path.write_text(patch_script)\n",
      "col_offset": 30,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 614,
      "line_range": [
        614
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "633     def _mix_versions(self):\n634         assert self.version_combination is not None, \"version combination must be set\"\n635         for component, paths in COMPONENT_BINARIES.items():\n",
      "col_offset": 8,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 634,
      "line_range": [
        634
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "652         \"\"\"\n653         assert self.test_overlay_dir\n654         assert (\n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 653,
      "line_range": [
        653
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "653         assert self.test_overlay_dir\n654         assert (\n655             self.test_output_dir in dstdir.parents\n656         )  # so that teardown & test_overlay_dir fixture work\n657         assert srcdir.is_dir()\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 654,
      "line_range": [
        654,
        655,
        656
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "656         )  # so that teardown & test_overlay_dir fixture work\n657         assert srcdir.is_dir()\n658         dstdir.mkdir(exist_ok=False, parents=False)\n",
      "col_offset": 8,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 657,
      "line_range": [
        657
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "684         cmd = [\"sudo\", \"umount\", str(mountpoint)]\n685         assert mountpoint.is_mount()\n686         subprocess_capture(\n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 685,
      "line_range": [
        685
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "697         \"\"\"\n698         assert self.test_overlay_dir is not None\n699         # not mutating state yet, make checks\n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 698,
      "line_range": [
        698
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "700         ident_state_dir = self.test_overlay_dir / ident\n701         assert ident_state_dir.is_dir()\n702         upper = ident_state_dir / \"upper\"\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 701,
      "line_range": [
        701
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "703         work = ident_state_dir / \"work\"\n704         assert upper.is_dir()\n705         assert work.is_dir()\n",
      "col_offset": 8,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 704,
      "line_range": [
        704
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "704         assert upper.is_dir()\n705         assert work.is_dir()\n706         assert (\n",
      "col_offset": 8,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 705,
      "line_range": [
        705
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "705         assert work.is_dir()\n706         assert (\n707             self.test_overlay_dir not in dst.parents\n708         ), \"otherwise workdir cleanup below wouldn't work\"\n709         # find index, still not mutating state\n",
      "col_offset": 8,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 706,
      "line_range": [
        706,
        707,
        708
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "760         # assert all overlayfs mounts in our test directory are gone\n761         assert [] == list(overlayfs.iter_mounts_beneath(self.test_overlay_dir))\n762 \n",
      "col_offset": 8,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 761,
      "line_range": [
        761
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "766     ):\n767         assert self.pageserver_remote_storage is None, \"remote storage is enabled already\"\n768         ret = self._configure_and_create_remote_storage(\n",
      "col_offset": 8,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 767,
      "line_range": [
        767
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "773     def enable_safekeeper_remote_storage(self, kind: RemoteStorageKind):\n774         assert (\n775             self.safekeepers_remote_storage is None\n776         ), \"safekeepers_remote_storage already configured\"\n777 \n",
      "col_offset": 8,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 774,
      "line_range": [
        774,
        775,
        776
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "799         if kind == RemoteStorageKind.MOCK_S3:\n800             assert isinstance(ret, S3Storage)\n801             ret.client.create_bucket(Bucket=ret.bucket_name)\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 800,
      "line_range": [
        800
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "802         elif kind == RemoteStorageKind.REAL_S3:\n803             assert isinstance(ret, S3Storage)\n804             assert ret.cleanup, \"we should not leave files in REAL_S3\"\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 803,
      "line_range": [
        803
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "803             assert isinstance(ret, S3Storage)\n804             assert ret.cleanup, \"we should not leave files in REAL_S3\"\n805 \n",
      "col_offset": 12,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 804,
      "line_range": [
        804
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1088                 else:\n1089                     assert isinstance(config.pageserver_config_override, str)\n1090                     for o in config.pageserver_config_override.split(\";\"):\n",
      "col_offset": 20,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1089,
      "line_range": [
        1089
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1234         \"\"\"\n1235         assert (\n1236             len(self.pageservers) == 1\n1237         ), \"env.pageserver must only be used with single pageserver NeonEnv\"\n1238         return self.pageservers[0]\n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1235,
      "line_range": [
        1235,
        1236,
        1237
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1273         bin_pageserver = str(self.neon_binpath / binary_name)\n1274         res = subprocess.run(\n1275             [bin_pageserver, \"--version\"],\n1276             check=True,\n1277             text=True,\n1278             capture_output=True,\n1279         )\n1280         return res.stdout\n",
      "col_offset": 14,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 1274,
      "line_range": [
        1274,
        1275,
        1276,
        1277,
        1278,
        1279
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "1288         # compare generate_auth_keys() in local_env.rs\n1289         subprocess.run(\n1290             [\"openssl\", \"genpkey\", \"-algorithm\", \"ed25519\", \"-out\", privkey_path],\n1291             cwd=self.repo_dir,\n1292             check=True,\n1293         )\n1294 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 1289,
      "line_range": [
        1289,
        1290,
        1291,
        1292,
        1293
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "1288         # compare generate_auth_keys() in local_env.rs\n1289         subprocess.run(\n1290             [\"openssl\", \"genpkey\", \"-algorithm\", \"ed25519\", \"-out\", privkey_path],\n1291             cwd=self.repo_dir,\n1292             check=True,\n1293         )\n1294 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 1289,
      "line_range": [
        1289,
        1290,
        1291,
        1292,
        1293
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "1294 \n1295         subprocess.run(\n1296             [\n1297                 \"openssl\",\n1298                 \"pkey\",\n1299                 \"-in\",\n1300                 privkey_path,\n1301                 \"-pubout\",\n1302                 \"-out\",\n1303                 pubkey_path,\n1304             ],\n1305             cwd=self.repo_dir,\n1306             check=True,\n1307         )\n1308         del self.auth_keys\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 1295,
      "line_range": [
        1295,
        1296,
        1297,
        1298,
        1299,
        1300,
        1301,
        1302,
        1303,
        1304,
        1305,
        1306,
        1307
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "1294 \n1295         subprocess.run(\n1296             [\n1297                 \"openssl\",\n1298                 \"pkey\",\n1299                 \"-in\",\n1300                 privkey_path,\n1301                 \"-pubout\",\n1302                 \"-out\",\n1303                 pubkey_path,\n1304             ],\n1305             cwd=self.repo_dir,\n1306             check=True,\n1307         )\n1308         del self.auth_keys\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 1295,
      "line_range": [
        1295,
        1296,
        1297,
        1298,
        1299,
        1300,
        1301,
        1302,
        1303,
        1304,
        1305,
        1306,
        1307
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "1533         res = self.log_contains(pattern, offset=offset)\n1534         assert res is not None\n1535         return res\n",
      "col_offset": 8,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1534,
      "line_range": [
        1534
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1614     ):\n1615         assert not self.running\n1616         self.env.neon_cli.storage_controller_start(timeout_in_seconds, instance_id, base_port)\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1615,
      "line_range": [
        1615
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1712         def storage_controller_ready():\n1713             assert self.ready() is True\n1714 \n",
      "col_offset": 12,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1713,
      "line_range": [
        1713
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1734         gen = response.json()[\"gen\"]\n1735         assert isinstance(gen, int)\n1736         return gen\n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1735,
      "line_range": [
        1735
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1970         log.info(f\"Migrated tenant {tenant_shard_id} to pageserver {dest_ps_id}\")\n1971         assert self.env.get_tenant_pageserver(tenant_shard_id).id == dest_ps_id\n1972 \n",
      "col_offset": 8,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1971,
      "line_range": [
        1971
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2231         for tid, placement in tenant_placement.items():\n2232             assert placement[\"observed\"][\"attached\"] is not None\n2233             primary_id = placement[\"observed\"][\"attached\"]\n",
      "col_offset": 12,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2232,
      "line_range": [
        2232
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2234 \n2235             assert len(placement[\"observed\"][\"secondary\"]) == 1\n2236             secondary_id = placement[\"observed\"][\"secondary\"][0]\n",
      "col_offset": 12,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2235,
      "line_range": [
        2235
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2251 \n2252         assert list(metric_values.values()).count(1) == 1\n2253 \n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2252,
      "line_range": [
        2252
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2275             json = response.json()\n2276             assert isinstance(json, dict)\n2277             return json\n",
      "col_offset": 12,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2276,
      "line_range": [
        2276
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2316     ):\n2317         assert instance_id is not None and base_port is not None\n2318 \n",
      "col_offset": 8,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2317,
      "line_range": [
        2317
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2327     ) -> NeonStorageController:\n2328         assert instance_id in self.instances\n2329         if self.instances[instance_id][\"running\"]:\n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2328,
      "line_range": [
        2328
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2452         \"\"\"\n2453         assert self.running is False\n2454 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2453,
      "line_range": [
        2453
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2516             log.info(f\"any_unstable={any_unstable}\")\n2517             assert not any_unstable\n2518 \n",
      "col_offset": 12,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2517,
      "line_range": [
        2517
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2567             value = self.http_client().get_metric_value(metric)\n2568             assert value == 0, f\"Nonzero {metric} == {value}\"\n2569 \n",
      "col_offset": 12,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2568,
      "line_range": [
        2568
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2773         self._log_env(env)\n2774         return subprocess.Popen(command, env=env, cwd=cwd, stdout=subprocess.PIPE, text=True)\n2775 \n",
      "col_offset": 15,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 2774,
      "line_range": [
        2774
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "2835         cmd = f\"{pg_controldata_path} -D {pgdata}\"\n2836         result = subprocess.run(cmd, capture_output=True, text=True, shell=True)\n2837         checkpoint_lsn = re.findall(\n",
      "col_offset": 17,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 2836,
      "line_range": [
        2836
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    },
    {
      "code": "2884     def enable_tls(self):\n2885         assert not self.running\n2886         # generate self-signed certificate\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2885,
      "line_range": [
        2885
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2886         # generate self-signed certificate\n2887         subprocess.run(\n2888             [\n2889                 \"openssl\",\n2890                 \"req\",\n2891                 \"-new\",\n2892                 \"-x509\",\n2893                 \"-days\",\n2894                 \"365\",\n2895                 \"-nodes\",\n2896                 \"-text\",\n2897                 \"-out\",\n2898                 self.pgdatadir / \"server.crt\",\n2899                 \"-keyout\",\n2900                 self.pgdatadir / \"server.key\",\n2901                 \"-subj\",\n2902                 \"/CN=localhost\",\n2903             ]\n2904         )\n2905         # configure postgresql.conf\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 2887,
      "line_range": [
        2887,
        2888,
        2889,
        2890,
        2891,
        2892,
        2893,
        2894,
        2895,
        2896,
        2897,
        2898,
        2899,
        2900,
        2901,
        2902,
        2903,
        2904
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "2886         # generate self-signed certificate\n2887         subprocess.run(\n2888             [\n2889                 \"openssl\",\n2890                 \"req\",\n2891                 \"-new\",\n2892                 \"-x509\",\n2893                 \"-days\",\n2894                 \"365\",\n2895                 \"-nodes\",\n2896                 \"-text\",\n2897                 \"-out\",\n2898                 self.pgdatadir / \"server.crt\",\n2899                 \"-keyout\",\n2900                 self.pgdatadir / \"server.key\",\n2901                 \"-subj\",\n2902                 \"/CN=localhost\",\n2903             ]\n2904         )\n2905         # configure postgresql.conf\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 2887,
      "line_range": [
        2887,
        2888,
        2889,
        2890,
        2891,
        2892,
        2893,
        2894,
        2895,
        2896,
        2897,
        2898,
        2899,
        2900,
        2901,
        2902,
        2903,
        2904
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "2915         \"\"\"Append lines into postgresql.conf file.\"\"\"\n2916         assert not self.running\n2917         with open(os.path.join(self.pgdatadir, \"postgresql.conf\"), \"a\") as conf_file:\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2916,
      "line_range": [
        2916
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2922         \"\"\"Prepend hba lines into pg_hba.conf file.\"\"\"\n2923         assert not self.running\n2924         with open(os.path.join(self.pgdatadir, \"pg_hba.conf\"), \"r+\") as conf_file:\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2923,
      "line_range": [
        2923
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2930     def start(self, log_path: Optional[str] = None):\n2931         assert not self.running\n2932         self.running = True\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2931,
      "line_range": [
        2931
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2940     def stop(self):\n2941         assert self.running\n2942         self.running = False\n",
      "col_offset": 8,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2941,
      "line_range": [
        2941
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3075         full_path = shutil.which(path, path=search_path)\n3076         assert full_path is not None\n3077 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3076,
      "line_range": [
        3076
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3187     def start(self) -> NeonProxy:\n3188         assert self._popen is None\n3189 \n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3188,
      "line_range": [
        3188
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3194         if not key_path.exists():\n3195             r = subprocess.run(\n3196                 [\n3197                     \"openssl\",\n3198                     \"req\",\n3199                     \"-new\",\n3200                     \"-x509\",\n3201                     \"-days\",\n3202                     \"365\",\n3203                     \"-nodes\",\n3204                     \"-text\",\n3205                     \"-out\",\n3206                     str(crt_path),\n3207                     \"-keyout\",\n3208                     str(key_path),\n3209                     \"-subj\",\n3210                     \"/CN=*.localtest.me\",\n3211                     \"-addext\",\n3212                     \"subjectAltName = DNS:*.localtest.me\",\n3213                 ]\n3214             )\n3215             assert r.returncode == 0\n",
      "col_offset": 16,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 3195,
      "line_range": [
        3195,
        3196,
        3197,
        3198,
        3199,
        3200,
        3201,
        3202,
        3203,
        3204,
        3205,
        3206,
        3207,
        3208,
        3209,
        3210,
        3211,
        3212,
        3213,
        3214
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "3194         if not key_path.exists():\n3195             r = subprocess.run(\n3196                 [\n3197                     \"openssl\",\n3198                     \"req\",\n3199                     \"-new\",\n3200                     \"-x509\",\n3201                     \"-days\",\n3202                     \"365\",\n3203                     \"-nodes\",\n3204                     \"-text\",\n3205                     \"-out\",\n3206                     str(crt_path),\n3207                     \"-keyout\",\n3208                     str(key_path),\n3209                     \"-subj\",\n3210                     \"/CN=*.localtest.me\",\n3211                     \"-addext\",\n3212                     \"subjectAltName = DNS:*.localtest.me\",\n3213                 ]\n3214             )\n3215             assert r.returncode == 0\n",
      "col_offset": 16,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 3195,
      "line_range": [
        3195,
        3196,
        3197,
        3198,
        3199,
        3200,
        3201,
        3202,
        3203,
        3204,
        3205,
        3206,
        3207,
        3208,
        3209,
        3210,
        3211,
        3212,
        3213,
        3214
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "3214             )\n3215             assert r.returncode == 0\n3216 \n",
      "col_offset": 12,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3215,
      "line_range": [
        3215
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3238         logfile = open(self.test_output_dir / \"proxy.log\", \"w\")\n3239         self._popen = subprocess.Popen(args, stdout=logfile, stderr=logfile)\n3240         self._wait_until_ready()\n",
      "col_offset": 22,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 3239,
      "line_range": [
        3239
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "3255     def _wait_until_ready(self):\n3256         assert (\n3257             self._popen and self._popen.poll() is None\n3258         ), \"Proxy exited unexpectedly. Check test log.\"\n3259         requests.get(f\"http://{self.host}:{self.http_port}/v1/status\")\n",
      "col_offset": 8,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3256,
      "line_range": [
        3256,
        3257,
        3258
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3258         ), \"Proxy exited unexpectedly. Check test log.\"\n3259         requests.get(f\"http://{self.host}:{self.http_port}/v1/status\")\n3260 \n",
      "col_offset": 8,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 3259,
      "line_range": [
        3259
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "3283         if expected_code is not None:\n3284             assert response.status_code == expected_code, f\"response: {response.json()}\"\n3285         return response.json()\n",
      "col_offset": 12,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3284,
      "line_range": [
        3284
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3295         connstr = f\"postgresql://{user}:{password}@{self.domain}:{self.proxy_port}/postgres\"\n3296         async with httpx.AsyncClient(\n3297             http2=True, verify=str(self.test_output_dir / \"proxy.crt\")\n3298         ) as client:\n3299             response = await client.post(\n",
      "col_offset": 19,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to httpx without timeout",
      "line_number": 3296,
      "line_range": [
        3296,
        3297,
        3298
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "3307             )\n3308             assert response.http_version == \"HTTP/2\"\n3309 \n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3308,
      "line_range": [
        3308
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3310             if expected_code is not None:\n3311                 assert response.status_code == expected_code, f\"response: {response.json()}\"\n3312             return response.json()\n",
      "col_offset": 16,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3311,
      "line_range": [
        3311
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3314     def get_metrics(self) -> str:\n3315         request_result = requests.get(f\"http://{self.host}:{self.http_port}/metrics\")\n3316         return request_result.text\n",
      "col_offset": 25,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 3315,
      "line_range": [
        3315
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "3319     def get_session_id(uri_prefix, uri_line):\n3320         assert uri_prefix in uri_line\n3321 \n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3320,
      "line_range": [
        3320
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3323         psql_session_id = url_parts.path[1:]\n3324         assert psql_session_id.isalnum(), \"session_id should only contain alphanumeric chars\"\n3325 \n",
      "col_offset": 8,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3324,
      "line_range": [
        3324
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3389         ).run(db_info)\n3390         assert psql.stdout is not None\n3391         out = (await psql.stdout.read()).decode(\"utf-8\").strip()\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3390,
      "line_range": [
        3390
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3391         out = (await psql.stdout.read()).decode(\"utf-8\").strip()\n3392         assert out == \"ok\"\n3393 \n",
      "col_offset": 8,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3392,
      "line_range": [
        3392
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3557 \n3558         assert self.endpoint_id is not None\n3559 \n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3558,
      "line_range": [
        3558
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3578         \"\"\"Path to endpoint directory\"\"\"\n3579         assert self.endpoint_id\n3580         path = Path(\"endpoints\") / self.endpoint_id\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3579,
      "line_range": [
        3579
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3629     ):\n3630         assert self.endpoint_id is not None\n3631         # If `safekeepers` is not None, they are remember them as active and use\n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3630,
      "line_range": [
        3630
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3657                 migration_id: int = cur.fetchall()[0][0]\n3658                 assert migration_id >= num_migrations\n3659 \n",
      "col_offset": 16,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3658,
      "line_range": [
        3658
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3698         if running:\n3699             assert self.endpoint_id is not None\n3700             self.env.neon_cli.endpoint_stop(\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3699,
      "line_range": [
        3699
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3718         if running:\n3719             assert self.endpoint_id is not None\n3720             self.env.neon_cli.endpoint_stop(\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3719,
      "line_range": [
        3719
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3775         self.safe_psql(\"checkpoint\")\n3776         assert self.pgdata_dir is not None  # please mypy\n3777         return get_dir_size(self.pgdata_dir / \"pg_wal\") / 1024 / 1024\n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3776,
      "line_range": [
        3776
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3879         branch_name = origin.branch_name\n3880         assert origin in self.endpoints\n3881         assert branch_name is not None\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3880,
      "line_range": [
        3880
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3880         assert origin in self.endpoints\n3881         assert branch_name is not None\n3882 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3881,
      "line_range": [
        3881
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3895         branch_name = origin.branch_name\n3896         assert origin in self.endpoints\n3897         assert branch_name is not None\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3896,
      "line_range": [
        3896
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3896         assert origin in self.endpoints\n3897         assert branch_name is not None\n3898 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3897,
      "line_range": [
        3897
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3962 \n3963         assert self.running is False\n3964 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3963,
      "line_range": [
        3963
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3998     def assert_no_errors(self):\n3999         assert not self.log_contains(\"manager task finished prematurely\")\n4000         assert not self.log_contains(\"error while acquiring WalResidentTimeline guard\")\n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3999,
      "line_range": [
        3999
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3999         assert not self.log_contains(\"manager task finished prematurely\")\n4000         assert not self.log_contains(\"error while acquiring WalResidentTimeline guard\")\n4001         assert not self.log_contains(\"timeout while acquiring WalResidentTimeline guard\")\n",
      "col_offset": 8,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4000,
      "line_range": [
        4000
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4000         assert not self.log_contains(\"error while acquiring WalResidentTimeline guard\")\n4001         assert not self.log_contains(\"timeout while acquiring WalResidentTimeline guard\")\n4002 \n",
      "col_offset": 8,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4001,
      "line_range": [
        4001
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4026                 res = json.loads(all[0][0])\n4027                 assert isinstance(res, dict)\n4028                 return res\n",
      "col_offset": 16,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4027,
      "line_range": [
        4027
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4086         )\n4087         assert isinstance(self.env.safekeepers_remote_storage, LocalFsStorage)\n4088         segs = self._list_segments_in_dir(\n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4087,
      "line_range": [
        4087
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4126             )\n4127             assert all(target_segment_file <= s for s in segments)\n4128 \n",
      "col_offset": 12,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4127,
      "line_range": [
        4127
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4133             )\n4134             assert stat.remote_consistent_lsn >= lsn and stat.backup_lsn >= lsn.segment_lsn()\n4135 \n",
      "col_offset": 12,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4134,
      "line_range": [
        4134
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4165     ):\n4166         assert not self.running\n4167         self.env.neon_cli.storage_broker_start(timeout_in_seconds)\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4166,
      "line_range": [
        4166
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4200     ) -> str:\n4201         assert isinstance(self.env.pageserver_remote_storage, S3Storage)\n4202         s3_storage = self.env.pageserver_remote_storage\n",
      "col_offset": 8,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4201,
      "line_range": [
        4201
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4240 \n4241         assert stdout is not None\n4242         return stdout\n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4241,
      "line_range": [
        4241
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4442     psql_env = {\"LD_LIBRARY_PATH\": pg_bin.pg_lib_dir}\n4443     result = subprocess.run(cmd, env=psql_env, capture_output=True, text=True, shell=True)\n4444 \n",
      "col_offset": 13,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 4443,
      "line_range": [
        4443
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    },
    {
      "code": "4449         log.error(result.stderr)\n4450     assert result.returncode == 0\n4451 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4450,
      "line_range": [
        4450
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4452     # list files we're going to compare\n4453     assert endpoint.pgdata_dir\n4454     pgdata_files = list_files_to_compare(Path(endpoint.pgdata_dir))\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4453,
      "line_range": [
        4453
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4470     # check that file sets are equal\n4471     assert pgdata_files == restored_files\n4472 \n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4471,
      "line_range": [
        4471
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4487         with open(stdout_filename, \"w\") as stdout_f:\n4488             subprocess.run(f\"xxd -b {f1} > {f1}.hex \", shell=True)\n4489             subprocess.run(f\"xxd -b {f2} > {f2}.hex \", shell=True)\n",
      "col_offset": 12,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 4488,
      "line_range": [
        4488
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    },
    {
      "code": "4488             subprocess.run(f\"xxd -b {f1} > {f1}.hex \", shell=True)\n4489             subprocess.run(f\"xxd -b {f2} > {f2}.hex \", shell=True)\n4490 \n",
      "col_offset": 12,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 4489,
      "line_range": [
        4489
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    },
    {
      "code": "4491             cmd = f\"diff {f1}.hex {f2}.hex\"\n4492             subprocess.run([cmd], stdout=stdout_f, shell=True)\n4493 \n",
      "col_offset": 12,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 4492,
      "line_range": [
        4492
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    },
    {
      "code": "4493 \n4494     assert (mismatch, error) == ([], [])\n4495 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4494,
      "line_range": [
        4494
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4593 \n4594         assert waited >= last_flush_lsn\n4595         results.append(waited)\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4594,
      "line_range": [
        4594
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4638 \n4639         assert waited >= commit_lsn\n4640 \n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4639,
      "line_range": [
        4639
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4660 \n4661     assert result is not None\n4662     return result\n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4661,
      "line_range": [
        4661
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4790         tenant_id = env.initial_tenant\n4791     assert tenant_id is not None\n4792 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4791,
      "line_range": [
        4791
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4794         timeline_id = env.initial_timeline\n4795     assert timeline_id is not None\n4796 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4795,
      "line_range": [
        4795
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4810                 [\n4811                     f\"\"\"\n4812                 INSERT INTO foo (id, val)\n4813                 SELECT g, '{data}'\n4814                 FROM generate_series(1, 200) g\n4815                 ON CONFLICT (id) DO UPDATE\n4816                 SET val = EXCLUDED.val\n4817                 \"\"\",\n4818                     # to ensure that GC can actually remove some layers\n",
      "col_offset": 24,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 4811,
      "line_range": [
        4811,
        4812,
        4813,
        4814,
        4815,
        4816,
        4817
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "4821             )\n4822             assert tenant_id is not None\n4823             assert timeline_id is not None\n",
      "col_offset": 12,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4822,
      "line_range": [
        4822
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4822             assert tenant_id is not None\n4823             assert timeline_id is not None\n4824             # We are waiting for uploads as well as local flush, in order to avoid leaving the system\n",
      "col_offset": 12,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4823,
      "line_range": [
        4823
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4836         print_gc_result(gc_result)\n4837         assert gc_result[\"layers_removed\"] > 0\n4838 \n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\neon_fixtures.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 4837,
      "line_range": [
        4837
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "28         )\n29         assert self == parse_layer_file_name(ret)\n30         return ret\n",
      "col_offset": 8,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\common_types.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 29,
      "line_range": [
        29
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44         ret = f\"{self.key_start.as_int():036X}-{self.key_end.as_int():036X}__{self.lsn_start.as_int():016X}-{self.lsn_end.as_int():016X}\"\n45         assert self == parse_layer_file_name(ret)\n46         return ret\n",
      "col_offset": 8,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\common_types.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "31     def __init__(self, res: requests.Response):\n32         assert res.status_code == 406\n33         super().__init__(res.json()[\"msg\"], res.status_code)\n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 32,
      "line_range": [
        32
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "37     def __init__(self, res: requests.Response):\n38         assert res.status_code == 409\n39         super().__init__(res.json()[\"msg\"], res.status_code)\n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 38,
      "line_range": [
        38
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "72         l0_ness = d.get(\"l0\")\n73         assert l0_ness is None or isinstance(l0_ness, bool)\n74 \n",
      "col_offset": 8,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 73,
      "line_range": [
        73
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75         size = d[\"layer_file_size\"]\n76         assert isinstance(size, int)\n77 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "99         json_in_memory_layers = d[\"in_memory_layers\"]\n100         assert isinstance(json_in_memory_layers, list)\n101         for json_in_memory_layer in json_in_memory_layers:\n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 100,
      "line_range": [
        100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104         json_historic_layers = d[\"historic_layers\"]\n105         assert isinstance(json_historic_layers, list)\n106         for json_historic_layer in json_historic_layers:\n",
      "col_offset": 8,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 105,
      "line_range": [
        105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "138         a = self\n139         assert isinstance(a, ScanDisposableKeysResponse)\n140         assert isinstance(b, ScanDisposableKeysResponse)\n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 139,
      "line_range": [
        139
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "139         assert isinstance(a, ScanDisposableKeysResponse)\n140         assert isinstance(b, ScanDisposableKeysResponse)\n141         return ScanDisposableKeysResponse(\n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 140,
      "line_range": [
        140
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "264         res_json = res.json()\n265         assert res_json is None\n266         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 265,
      "line_range": [
        265
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "275         res_json = res.json()\n276         assert isinstance(res_json, list)\n277         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 276,
      "line_range": [
        276
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "345         res_json = res.json()\n346         assert isinstance(res_json[\"tenant_shards\"], list)\n347         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 346,
      "line_range": [
        346
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "377         res_json = res.json()\n378         assert isinstance(res_json, dict)\n379         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 378,
      "line_range": [
        378
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "406     def set_tenant_config(self, tenant_id: Union[TenantId, TenantShardId], config: dict[str, Any]):\n407         assert \"tenant_id\" not in config.keys()\n408         res = self.put(\n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 407,
      "line_range": [
        407
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "439         res = res.json()\n440         assert isinstance(res, dict)\n441         assert TenantId(res[\"id\"]) == tenant_id\n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 440,
      "line_range": [
        440
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "440         assert isinstance(res, dict)\n441         assert TenantId(res[\"id\"]) == tenant_id\n442         size = res[\"size\"]\n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 441,
      "line_range": [
        441
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "442         size = res[\"size\"]\n443         assert isinstance(size, int)\n444         inputs = res[\"inputs\"]\n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 443,
      "line_range": [
        443
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "444         inputs = res[\"inputs\"]\n445         assert isinstance(inputs, dict)\n446         return (size, inputs)\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 445,
      "line_range": [
        445
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "496         res_json = res.json()\n497         assert isinstance(res_json, list)\n498         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 497,
      "line_range": [
        497
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "508         res_json = res.json()\n509         assert isinstance(res_json, dict)\n510         return TimelinesInfoAndOffloaded.from_json(res_json)\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 509,
      "line_range": [
        509
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "544         res_json = res.json()\n545         assert isinstance(res_json, dict)\n546         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 545,
      "line_range": [
        545
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "571         res_json = res.json()\n572         assert isinstance(res_json, dict)\n573         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 572,
      "line_range": [
        572
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "587         res_json = res.json()\n588         assert res_json is None\n589 \n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 588,
      "line_range": [
        588
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "611         res_json = res.json()\n612         assert res_json is not None\n613         assert isinstance(res_json, dict)\n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 612,
      "line_range": [
        612
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "612         assert res_json is not None\n613         assert isinstance(res_json, dict)\n614         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 613,
      "line_range": [
        613
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "645         res_json = res.json()\n646         assert res_json is None\n647 \n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 646,
      "line_range": [
        646
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "678         res_json = res.json()\n679         assert res_json is None\n680 \n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 679,
      "line_range": [
        679
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "799         res_json = res.json()\n800         assert res_json is None\n801 \n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 800,
      "line_range": [
        800
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "816         res_json = res.json()\n817         assert res_json is not None\n818         assert isinstance(res_json, dict)\n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 817,
      "line_range": [
        817
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "817         assert res_json is not None\n818         assert isinstance(res_json, dict)\n819         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 818,
      "line_range": [
        818
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "832         res_json = res.json()\n833         assert res_json is not None\n834         assert isinstance(res_json, dict)\n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 833,
      "line_range": [
        833
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "833         assert res_json is not None\n834         assert isinstance(res_json, dict)\n835 \n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 834,
      "line_range": [
        834
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "836         # assumption in this API client here is that nobody else spawns the task\n837         assert res_json[\"task_id\"] == spawn_response[\"task_id\"]\n838 \n",
      "col_offset": 8,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 837,
      "line_range": [
        837
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "861             if not errors_ok:\n862                 assert completed[\"failed_download_count\"] == 0\n863             if at_least_one_download:\n",
      "col_offset": 16,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 862,
      "line_range": [
        862
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "863             if at_least_one_download:\n864                 assert completed[\"successful_download_count\"] > 0\n865             return completed\n",
      "col_offset": 16,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 864,
      "line_range": [
        864
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "913         queue_count = int(inc) - int(dec)\n914         assert queue_count >= 0\n915         return queue_count\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 914,
      "line_range": [
        914
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "934         self.verbose_error(res)\n935         assert res.status_code == 200\n936         return ScanDisposableKeysResponse.from_json(res.json())\n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 935,
      "line_range": [
        935
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "945 \n946         assert res.status_code == 200\n947 \n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 946,
      "line_range": [
        946
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "983 \n984         assert res.status_code in (200, 304)\n985 \n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 984,
      "line_range": [
        984
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1026         non_incremental = detail[\"current_logical_size_non_incremental\"]\n1027         assert current_logical_size == non_incremental\n1028         assert isinstance(current_logical_size, int)\n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1027,
      "line_range": [
        1027
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1027         assert current_logical_size == non_incremental\n1028         assert isinstance(current_logical_size, int)\n1029         return current_logical_size\n",
      "col_offset": 8,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1028,
      "line_range": [
        1028
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "31     remote_storage = env.pageserver_remote_storage\n32     assert isinstance(remote_storage, LocalFsStorage)\n33 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\many_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 32,
      "line_range": [
        32
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "62     # => do the on-demand downloads in Python.\n63     assert ps_http.tenant_list() == []\n64 \n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\many_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 63,
      "line_range": [
        63
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "24     remote_storage = env.pageserver_remote_storage\n25     assert isinstance(remote_storage, LocalFsStorage)\n26 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 25,
      "line_range": [
        25
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "27     src_timelines_dir: Path = remote_storage.tenant_path(template_tenant) / \"timelines\"\n28     assert src_timelines_dir.is_dir(), f\"{src_timelines_dir} is not a directory\"\n29 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 28,
      "line_range": [
        28
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "29 \n30     assert isinstance(remote_storage, LocalFsStorage)\n31     dst_timelines_dir: Path = remote_storage.tenant_path(new_tenant) / \"timelines\"\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 30,
      "line_range": [
        30
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "36         src_tl_dir = src_timelines_dir / tl.name\n37         assert src_tl_dir.is_dir(), f\"{src_tl_dir} is not a directory\"\n38         dst_tl_dir = dst_timelines_dir / tl.name\n",
      "col_offset": 8,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 37,
      "line_range": [
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "58 def duplicate_tenant(env: NeonEnv, template_tenant: TenantId, ncopies: int) -> list[TenantId]:\n59     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n60 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 59,
      "line_range": [
        59
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77         else:\n78             assert len(comps) == 2\n79             layer_file_name, _generation = comps\n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89     remote_storage = env.pageserver_remote_storage\n90     assert isinstance(remote_storage, LocalFsStorage)\n91     work: queue.Queue[Any] = queue.Queue()\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "98             local_name = local_layer_name_from_remote_name(remote_layer.name)\n99             assert local_name not in downloads, \"remote storage must have had split brain\"\n100             downloads[local_name] = remote_layer\n",
      "col_offset": 12,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 99,
      "line_range": [
        99
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "30     log.info(f\"tenant_status: {tenant_status}\")\n31     assert tenant_status[\"state\"][\"slug\"] == expected_state, message or tenant_status\n32 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 31,
      "line_range": [
        31
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "47         lsn_str = detail[\"remote_consistent_lsn\"]\n48         assert isinstance(lsn_str, str)\n49         return Lsn(lsn_str)\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 48,
      "line_range": [
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "194     lsn_str = detail[\"last_record_lsn\"]\n195     assert isinstance(lsn_str, str)\n196     return Lsn(lsn_str)\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 195,
      "line_range": [
        195
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "247                 if all([s.labels[label] == f.labels[label] for label in remaining_labels]):\n248                     assert (\n249                         not found\n250                     ), \"duplicate match, remaining_labels don't uniquely identify sample\"\n251                     tl.append((s.labels, int(s.value) - int(f.value)))\n",
      "col_offset": 20,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 248,
      "line_range": [
        248,
        249,
        250
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "254                 tl.append((s.labels, int(s.value)))\n255         assert len(tl) == len(started), \"something broken with join logic\"\n256         log.info(f\"upload queue for {tenant_id}/{timeline_id}:\")\n",
      "col_offset": 8,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 255,
      "line_range": [
        255
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "307 ) -> None:\n308     assert remote_storage is not None\n309     response = list_prefix(remote_storage, prefix, delimiter)\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 308,
      "line_range": [
        308
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "341 \n342     assert filtered_count == 0, f\"remote prefix {prefix} is not empty: {objects}\"\n343 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 342,
      "line_range": [
        342
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "350 ):\n351     assert remote_storage is not None\n352     response = list_prefix(remote_storage, prefix)\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 351,
      "line_range": [
        351
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "352     response = list_prefix(remote_storage, prefix)\n353     assert response[\"KeyCount\"] != 0, f\"remote prefix {prefix} is empty: {response}\"\n354 \n",
      "col_offset": 4,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 353,
      "line_range": [
        353
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "362     # For local_fs we need to properly handle empty directories, which we currently dont, so for simplicity stick to s3 api.\n363     assert isinstance(remote, S3Storage), \"localfs is currently not supported\"\n364 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 363,
      "line_range": [
        363
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "389     # For local_fs we need to use a different implementation. As we don't need local_fs, just don't support it for now.\n390     assert isinstance(remote, S3Storage), \"localfs is currently not supported\"\n391 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 390,
      "line_range": [
        390
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "411     # local_fs has no support for versioning\n412     assert isinstance(remote, S3Storage), \"localfs is currently not supported\"\n413 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 412,
      "line_range": [
        412
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "415     # these settings from a test in a live bucket (also, our access isn't enough nor should it be)\n416     assert not remote.real, \"Enabling storage versioning only supported on Mock S3\"\n417 \n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pageserver\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 416,
      "line_range": [
        416
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "62     v = toml.loads(toml_table)\n63     assert isinstance(v, dict)\n64     return v\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\parametrize.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 63,
      "line_range": [
        63
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4 import shutil\n5 import subprocess\n6 import threading\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 5,
      "line_range": [
        5
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "105     compatibility_snapshot_dir_env = os.environ.get(\"COMPATIBILITY_SNAPSHOT_DIR\")\n106     assert (\n107         compatibility_snapshot_dir_env is not None\n108     ), \"COMPATIBILITY_SNAPSHOT_DIR is not set. It should be set to `compatibility_snapshot_pg(PG_VERSION)` path generateted by test_create_snapshot (ideally generated by the previous version of Neon)\"\n109     compatibility_snapshot_dir = Path(compatibility_snapshot_dir_env).resolve()\n",
      "col_offset": 4,
      "end_col_offset": 200,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 106,
      "line_range": [
        106,
        107,
        108
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "188         if k == \"preserve_database_files\":\n189             assert isinstance(v, bool)\n190             preserve_database_files = v\n",
      "col_offset": 12,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 189,
      "line_range": [
        189
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "213     ):\n214         assert self.fd is not None\n215         assert self.thread_lock.locked()  # ... by us\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 214,
      "line_range": [
        214
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "214         assert self.fd is not None\n215         assert self.thread_lock.locked()  # ... by us\n216         flock(self.fd, LOCK_UN)\n",
      "col_offset": 8,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 215,
      "line_range": [
        215
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "243         self._path = path\n244         assert self._path.is_dir()\n245         self._lock = FileAndThreadLock(self.lock_file_path)\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 244,
      "line_range": [
        244
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "299         )\n300         subprocess.run(cmd, capture_output=True, check=True)\n301     # the overlayfs `workdir`` is owned by `root`, shutil.rmtree won't work.\n",
      "col_offset": 8,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 300,
      "line_range": [
        300
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "302     cmd = [\"sudo\", \"rm\", \"-rf\", str(overlay_dir)]\n303     subprocess.run(cmd, capture_output=True, check=True)\n304 \n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\paths.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 303,
      "line_range": [
        303
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "19     def query(self) -> str:\n20         return f\"SELECT {','.join(self.columns)} FROM {self.table} {self.additional_query}\"\n21 \n",
      "col_offset": 17,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\pg_stats.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 20,
      "line_range": [
        20
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "75         ports: list[str] = re.findall(r\":(\\d+)(?:/|$)\", value)\n76         assert len(ports) == 1, f\"can't find port in {value}\"\n77         port_int = int(ports[0])\n",
      "col_offset": 8,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\port_distributor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "123 \n124         assert generation is not None, \"Cannot calculate remote layer path without generation\"\n125 \n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 124,
      "line_range": [
        124
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "308     def mock_remote_tenant_path(self, tenant_id: TenantId):\n309         assert self.real is False\n310 \n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 309,
      "line_range": [
        309
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "345                 s = f\"{prefix}-{suffix}\"\n346                 assert len(s) == 63\n347 \n",
      "col_offset": 16,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 346,
      "line_range": [
        346
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "382 \n383         assert self == RemoteStorageKind.REAL_S3\n384 \n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 383,
      "line_range": [
        383
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "387         env_profile = os.getenv(\"AWS_PROFILE\")\n388         assert (\n389             env_access_key and env_secret_key\n390         ) or env_profile, \"need to specify either access key and secret access key or profile\"\n391 \n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 388,
      "line_range": [
        388,
        389,
        390
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "392         bucket_name = bucket_name or os.getenv(\"REMOTE_STORAGE_S3_BUCKET\")\n393         assert bucket_name is not None, \"no remote storage bucket name provided\"\n394         bucket_region = bucket_region or os.getenv(\"REMOTE_STORAGE_S3_REGION\")\n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 393,
      "line_range": [
        393
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "394         bucket_region = bucket_region or os.getenv(\"REMOTE_STORAGE_S3_REGION\")\n395         assert bucket_region is not None, \"no remote storage region provided\"\n396 \n",
      "col_offset": 8,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 395,
      "line_range": [
        395
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "117         res_json = res.json()\n118         assert res_json is None\n119         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 118,
      "line_range": [
        118
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "124         res_json = res.json()\n125         assert isinstance(res_json, dict)\n126         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 125,
      "line_range": [
        125
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "174             s = self.timeline_status(tenant_id, timeline_id).timeline_start_lsn\n175             assert s > Lsn(0)\n176             return s\n",
      "col_offset": 12,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 175,
      "line_range": [
        175
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "194         res_json = res.json()\n195         assert isinstance(res_json, dict)\n196         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 195,
      "line_range": [
        195
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "202         res_json = json.loads(res.text)\n203         assert isinstance(res_json, dict)\n204         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 203,
      "line_range": [
        203
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "225         res_json = res.json()\n226         assert isinstance(res_json, dict)\n227         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 226,
      "line_range": [
        226
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "250         res_json = res.json()\n251         assert isinstance(res_json, dict)\n252         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 251,
      "line_range": [
        251
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "272         res_json = res.json()\n273         assert isinstance(res_json, dict)\n274         return res_json\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\http.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 273,
      "line_range": [
        273
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "19         log.info(f\"waiting for walreceivers to be gone, currently {status.walreceivers}\")\n20         assert len(status.walreceivers) == 0\n21 \n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\safekeeper\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 20,
      "line_range": [
        20
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "7 import re\n8 import subprocess\n9 import tarfile\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 8,
      "line_range": [
        8
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "88     \"\"\"\n89     assert isinstance(cmd, list)\n90     base_cmd = os.path.basename(cmd[0])\n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 89,
      "line_range": [
        89
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "136 \n137                 p = subprocess.Popen(\n138                     cmd,\n139                     **popen_kwargs,\n140                     stdout=subprocess.PIPE,\n141                     stderr=subprocess.PIPE,\n142                 )\n143                 stdout_handler = OutputHandler(\n",
      "col_offset": 20,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 137,
      "line_range": [
        137,
        138,
        139,
        140,
        141,
        142
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "204     var = cur.fetchone()\n205     assert var is not None\n206     return var[0]\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 205,
      "line_range": [
        205
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "370     with open(cwd / log_file_name, \"wb\") as log_file:\n371         spawned_process = subprocess.Popen(command, stdout=log_file, stderr=log_file, cwd=cwd)\n372         error = None\n",
      "col_offset": 26,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 371,
      "line_range": [
        371
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "424 def assert_eq(a, b) -> None:\n425     assert a == b\n426 \n",
      "col_offset": 4,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 425,
      "line_range": [
        425
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "428 def assert_gt(a, b) -> None:\n429     assert a > b\n430 \n",
      "col_offset": 4,
      "end_col_offset": 16,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 429,
      "line_range": [
        429
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "432 def assert_ge(a, b) -> None:\n433     assert a >= b\n434 \n",
      "col_offset": 4,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 433,
      "line_range": [
        433
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "514 \n515     assert not errors, f\"First log error on {service}: {errors[0]}\\nHint: use scripts/check_allowed_errors.sh to test any new allowed_error you add\"\n516 \n",
      "col_offset": 4,
      "end_col_offset": 148,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 515,
      "line_range": [
        515
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "547     def hash_extracted(reader: Optional[IO[bytes]]) -> bytes:\n548         assert reader is not None\n549         digest = sha256(usedforsecurity=False)\n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 548,
      "line_range": [
        548
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "567 \n568     assert len(left_list) == len(\n569         right_list\n570     ), f\"unexpected number of files on tar files, {len(left_list)} != {len(right_list)}\"\n571 \n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 568,
      "line_range": [
        568,
        569,
        570
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "576         right_path, right_hash = right_tuple\n577         assert (\n578             left_path == right_path\n579         ), f\"file count matched, expected these to be same paths: {left_path}, {right_path}\"\n580         if left_hash != right_hash:\n",
      "col_offset": 8,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 577,
      "line_range": [
        577,
        578,
        579
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "582 \n583     assert len(mismatching) == 0, f\"files with hash mismatch: {mismatching}\"\n584 \n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\utils.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 583,
      "line_range": [
        583
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "112         endpoint.safe_psql(\n113             f\"\"\"\n114             INSERT INTO {self.table} (id, val)\n115             SELECT g, '{dummy_value}'\n116             FROM generate_series({start}, {end}) g\n117             \"\"\"\n118         )\n",
      "col_offset": 16,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\workload.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 113,
      "line_range": [
        113,
        114,
        115,
        116,
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "129     ):\n130         assert self.expect_rows >= n\n131 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\workload.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 130,
      "line_range": [
        130
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "149 \n150             assert end < self.expect_rows\n151 \n",
      "col_offset": 12,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\workload.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 150,
      "line_range": [
        150
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "155                 [\n156                     f\"\"\"\n157                 INSERT INTO {self.table} (id, val)\n158                 SELECT g, '{dummy_value}'\n159                 FROM generate_series({start}, {end}) g\n160                 ON CONFLICT (id) DO UPDATE\n161                 SET val = EXCLUDED.val\n162                 \"\"\",\n163                     f\"VACUUM {self.table}\",\n",
      "col_offset": 24,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\workload.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 156,
      "line_range": [
        156,
        157,
        158,
        159,
        160,
        161,
        162
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "195         endpoint.clear_shared_buffers()\n196         result = endpoint.safe_psql(f\"SELECT COUNT(*) FROM {self.table}\")\n197 \n",
      "col_offset": 38,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\workload.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 196,
      "line_range": [
        196
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "198         log.info(f\"validate({self.expect_rows}): {result}\")\n199         assert result == [(self.expect_rows,)]\n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\fixtures\\workload.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 199,
      "line_range": [
        199
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "30     log.debug(res.result_rows)\n31     m = hashlib.sha1()\n32     m.update(repr(tuple(res.result_rows)).encode())\n",
      "col_offset": 8,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_clickhouse.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 327,
        "link": "https://cwe.mitre.org/data/definitions/327.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "Use of weak SHA1 hash for security. Consider usedforsecurity=False",
      "line_number": 31,
      "line_range": [
        31
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b324_hashlib.html",
      "test_id": "B324",
      "test_name": "hashlib"
    },
    {
      "code": "64         resp = self.__request(\"GET\")\n65         assert resp.ok\n66         return json.loads(resp.text)\n",
      "col_offset": 8,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 65,
      "line_range": [
        65
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "92     dbz = DebeziumAPI()\n93     assert len(dbz.list_connectors()) == 0\n94     dbz_conn_name = \"inventory-connector\"\n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "96     log.debug(\"%s %s %s\", resp.status_code, resp.ok, resp.text)\n97     assert resp.status_code == 201\n98     assert len(dbz.list_connectors()) == 1\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 97,
      "line_range": [
        97
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "97     assert resp.status_code == 201\n98     assert len(dbz.list_connectors()) == 1\n99     from kafka import KafkaConsumer\n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 98,
      "line_range": [
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "108     resp = dbz.del_connector(dbz_conn_name)\n109     assert resp.status_code == 204\n110 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 109,
      "line_range": [
        109
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "124     msg = consumer.poll()\n125     assert msg, \"Empty message\"\n126     for val in msg.values():\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 125,
      "line_range": [
        125
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "128         log.info(r[\"payload\"])\n129         assert ts_ms < r[\"payload\"][\"ts_ms\"], \"Incorrect timestamp\"\n130         for param, pname in ((before, \"before\"), (after, \"after\")):\n",
      "col_offset": 8,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 129,
      "line_range": [
        129
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132                 for k, v in param.items():\n133                     assert r[\"payload\"][pname][k] == v, f\"{pname} mismatches\"\n134 \n",
      "col_offset": 20,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\logical_repl\\test_debezium.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "123     await conn.execute(f\"ALTER TABLE {table} SET (autovacuum_enabled = false)\")\n124     await conn.execute(f\"INSERT INTO {table} VALUES (1, 0)\")\n125     await conn.execute(\n",
      "col_offset": 25,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\pagebench\\test_large_slru_basebackup.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 124,
      "line_range": [
        124
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "125     await conn.execute(\n126         f\"\"\"\n127         CREATE PROCEDURE updating{table}() as\n128         $$\n129             DECLARE\n130             i integer;\n131             BEGIN\n132             FOR i IN 1..{n_txns} LOOP\n133                 UPDATE {table} SET x = x + 1 WHERE pk=1;\n134                 COMMIT;\n135             END LOOP;\n136             END\n137         $$ LANGUAGE plpgsql\n138         \"\"\"\n139     )\n",
      "col_offset": 12,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\pagebench\\test_large_slru_basebackup.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 126,
      "line_range": [
        126,
        127,
        128,
        129,
        130,
        131,
        132,
        133,
        134,
        135,
        136,
        137,
        138
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "103         ep.safe_psql(\n104             f\"INSERT INTO data SELECT lpad(i::text, {bytes_per_row}, '0') FROM generate_series(1, {int(nrows)})  as i\",\n105             options=\"-c statement_timeout=0\",\n",
      "col_offset": 14,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\pagebench\\test_ondemand_download_churn.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 104,
      "line_range": [
        104
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "38             for layer in info.historic_layers:\n39                 assert not layer.remote\n40 \n",
      "col_offset": 16,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\pageserver\\util.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 39,
      "line_range": [
        39
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "78         # random a source branch\n79         p = random.randint(0, i)\n80 \n",
      "col_offset": 12,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_branch_creation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 79,
      "line_range": [
        79
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "105     # seed the prng so we will measure the same structure every time\n106     rng = random.Random(\"2024-02-29\")\n107 \n",
      "col_offset": 10,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_branch_creation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 106,
      "line_range": [
        106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "173     needle = re.search(\" elapsed_ms=([0-9]+)\", msg)\n174     assert needle is not None, \"failed to find the elapsed time\"\n175     duration = int(needle.group(1)) / 1000.0\n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_branch_creation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 174,
      "line_range": [
        174
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "204         ]\n205         assert len(matching) == len(expected_labels)\n206         return matching\n",
      "col_offset": 8,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_branch_creation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 205,
      "line_range": [
        205
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "231             for i in range(10000):\n232                 cur.execute(f\"CREATE TABLE t{i} as SELECT g FROM generate_series(1, 1000) g\")\n233 \n",
      "col_offset": 30,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_branch_creation.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 232,
      "line_range": [
        232
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "69     attach_status = env.env.storage_controller.inspect(tenant_shard_id=env.tenant)\n70     assert attach_status is not None\n71     (attach_gen, _) = attach_status\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_bulk_insert.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 70,
      "line_range": [
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "29     with zenbenchmark.record_duration(\"insert-1\"):\n30         cur.execute(f\"insert into t values (generate_series(1,{n_records}))\")\n31 \n",
      "col_offset": 22,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_bulk_update.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 30,
      "line_range": [
        30
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "51     with zenbenchmark.record_duration(\"insert-2\"):\n52         cur.execute(f\"insert into t2 values (generate_series(1,{n_records}))\")\n53 \n",
      "col_offset": 22,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_bulk_update.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 52,
      "line_range": [
        52
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "46                 cur.execute(f\"create table tbl{i} (i int, j int);\")\n47                 cur.execute(f\"insert into tbl{i} values (generate_series(1, 1000), 0);\")\n48                 for j in range(100):\n",
      "col_offset": 30,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "48                 for j in range(100):\n49                     cur.execute(f\"update tbl{i} set j = {j};\")\n50 \n",
      "col_offset": 34,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 49,
      "line_range": [
        49
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "91     tenant_conf = pageserver_http.tenant_config(tenant_id)\n92     assert tenant_conf.effective_config[\"checkpoint_distance\"] == 256 * 1024 * 1024\n93     assert tenant_conf.effective_config[\"compaction_threshold\"] == 10\n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "92     assert tenant_conf.effective_config[\"checkpoint_distance\"] == 256 * 1024 * 1024\n93     assert tenant_conf.effective_config[\"compaction_threshold\"] == 10\n94 \n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "100                 cur.execute(f\"create table tbl{i} (i int, j int);\")\n101                 cur.execute(f\"insert into tbl{i} values (generate_series(1, 1000), 0);\")\n102                 for j in range(100):\n",
      "col_offset": 30,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 101,
      "line_range": [
        101
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "102                 for j in range(100):\n103                     cur.execute(f\"update tbl{i} set j = {j};\")\n104 \n",
      "col_offset": 34,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 103,
      "line_range": [
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "115         v = pageserver_http.get_metric_value(\"libmetrics_maxrss_kb\")\n116         assert v is not None\n117         assert v > 0\n",
      "col_offset": 8,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 116,
      "line_range": [
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "116         assert v is not None\n117         assert v > 0\n118         return v * 1024\n",
      "col_offset": 8,
      "end_col_offset": 20,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 117,
      "line_range": [
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "129 \n130     assert after > before  # If we didn't use some memory the test is probably buggy\n131     compaction_mapped_rss = after - before\n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 130,
      "line_range": [
        130
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "142     # If we find that compaction is using more memory, this may indicate a regression\n143     assert compaction_mapped_rss < MEMORY_ESTIMATE\n144 \n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 143,
      "line_range": [
        143
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "147     # - maybe something is functionally wrong with the test and it's not driving the system as expected\n148     assert compaction_mapped_rss > MEMORY_ESTIMATE / 2\n149 \n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 148,
      "line_range": [
        148
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "151     # l0 to compact in one go\n152     assert len(layers.delta_l0_layers()) > 0\n153     assert len(layers.delta_l0_layers()) < initial_l0s\n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 152,
      "line_range": [
        152
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "152     assert len(layers.delta_l0_layers()) > 0\n153     assert len(layers.delta_l0_layers()) < initial_l0s\n154 \n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 153,
      "line_range": [
        153
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "122             while time.time() - start < duration:\n123                 cur.execute(f\"INSERT INTO t{table_id} SELECT FROM generate_series(1,1000)\")\n124 \n",
      "col_offset": 30,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_compare_pg_stats.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 123,
      "line_range": [
        123
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "11 def gc_feedback_impl(neon_env_builder: NeonEnvBuilder, zenbenchmark: NeonBenchmarker, mode: str):\n12     assert mode == \"normal\" or mode == \"with_snapshots\"\n13     env = neon_env_builder.init_start()\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_gc_feedback.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 12,
      "line_range": [
        12
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44         for step in range(n_steps):\n45             cur.execute(f\"INSERT INTO t (step) SELECT {step} FROM generate_series(1, {step_size})\")\n46             for _ in range(n_update_iters):\n",
      "col_offset": 26,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_gc_feedback.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "46             for _ in range(n_update_iters):\n47                 cur.execute(f\"UPDATE t set count=count+1 where step = {step}\")\n48                 cur.execute(\"vacuum t\")\n",
      "col_offset": 30,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_gc_feedback.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "33                 cur.execute(\n34                     f\"\"\"\n35                 DO $$\n36                 BEGIN\n37                     create table t (i integer);\n38                     insert into t values (0);\n39 \n40                     FOR j IN 1..{num_writes} LOOP\n41                         update t set i = j;\n42                     END LOOP;\n43                 END $$;\n44                 \"\"\"\n45                 )\n",
      "col_offset": 24,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_hot_page.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 34,
      "line_range": [
        34,
        35,
        36,
        37,
        38,
        39,
        40,
        41,
        42,
        43,
        44
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "31                 cur.execute(\"create table t (i integer primary key);\")\n32                 cur.execute(f\"insert into t values (generate_series(1,{num_rows}));\")\n33                 # PL/pgSQL block to perform updates (and avoid latency between client and server)\n",
      "col_offset": 30,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_hot_table.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 32,
      "line_range": [
        32
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "36                 cur.execute(\n37                     f\"\"\"\n38                 DO $$\n39                 DECLARE\n40                     r integer := {num_rows};\n41                 BEGIN\n42                     FOR j IN 1..{num_writes} LOOP\n43                         UPDATE t SET i = j + r WHERE i = j;\n44                     END LOOP;\n45                 END $$;\n46                 \"\"\"\n47                 )\n",
      "col_offset": 24,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_hot_table.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 37,
      "line_range": [
        37,
        38,
        39,
        40,
        41,
        42,
        43,
        44,
        45,
        46
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "33     for _ in range(n_iters):\n34         cur.execute(f\"insert into t values (generate_series(1,{n_records}))\")\n35         time.sleep(1)\n",
      "col_offset": 22,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_layer_map.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 34,
      "line_range": [
        34
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "40         cur.execute(\"SELECT count(*) from t\")\n41         assert cur.fetchone() == (n_iters * n_records,)\n42 \n",
      "col_offset": 8,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_layer_map.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 41,
      "line_range": [
        41
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "78             sum = endpoint.safe_psql(\"select sum(x) from t\")[0][0]\n79             assert sum == 1000000\n80 \n",
      "col_offset": 12,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_lazy_startup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 79,
      "line_range": [
        79
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "81         # Get metrics\n82         metrics = requests.get(f\"http://localhost:{endpoint.http_port}/metrics.json\").json()\n83         durations = {\n",
      "col_offset": 18,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_lazy_startup.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "52     sum_replica = vanilla_pg.safe_psql(\"select sum(abalance) from pgbench_accounts\")[0][0]\n53     assert sum_master == sum_replica\n54 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 53,
      "line_range": [
        53
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "290             is_super = cur.fetchall()[0][0]\n291             assert is_super, \"This benchmark won't work if we don't have superuser\"\n292 \n",
      "col_offset": 12,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 291,
      "line_range": [
        291
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "195     queries_dir = Path(__file__).parent / \"tpc-h\" / \"queries\"\n196     assert queries_dir.exists(), f\"TPC-H queries dir not found: {queries_dir}\"\n197 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_perf_olap.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 196,
      "line_range": [
        196
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4 import os\n5 import subprocess\n6 import time\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_physical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 5,
      "line_range": [
        5
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "124     finally:\n125         assert not error_occurred  # Fail the test if an error occurred\n126         neon_api.delete_project(project_id)\n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_physical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 125,
      "line_range": [
        125
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "266                     pgb = replica_pgbench[ireplica]\n267                     assert pgb is not None\n268                     pgb.terminate()\n",
      "col_offset": 20,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_physical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 267,
      "line_range": [
        267
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "296     finally:\n297         assert not error_occurred\n298         neon_api.delete_project(project_id)\n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_physical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 297,
      "line_range": [
        297
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "57                     high = rows_inserted + rows_to_insert\n58                     cur.execute(f\"INSERT INTO Big (pk) values (generate_series({low},{high}))\")\n59                     rows_inserted += rows_to_insert\n",
      "col_offset": 34,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_random_writes.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 58,
      "line_range": [
        58
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "83                     for _ in range(n_writes):\n84                         key = random.randint(1, n_rows)\n85                         cur.execute(f\"update Big set count=count+1 where pk={key}\")\n",
      "col_offset": 30,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_random_writes.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 84,
      "line_range": [
        84
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "84                         key = random.randint(1, n_rows)\n85                         cur.execute(f\"update Big set count=count+1 where pk={key}\")\n86                     env.flush()\n",
      "col_offset": 38,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_random_writes.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 85,
      "line_range": [
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "46             cur.execute(\"create table t (i integer);\")\n47             cur.execute(f\"insert into t values (generate_series(1,{rows}));\")\n48 \n",
      "col_offset": 26,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_seqscans.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "56             row = cur.fetchone()\n57             assert row is not None\n58             shared_buffers = row[0]\n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_seqscans.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "60             log.info(f\"shared_buffers is {shared_buffers}, table size {table_size}\")\n61             assert int(shared_buffers) < int(table_size)\n62             env.zenbenchmark.record(\"table_size\", table_size, \"bytes\", MetricReport.TEST_PARAM)\n",
      "col_offset": 12,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_seqscans.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 61,
      "line_range": [
        61
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "212             shards = tenant_get_shards(env, tenant_id)\n213             assert len(shards) == 8\n214 \n",
      "col_offset": 12,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_sharding_autosplit.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 213,
      "line_range": [
        213
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "58         # Get metrics\n59         metrics = requests.get(f\"http://localhost:{endpoint.http_port}/metrics.json\").json()\n60         durations = {\n",
      "col_offset": 18,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_startup.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 59,
      "line_range": [
        59
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "75         if i > 0:\n76             assert basebackup_bytes < 100 * 1024\n77 \n",
      "col_offset": 12,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_startup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "38 \n39     assert len(matching) == total_shards\n40 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 39,
      "line_range": [
        39
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "54     flake_factor = 5 / 100\n55     assert max_shard_count - min_shard_count <= int(total_shards * flake_factor)\n56 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 55,
      "line_range": [
        55
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "122     # chosen order in the sense that it's arbitrary, but not in the sense that it should change every run.\n123     rng = random.Random(1234)\n124 \n",
      "col_offset": 10,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 123,
      "line_range": [
        123
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "147     # For our sharded tenants, we will make half of them with timelines and half without\n148     assert large_tenant_count >= tenant_timelines_count / 2\n149     for tenant_id in tenants_with_timelines[0 : large_tenant_count // 2]:\n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 148,
      "line_range": [
        148
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "161         rss = env.storage_controller.get_metric_value(\"process_resident_memory_bytes\")\n162         assert rss is not None\n163         log.info(f\"Resident memory: {rss} ({ rss / total_shards} per shard)\")\n",
      "col_offset": 8,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 162,
      "line_range": [
        162
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "163         log.info(f\"Resident memory: {rss} ({ rss / total_shards} per shard)\")\n164         assert rss < expect_memory_per_shard * total_shards\n165 \n",
      "col_offset": 8,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 164,
      "line_range": [
        164
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "179     run_ops = api_concurrency * 4\n180     assert run_ops < len(tenants)\n181 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 180,
      "line_range": [
        180
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "266             detail = virtual_ps_http.timeline_detail(tenant_id, timeline_id)\n267             assert detail[\"timeline_id\"] == str(timeline_id)\n268 \n",
      "col_offset": 12,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 267,
      "line_range": [
        267
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "282                 op_timeline_id = tenants[tenant_id].timeline_id\n283                 assert op_timeline_id is not None\n284 \n",
      "col_offset": 16,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 283,
      "line_range": [
        283
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "345             log.info(f\"No-op call to reconcile_all took {runtime}s\")\n346             assert runtime < 1\n347             break\n",
      "col_offset": 12,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 346,
      "line_range": [
        346
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "357     readiness_period = env.storage_controller.wait_until_ready()\n358     assert readiness_period < 5\n359 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 358,
      "line_range": [
        358
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "397         # Assert that we've drained the node\n398         assert shard_counts[str(ps.id)] == 0\n399         # Assert that those shards actually went somewhere\n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 398,
      "line_range": [
        398
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "399         # Assert that those shards actually went somewhere\n400         assert sum(shard_counts.values()) == total_shards\n401 \n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_storage_controller_scale.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 400,
      "line_range": [
        400
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "34         fixture = request.getfixturevalue(\"vanilla_compare\")\n35         assert isinstance(fixture, VanillaCompare)\n36 \n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 35,
      "line_range": [
        35
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "38     else:\n39         assert (\n40             len(x) == 2\n41         ), f\"request param ({request.param}) should have a format of `neon_{{safekeepers_enable_fsync}}`\"\n42 \n",
      "col_offset": 8,
      "end_col_offset": 105,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 39,
      "line_range": [
        39,
        40,
        41
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44         neon_env_builder = request.getfixturevalue(\"neon_env_builder\")\n45         assert isinstance(neon_env_builder, NeonEnvBuilder)\n46 \n",
      "col_offset": 8,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "47         zenbenchmark = request.getfixturevalue(\"zenbenchmark\")\n48         assert isinstance(zenbenchmark, NeonBenchmarker)\n49 \n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 48,
      "line_range": [
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "50         pg_bin = request.getfixturevalue(\"pg_bin\")\n51         assert isinstance(pg_bin, PgBin)\n52 \n",
      "col_offset": 8,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 51,
      "line_range": [
        51
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "79                 cur.execute(\n80                     f\"INSERT INTO t{table_id} SELECT FROM generate_series(1,{new_rows_each_update})\"\n81                 )\n",
      "col_offset": 22,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 80,
      "line_range": [
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "106             )\n107             cur.execute(f\"INSERT INTO t{i} (key) VALUES (0)\")\n108 \n",
      "col_offset": 26,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 107,
      "line_range": [
        107
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "229             res = cur.fetchone()\n230             assert isinstance(res, tuple)\n231             lsn_write_lags.append(res[0])\n",
      "col_offset": 12,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_wal_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 230,
      "line_range": [
        230
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "32                         cur.execute(\n33                             f\"\"\"\n34                         CREATE TABLE tbl{i} AS\n35                             SELECT g as i, 'long string to consume some space' || g as t\n36                             FROM generate_series(1, 100000) g\n37                         \"\"\"\n38                         )\n",
      "col_offset": 32,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_write_amplification.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 33,
      "line_range": [
        33,
        34,
        35,
        36,
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "40                         for j in range(1, i):\n41                             cur.execute(f\"delete from tbl{j} where i = {i}\")\n42 \n",
      "col_offset": 42,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\performance\\test_write_amplification.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 41,
      "line_range": [
        41
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "54 \n55     assert str(output).strip() == \"1\"\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\pg_clients\\test_pg_clients.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 55,
      "line_range": [
        55
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "101 \n102     assert query_scalar(branch0_cur, \"SELECT count(*) FROM foo\") == 100000\n103 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ancestor_branch.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 102,
      "line_range": [
        102
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "103 \n104     assert query_scalar(branch1_cur, \"SELECT count(*) FROM foo\") == 200000\n105 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ancestor_branch.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 104,
      "line_range": [
        104
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "105 \n106     assert query_scalar(branch2_cur, \"SELECT count(*) FROM foo\") == 300000\n107 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ancestor_branch.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 106,
      "line_range": [
        106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "28     )\n29     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n30     return env\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 29,
      "line_range": [
        29
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "43     env = neon_env_builder.init_start()\n44     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n45 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 44,
      "line_range": [
        44
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "47     (tenant_id, _) = env.create_tenant()\n48     assert ps_http.tenant_config(tenant_id).tenant_specific_overrides == {}\n49     config_pre_detach = ps_http.tenant_config(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 48,
      "line_range": [
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "49     config_pre_detach = ps_http.tenant_config(tenant_id)\n50     assert tenant_id in [TenantId(t[\"id\"]) for t in ps_http.tenant_list()]\n51     ps_http.tenant_detach(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 50,
      "line_range": [
        50
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "51     ps_http.tenant_detach(tenant_id)\n52     assert tenant_id not in [TenantId(t[\"id\"]) for t in ps_http.tenant_list()]\n53 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 52,
      "line_range": [
        52
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55 \n56     assert tenant_id not in [\n57         TenantId(t[\"id\"]) for t in ps_http.tenant_list()\n58     ], \"tenant should not be attached after negative test\"\n59 \n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56,
        57,
        58
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "86     )\n87     assert res.status_code == 400\n88 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 87,
      "line_range": [
        87
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "103     )\n104     assert res.status_code == 400\n105 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 104,
      "line_range": [
        104
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "115     (tenant_id, _) = env.create_tenant()\n116     assert ps_http.tenant_config(tenant_id).tenant_specific_overrides == {}\n117     config_pre_detach = ps_http.tenant_config(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 116,
      "line_range": [
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "117     config_pre_detach = ps_http.tenant_config(tenant_id)\n118     assert tenant_id in [TenantId(t[\"id\"]) for t in ps_http.tenant_list()]\n119     ps_http.tenant_detach(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 118,
      "line_range": [
        118
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "119     ps_http.tenant_detach(tenant_id)\n120     assert tenant_id not in [TenantId(t[\"id\"]) for t in ps_http.tenant_list()]\n121 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 120,
      "line_range": [
        120
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "131 \n132     assert ps_http.tenant_config(tenant_id).tenant_specific_overrides == {}\n133     assert ps_http.tenant_config(tenant_id).effective_config == config_pre_detach.effective_config\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 132,
      "line_range": [
        132
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132     assert ps_http.tenant_config(tenant_id).tenant_specific_overrides == {}\n133     assert ps_http.tenant_config(tenant_id).effective_config == config_pre_detach.effective_config\n134 \n",
      "col_offset": 4,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "182     initial_tenant_config = ps_http.tenant_config(env.initial_tenant)\n183     assert initial_tenant_config.tenant_specific_overrides == {}\n184     assert set(initial_tenant_config.effective_config.keys()) == set(\n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 183,
      "line_range": [
        183
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "183     assert initial_tenant_config.tenant_specific_overrides == {}\n184     assert set(initial_tenant_config.effective_config.keys()) == set(\n185         fully_custom_config.keys()\n186     ), \"ensure we cover all config options\"\n187 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 184,
      "line_range": [
        184,
        185,
        186
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "190     our_tenant_config = ps_http.tenant_config(tenant_id)\n191     assert our_tenant_config.tenant_specific_overrides == fully_custom_config\n192     assert set(our_tenant_config.effective_config.keys()) == set(\n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 191,
      "line_range": [
        191
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "191     assert our_tenant_config.tenant_specific_overrides == fully_custom_config\n192     assert set(our_tenant_config.effective_config.keys()) == set(\n193         fully_custom_config.keys()\n194     ), \"ensure we cover all config options\"\n195     assert (\n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192,
        193,
        194
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "194     ), \"ensure we cover all config options\"\n195     assert (\n196         {\n197             k: initial_tenant_config.effective_config[k] != our_tenant_config.effective_config[k]\n198             for k in fully_custom_config.keys()\n199         }\n200         == {k: True for k in fully_custom_config.keys()}\n201     ), \"ensure our custom config has different values than the default config for all config options, so we know we overrode everything\"\n202 \n",
      "col_offset": 4,
      "end_col_offset": 136,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 195,
      "line_range": [
        195,
        196,
        197,
        198,
        199,
        200,
        201
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "205 \n206     assert ps_http.tenant_config(tenant_id).tenant_specific_overrides == fully_custom_config\n207     assert set(ps_http.tenant_config(tenant_id).effective_config.keys()) == set(\n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 206,
      "line_range": [
        206
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "206     assert ps_http.tenant_config(tenant_id).tenant_specific_overrides == fully_custom_config\n207     assert set(ps_http.tenant_config(tenant_id).effective_config.keys()) == set(\n208         fully_custom_config.keys()\n209     ), \"ensure we cover all config options\"\n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_attach_tenant_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 207,
      "line_range": [
        207,
        208,
        209
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "90             cur.execute(\"SELECT sum(key) FROM t\")\n91             assert cur.fetchone() == (5000050000,)\n92 \n",
      "col_offset": 12,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_auth.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 91,
      "line_range": [
        91
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "73                 if max_replication_write_lag_bytes > 0:\n74                     assert received_lsn_lag < max_replication_write_lag_bytes + lag_overflow\n75                 if max_replication_flush_lag_bytes > 0:\n",
      "col_offset": 20,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75                 if max_replication_flush_lag_bytes > 0:\n76                     assert disk_consistent_lsn_lag < max_replication_flush_lag_bytes + lag_overflow\n77                 if max_replication_apply_lag_bytes > 0:\n",
      "col_offset": 20,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77                 if max_replication_apply_lag_bytes > 0:\n78                     assert (\n79                         remote_consistent_lsn_lag < max_replication_apply_lag_bytes + lag_overflow\n80                     )\n81 \n",
      "col_offset": 20,
      "end_col_offset": 21,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_backpressure.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78,
        79,
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "61     row = cur.fetchone()\n62     assert row is not None\n63     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_bad_connection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "63     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n64     assert int(row[0]) < int(row[1])\n65 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_bad_connection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 64,
      "line_range": [
        64
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "66     execute_retry_on_timeout(\"SELECT count(*) FROM foo\")\n67     assert cur.fetchone() == (100000,)\n68 \n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_bad_connection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 67,
      "line_range": [
        67
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "71     while time.time() < end_time:\n72         if random.random() < 0.5:\n73             execute_retry_on_timeout(\"INSERT INTO foo VALUES ('stas'), ('heikki')\")\n",
      "col_offset": 11,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_bad_connection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "102 \n103     assert query_scalar(branch_cur, \"SELECT count(*) FROM foo\") == 200000\n104 \n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_and_gc.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 103,
      "line_range": [
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "92     hundred_cur = endpoint_hundred.connect().cursor()\n93     assert query_scalar(hundred_cur, \"SELECT count(*) FROM foo\") == 100\n94 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_behind.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "96     more_cur = endpoint_more.connect().cursor()\n97     assert query_scalar(more_cur, \"SELECT count(*) FROM foo\") == 200100\n98 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_behind.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 97,
      "line_range": [
        97
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "99     # All the rows are visible on the main branch\n100     assert query_scalar(main_cur, \"SELECT count(*) FROM foo\") == 400100\n101 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_behind.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 100,
      "line_range": [
        100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "111     endpoint = env.endpoints.create_start(\"test_branch_segment_boundary\")\n112     assert endpoint.safe_psql(\"SELECT 1\")[0][0] == 1\n113 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_behind.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 112,
      "line_range": [
        112
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "165     # check that after gc everything is still there\n166     assert query_scalar(hundred_cur, \"SELECT count(*) FROM foo\") == 100\n167 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_behind.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 166,
      "line_range": [
        166
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "167 \n168     assert query_scalar(more_cur, \"SELECT count(*) FROM foo\") == 200100\n169 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_behind.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 168,
      "line_range": [
        168
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "169 \n170     assert query_scalar(main_cur, \"SELECT count(*) FROM foo\") == 400100\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branch_behind.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 170,
      "line_range": [
        170
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "72         # random a delay between [0, 5]\n73         delay = random.random() * 5\n74         time.sleep(delay)\n",
      "col_offset": 16,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branching.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 73,
      "line_range": [
        73
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "103         res = ep.safe_psql(\"SELECT count(*) from pgbench_accounts\")\n104         assert res[0] == (100000 * scale,)\n105 \n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branching.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 104,
      "line_range": [
        104
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "304     # The one successfully created timeline should still be there.\n305     assert len(ps_http.timeline_list(tenant_id=env.initial_tenant)) == 1\n306 \n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branching.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 305,
      "line_range": [
        305
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "404         del repeat_result[\"remote_consistent_lsn_visible\"]\n405         assert repeat_result == success_result\n406     finally:\n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branching.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 405,
      "line_range": [
        405
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "418     # The one successfully created timeline should still be there.\n419     assert len(ps_http.timeline_list(tenant_id=env.initial_tenant)) == 1\n420 \n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branching.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 419,
      "line_range": [
        419
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "450             break\n451     assert found\n",
      "col_offset": 4,
      "end_col_offset": 16,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_branching.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 451,
      "line_range": [
        451
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "70     pg0.start()\n71     assert pg0.safe_psql(\"SELECT COUNT(*) FROM t\")[0][0] == 100\n72 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 71,
      "line_range": [
        71
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "125     new_tenant_timelines = env.neon_cli.timeline_list(tenant_id)\n126     assert (\n127         new_tenant_timelines == old_tenant_timelines\n128     ), f\"Pageserver after restart should ignore non-initialized timelines for tenant {tenant_id}\"\n129 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 126,
      "line_range": [
        126,
        127,
        128
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "130     timeline_dirs = [d for d in timelines_dir.iterdir()]\n131     assert (\n132         timeline_dirs == initial_timeline_dirs\n133     ), \"pageserver should clean its temp timeline files on timeline creation failure\"\n134 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 131,
      "line_range": [
        131,
        132,
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "178     new_tenant_timelines = env.neon_cli.timeline_list(tenant_id)\n179     assert (\n180         new_tenant_timelines == old_tenant_timelines\n181     ), f\"Pageserver after restart should ignore non-initialized timelines for tenant {tenant_id}\"\n182 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 179,
      "line_range": [
        179,
        180,
        181
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "183     timeline_dirs = [d for d in timelines_dir.iterdir()]\n184     assert (\n185         timeline_dirs == initial_timeline_dirs\n186     ), \"pageserver should clean its temp timeline files on timeline creation failure\"\n187 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 184,
      "line_range": [
        184,
        185,
        186
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "192 \n193     assert timeline_id == new_timeline_id\n194 \n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 193,
      "line_range": [
        193
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "213     new_tenant_timelines = env.neon_cli.timeline_list(tenant_id)\n214     assert (\n215         new_tenant_timelines == old_tenant_timelines\n216     ), f\"Pageserver after restart should ignore non-initialized timelines for tenant {tenant_id}\"\n217 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 214,
      "line_range": [
        214,
        215,
        216
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "218     timeline_dirs = [d for d in timelines_dir.iterdir()]\n219     assert (\n220         timeline_dirs == initial_timeline_dirs\n221     ), \"pageserver should clean its temp timeline files on timeline creation failure\"\n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_broken_timeline.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 219,
      "line_range": [
        219,
        220,
        221
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "19 \n20         assert \"revision\" in sample.labels\n21         assert len(sample.labels[\"revision\"]) > 0\n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_build_info_metric.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 20,
      "line_range": [
        20
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "20         assert \"revision\" in sample.labels\n21         assert len(sample.labels[\"revision\"]) > 0\n22 \n",
      "col_offset": 8,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_build_info_metric.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 21,
      "line_range": [
        21
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "22 \n23         assert \"build_tag\" in sample.labels\n24         assert len(sample.labels[\"build_tag\"]) > 0\n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_build_info_metric.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 23,
      "line_range": [
        23
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "23         assert \"build_tag\" in sample.labels\n24         assert len(sample.labels[\"build_tag\"]) > 0\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_build_info_metric.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 24,
      "line_range": [
        24
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "42     # Put this tenant into a dual-attached state\n43     assert env.get_tenant_pageserver(env.initial_tenant) == env.pageservers[0]\n44     alt_pageserver_id = env.pageservers[1].id\n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 43,
      "line_range": [
        43
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55         results = [cur.fetchone() for cur in curs]\n56         assert all(result == results[0] for result in results)\n57         return results[0]\n",
      "col_offset": 8,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "79     row = curs[0].fetchone()\n80     assert row is not None\n81     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 80,
      "line_range": [
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "81     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n82     assert int(row[0]) < int(row[1])\n83 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "84     execute(\"SELECT count(*) FROM foo\")\n85     assert fetchone() == (100000,)\n86 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 85,
      "line_range": [
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91     connstring = fetchone()\n92     assert connstring is not None\n93     expected_connstring = f\"postgresql://no_user:@localhost:{env.pageservers[1].service_port.pg}\"\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "93     expected_connstring = f\"postgresql://no_user:@localhost:{env.pageservers[1].service_port.pg}\"\n94     assert expected_connstring == expected_connstring\n95 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "101     execute(\"SELECT count(*) FROM foo\")\n102     assert fetchone() == (100000,)\n103 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 102,
      "line_range": [
        102
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "117     execute(\"SELECT count(*) FROM foo\")\n118     assert fetchone() == (100000,)\n119 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 118,
      "line_range": [
        118
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "144     asyncio.run(execute_and_reconfigure())\n145     assert fetchone() == (100000,)\n146 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 145,
      "line_range": [
        145
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "148     execute(\"SELECT count(*) FROM foo\")\n149     assert fetchone() == (100000,)\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_change_pageserver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 149,
      "line_range": [
        149
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "70     log.info(f\"pg_xact_0000_path_new = {pg_xact_0000_path_new}\")\n71     assert os.path.isfile(pg_xact_0000_path_new) is False\n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_clog_truncate.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 71,
      "line_range": [
        71
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4 import shutil\n5 import subprocess\n6 import threading\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_close_fds.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 5,
      "line_range": [
        5
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "40     while workload_thread.is_alive():\n41         res = subprocess.run(\n42             [lsof, path],\n43             check=False,\n44             text=True,\n45             capture_output=True,\n46         )\n47 \n",
      "col_offset": 14,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_close_fds.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 41,
      "line_range": [
        41,
        42,
        43,
        44,
        45,
        46
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "51             log.info(f\"lsof commands: {commands}\")\n52             assert commands == [\"pageserve\"]\n53 \n",
      "col_offset": 12,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_close_fds.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 52,
      "line_range": [
        52
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "25     cur.execute(\"insert into t values (2, 0)\")\n26     cur.execute(f\"insert into t select g, 0 from generate_series(3,{n_records}) g\")\n27 \n",
      "col_offset": 18,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 26,
      "line_range": [
        26
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "31     rows = cur.fetchall()\n32     assert len(rows) == 500\n33 \n",
      "col_offset": 4,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 32,
      "line_range": [
        32
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44     rows = cur.fetchall()\n45     assert len(rows) == 500\n46 \n",
      "col_offset": 4,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "82     file_path = f\"{endpoint.pg_data_dir_path()}/t.csv\"\n83     cur.execute(f\"insert into t select g, 0 from generate_series(1,{n_records}) g\")\n84     cur.execute(f\"copy t to '{file_path}'\")\n",
      "col_offset": 18,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 83,
      "line_range": [
        83
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "93     rows = cur.fetchall()\n94     assert len(rows) == 500\n95 \n",
      "col_offset": 4,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "106     rows = cur.fetchall()\n107     assert len(rows) == 500\n108 \n",
      "col_offset": 4,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 107,
      "line_range": [
        107
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "125     cur.execute(\"create table t(id integer, val integer)\")\n126     cur.execute(f\"insert into t values (generate_series(1,{n_records}), 0)\")\n127 \n",
      "col_offset": 18,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 126,
      "line_range": [
        126
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "130     cur.execute(\"update t set val=val+1\")\n131     assert cur.rowcount == n_records\n132     cur.execute(\"update t set val=val+1\")\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 131,
      "line_range": [
        131
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132     cur.execute(\"update t set val=val+1\")\n133     assert cur.rowcount == n_records\n134     cur.execute(\"update t set val=val+1\")\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "134     cur.execute(\"update t set val=val+1\")\n135     assert cur.rowcount == n_records\n136 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 135,
      "line_range": [
        135
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "137     cur.execute(\"delete from t\")\n138     assert cur.rowcount == n_records\n139     cur.execute(\"delete from t\")\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 138,
      "line_range": [
        138
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "139     cur.execute(\"delete from t\")\n140     assert cur.rowcount == 0\n141 \n",
      "col_offset": 4,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 140,
      "line_range": [
        140
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "141 \n142     cur.execute(f\"insert into t values (generate_series(1,{n_records}), 0)\")\n143     cur.execute(\"update t set val=val+1\")\n",
      "col_offset": 18,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 142,
      "line_range": [
        142
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "143     cur.execute(\"update t set val=val+1\")\n144     assert cur.rowcount == n_records\n145     cur.execute(\"update t set val=val+1\")\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 144,
      "line_range": [
        144
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "145     cur.execute(\"update t set val=val+1\")\n146     assert cur.rowcount == n_records\n147     cur.execute(\"update t set val=val+1\")\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 146,
      "line_range": [
        146
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "147     cur.execute(\"update t set val=val+1\")\n148     assert cur.rowcount == n_records\n149 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_combocid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 148,
      "line_range": [
        148
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "74         ps_http.timeline_compact(tenant_id, timeline_id, force_l0_compaction=True)\n75         assert ps_http.perf_info(tenant_id, timeline_id)[0][\"num_of_l0\"] <= 1\n76 \n",
      "col_offset": 8,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 75,
      "line_range": [
        75
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104     if vectored_count.value > 0:\n105         assert vectored_sum.value > 0\n106         vectored_average = vectored_sum.value / vectored_count.value\n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 105,
      "line_range": [
        105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "108         # special case: running local tests with default legacy configuration\n109         assert vectored_sum.value == 0\n110         vectored_average = 0\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 109,
      "line_range": [
        109
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "115     # was chosen empirically for this workload.\n116     assert non_vectored_average < 8\n117     assert vectored_average < 8\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 116,
      "line_range": [
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "116     assert non_vectored_average < 8\n117     assert vectored_average < 8\n118 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 117,
      "line_range": [
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "193                 # Pageserver should assert rather than emit an empty layer file, but double check here\n194                 assert layer.layer_file_size > 0\n195 \n",
      "col_offset": 16,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 194,
      "line_range": [
        194
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "207             log.info(f\"Shard {shard_id} average image layer size: {avg_size}\")\n208             assert avg_size > compaction_target_size / 2\n209 \n",
      "col_offset": 12,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 208,
      "line_range": [
        208
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "211         # Expect writes were scattered across all pageservers: they should all have compacted some image layers\n212         assert all(shard_has_image_layers)\n213     else:\n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 212,
      "line_range": [
        212
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "215         # that at least one of them has some image layers.\n216         assert any(shard_has_image_layers)\n217 \n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 216,
      "line_range": [
        216
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "312         env.pageserver.assert_log_contains(BROKEN_LOG)\n313         assert (\n314             env.pageserver.http_client().get_metric_value(\"pageserver_circuit_breaker_broken_total\")\n315             or 0\n316         ) == 1\n317         assert (\n",
      "col_offset": 8,
      "end_col_offset": 14,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 313,
      "line_range": [
        313,
        314,
        315,
        316
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "316         ) == 1\n317         assert (\n318             env.pageserver.http_client().get_metric_value(\n319                 \"pageserver_circuit_breaker_unbroken_total\"\n320             )\n321             or 0\n322         ) == 0\n323 \n",
      "col_offset": 8,
      "end_col_offset": 14,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 317,
      "line_range": [
        317,
        318,
        319,
        320,
        321,
        322
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "330 \n331     assert (\n332         env.pageserver.http_client().get_metric_value(\"pageserver_circuit_breaker_broken_total\")\n333         or 0\n334     ) == 1\n335     assert (\n",
      "col_offset": 4,
      "end_col_offset": 10,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 331,
      "line_range": [
        331,
        332,
        333,
        334
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "334     ) == 1\n335     assert (\n336         env.pageserver.http_client().get_metric_value(\"pageserver_circuit_breaker_unbroken_total\")\n337         or 0\n338     ) == 0\n339     assert not env.pageserver.log_contains(\".*Circuit breaker failure ended.*\")\n",
      "col_offset": 4,
      "end_col_offset": 10,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 335,
      "line_range": [
        335,
        336,
        337,
        338
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "338     ) == 0\n339     assert not env.pageserver.log_contains(\".*Circuit breaker failure ended.*\")\n340 \n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 339,
      "line_range": [
        339
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "378             endpoint.safe_psql(\n379                 f\"INSERT INTO foo (id, val) VALUES ({v}, repeat('abcde{v:0>3}', 500))\"\n380             )\n",
      "col_offset": 18,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 379,
      "line_range": [
        379
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "391             delta_layer_count += 1\n392     assert image_layer_count > 0\n393     assert delta_layer_count > 0\n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 392,
      "line_range": [
        392
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "392     assert image_layer_count > 0\n393     assert delta_layer_count > 0\n394 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 393,
      "line_range": [
        393
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "402     )\n403     assert bytes_in is not None\n404     assert bytes_out is not None\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 403,
      "line_range": [
        403
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "403     assert bytes_in is not None\n404     assert bytes_out is not None\n405     log.info(f\"Compression ratio: {bytes_out/bytes_in} ({bytes_out} in, {bytes_out} out)\")\n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 404,
      "line_range": [
        404
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "409         EXPECT_RATIO = 0.2\n410         assert bytes_out / bytes_in < EXPECT_RATIO\n411     else:\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 410,
      "line_range": [
        410
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "412         # Nothing should be compressed if we disabled it.\n413         assert bytes_out >= bytes_in\n414 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 413,
      "line_range": [
        413
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "420             res = endpoint.safe_psql(\n421                 f\"SELECT count(*) FROM foo WHERE id={v} and val=repeat('abcde{v:0>3}', 500)\"\n422             )\n",
      "col_offset": 18,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 421,
      "line_range": [
        421
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "422             )\n423             assert res[0][0] == 1\n",
      "col_offset": 12,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compaction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 423,
      "line_range": [
        423
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "5 import shutil\n6 import subprocess\n7 import tempfile\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 6,
      "line_range": [
        6
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "229 \n230     assert not breaking_changes_allowed, \"Breaking changes are allowed by ALLOW_BACKWARD_COMPATIBILITY_BREAKAGE, but the test has passed without any breakage\"\n231 \n",
      "col_offset": 4,
      "end_col_offset": 158,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 230,
      "line_range": [
        230
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "255         # This is because we want to test the compatibility of the data format, not the compatibility of the neon_local CLI.\n256         assert (\n257             neon_env_builder.compatibility_neon_binpath is not None\n258         ), \"the environment variable COMPATIBILITY_NEON_BIN is required\"\n259         assert (\n",
      "col_offset": 8,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 256,
      "line_range": [
        256,
        257,
        258
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "258         ), \"the environment variable COMPATIBILITY_NEON_BIN is required\"\n259         assert (\n260             neon_env_builder.compatibility_pg_distrib_dir is not None\n261         ), \"the environment variable COMPATIBILITY_POSTGRES_DISTRIB_DIR is required\"\n262         neon_env_builder.neon_binpath = neon_env_builder.compatibility_neon_binpath\n",
      "col_offset": 8,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 259,
      "line_range": [
        259,
        260,
        261
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "284         # does not include logs from previous runs\n285         assert not env.pageserver.log_contains(f\"git(-env)?:{prev_pageserver_version}\")\n286 \n",
      "col_offset": 8,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 285,
      "line_range": [
        285
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "289         # ensure the specified pageserver is running\n290         assert env.pageserver.log_contains(f\"git(-env)?:{prev_pageserver_version}\")\n291 \n",
      "col_offset": 8,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 290,
      "line_range": [
        290
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "306 \n307     assert not breaking_changes_allowed, \"Breaking changes are allowed by ALLOW_FORWARD_COMPATIBILITY_BREAKAGE, but the test has passed without any breakage\"\n308 \n",
      "col_offset": 4,
      "end_col_offset": 157,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 307,
      "line_range": [
        307
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "377 \n378     assert not dump_from_wal_differs, \"dump from WAL differs\"\n379     assert not initial_dump_differs, \"initial dump differs\"\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 378,
      "line_range": [
        378
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "378     assert not dump_from_wal_differs, \"dump from WAL differs\"\n379     assert not initial_dump_differs, \"initial dump differs\"\n380 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 379,
      "line_range": [
        379
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "403     with output.open(\"w\") as stdout:\n404         res = subprocess.run(\n405             [\n406                 \"diff\",\n407                 \"--unified\",  # Make diff output more readable\n408                 \"--ignore-matching-lines=^--\",  # Ignore changes in comments\n409                 \"--ignore-blank-lines\",\n410                 str(first),\n411                 str(second),\n412             ],\n413             stdout=stdout,\n414         )\n415 \n",
      "col_offset": 14,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 404,
      "line_range": [
        404,
        405,
        406,
        407,
        408,
        409,
        410,
        411,
        412,
        413,
        414
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "403     with output.open(\"w\") as stdout:\n404         res = subprocess.run(\n405             [\n406                 \"diff\",\n407                 \"--unified\",  # Make diff output more readable\n408                 \"--ignore-matching-lines=^--\",  # Ignore changes in comments\n409                 \"--ignore-blank-lines\",\n410                 str(first),\n411                 str(second),\n412             ],\n413             stdout=stdout,\n414         )\n415 \n",
      "col_offset": 14,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 404,
      "line_range": [
        404,
        405,
        406,
        407,
        408,
        409,
        410,
        411,
        412,
        413,
        414
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "424 \n425                 allowed = subprocess.run(\n426                     [\n427                         \"diff\",\n428                         \"--unified\",  # Make diff output more readable\n429                         r\"--ignore-matching-lines=^---\",  # Ignore diff headers\n430                         r\"--ignore-matching-lines=^\\+\\+\\+\",  # Ignore diff headers\n431                         \"--ignore-matching-lines=^@@\",  # Ignore diff blocks location\n432                         \"--ignore-matching-lines=^ *$\",  # Ignore lines with only spaces\n433                         \"--ignore-matching-lines=^ --.*\",  # Ignore SQL comments in diff\n434                         \"--ignore-blank-lines\",\n435                         str(output),\n436                         str(tmp.name),\n437                     ],\n438                 )\n439 \n",
      "col_offset": 26,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 425,
      "line_range": [
        425,
        426,
        427,
        428,
        429,
        430,
        431,
        432,
        433,
        434,
        435,
        436,
        437,
        438
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "424 \n425                 allowed = subprocess.run(\n426                     [\n427                         \"diff\",\n428                         \"--unified\",  # Make diff output more readable\n429                         r\"--ignore-matching-lines=^---\",  # Ignore diff headers\n430                         r\"--ignore-matching-lines=^\\+\\+\\+\",  # Ignore diff headers\n431                         \"--ignore-matching-lines=^@@\",  # Ignore diff blocks location\n432                         \"--ignore-matching-lines=^ *$\",  # Ignore lines with only spaces\n433                         \"--ignore-matching-lines=^ --.*\",  # Ignore SQL comments in diff\n434                         \"--ignore-blank-lines\",\n435                         str(output),\n436                         str(tmp.name),\n437                     ],\n438                 )\n439 \n",
      "col_offset": 26,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 425,
      "line_range": [
        425,
        426,
        427,
        428,
        429,
        430,
        431,
        432,
        433,
        434,
        435,
        436,
        437,
        438
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "498 \n499     with closing(requests.get(dataset.url, stream=True)) as r:\n500         unzstd = zstandard.ZstdDecompressor()\n",
      "col_offset": 17,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 499,
      "line_range": [
        499
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "502             with tarfile.open(mode=\"r|\", fileobj=stream) as tf:\n503                 tf.extractall(artifact_unpack_path)\n504 \n",
      "col_offset": 16,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 22,
        "link": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "tarfile.extractall used without any validation. Please check and discard dangerous members.",
      "line_number": 503,
      "line_range": [
        503
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b202_tarfile_unsafe_members.html",
      "test_id": "B202",
      "test_name": "tarfile_unsafe_members"
    },
    {
      "code": "508     env.start()\n509     assert isinstance(env.pageserver_remote_storage, S3Storage)\n510 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 509,
      "line_range": [
        509
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "534     healthy, metadata_summary = env.storage_scrubber.scan_metadata()\n535     assert healthy\n536     assert metadata_summary[\"tenant_count\"] >= 1\n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 535,
      "line_range": [
        535
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "535     assert healthy\n536     assert metadata_summary[\"tenant_count\"] >= 1\n537     assert metadata_summary[\"timeline_count\"] >= 1\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 536,
      "line_range": [
        536
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "536     assert metadata_summary[\"tenant_count\"] >= 1\n537     assert metadata_summary[\"timeline_count\"] >= 1\n538 \n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 537,
      "line_range": [
        537
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "543     # All our artifacts should contain at least one timeline\n544     assert len(timelines) > 0\n545 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 544,
      "line_range": [
        544
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "556     )\n557     assert not dump_differs(\n558         reference_sql_dump,\n559         test_output_dir / \"dump.sql\",\n560         test_output_dir / \"dump.filediff\",\n561     )\n562     ep.stop()\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compatibility.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 557,
      "line_range": [
        557,
        558,
        559,
        560,
        561
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "15     # Assert that 'cloud_admin' role exists in the 'roles' list\n16     assert any(\n17         role[\"name\"] == \"cloud_admin\" for role in objects[\"roles\"]\n18     ), \"The 'cloud_admin' role is missing\"\n19 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compute_catalog.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 16,
      "line_range": [
        16,
        17,
        18
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "20     # Assert that 'postgres' database exists in the 'databases' list\n21     assert any(\n22         db[\"name\"] == \"postgres\" for db in objects[\"databases\"]\n23     ), \"The 'postgres' database is missing\"\n24 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compute_catalog.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 21,
      "line_range": [
        21,
        22,
        23
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "26 \n27     assert \"-- PostgreSQL database dump\" in ddl\n28 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compute_catalog.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 27,
      "line_range": [
        27
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "32     except requests.exceptions.HTTPError as e:\n33         assert (\n34             e.response.status_code == 404\n35         ), f\"Expected 404 status code, but got {e.response.status_code}\"\n",
      "col_offset": 8,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_compute_catalog.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 33,
      "line_range": [
        33,
        34,
        35
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "31             # check that config change was applied\n32             assert cur.fetchone() == (\"debug1\",)\n33 \n",
      "col_offset": 12,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 32,
      "line_range": [
        32
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "51             res = cur.fetchone()\n52             assert res is not None, \"neon.safekeepers GUC is set\"\n53             old_sks = res[0]\n",
      "col_offset": 12,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 52,
      "line_range": [
        52
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "64             res = cur.fetchone()\n65             assert res is not None, \"neon.safekeepers GUC is set\"\n66             new_sks = res[0]\n",
      "col_offset": 12,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 65,
      "line_range": [
        65
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "67 \n68             assert new_sks != old_sks, \"GUC changes were applied\"\n69 \n",
      "col_offset": 12,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 68,
      "line_range": [
        68
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "73         # Check that walproposer was not restarted\n74         assert \"restarting walproposer\" not in logs\n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_config.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "42     )\n43     assert res[-1][0] == (5050,)\n44 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_crafted_wal_end.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 43,
      "line_range": [
        43
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "60     )\n61     assert res[0][0] == (5050,)\n62     assert res[-1][0] == (20100,)\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_crafted_wal_end.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 61,
      "line_range": [
        61
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "61     assert res[0][0] == (5050,)\n62     assert res[-1][0] == (20100,)\n63 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_crafted_wal_end.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77     )\n78     assert res[0][0] == (20100,)\n79     assert res[-1][0] == (45150,)\n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_crafted_wal_end.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "78     assert res[0][0] == (20100,)\n79     assert res[-1][0] == (45150,)\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_crafted_wal_end.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 79,
      "line_range": [
        79
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "53             res = cur.fetchone()\n54             assert res is not None\n55             # check that dbsize equals sum of all relation sizes, excluding shared ones\n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createdropdb.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 54,
      "line_range": [
        54
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "56             # This is how we define dbsize in neon for now\n57             assert res[0] == res[1]\n58 \n",
      "col_offset": 12,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createdropdb.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "95     # Test that database subdir exists on the branch before drop\n96     assert endpoint_before.pgdata_dir\n97     dbpath = pathlib.Path(endpoint_before.pgdata_dir) / \"base\" / str(dboid)\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createdropdb.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 96,
      "line_range": [
        96
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "99 \n100     assert os.path.isdir(dbpath) is True\n101 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createdropdb.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 100,
      "line_range": [
        100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "102     # Test that database subdir doesn't exist on the branch after drop\n103     assert endpoint_after.pgdata_dir\n104     dbpath = pathlib.Path(endpoint_after.pgdata_dir) / \"base\" / str(dboid)\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createdropdb.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 103,
      "line_range": [
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "106 \n107     assert os.path.isdir(dbpath) is False\n108 \n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createdropdb.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 107,
      "line_range": [
        107
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "26     # Test that you can connect to new branch as a new user\n27     assert endpoint2.safe_psql(\"select current_user\", user=\"testuser\") == [(\"testuser\",)]\n",
      "col_offset": 4,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_createuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 27,
      "line_range": [
        27
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "40             roles[operation[\"name\"]] = operation[\"password\"]\n41             assert \"encrypted_password\" in operation\n42     elif operation[\"op\"] == \"del\":\n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 41,
      "line_range": [
        41
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132     ddl.send_and_wait(\"CREATE DATABASE bork\")\n133     assert ddl.dbs == {\"bork\": curr_user}\n134     ddl.send_and_wait(\"CREATE ROLE volk WITH PASSWORD 'nu_zayats'\")\n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "135     ddl.send_and_wait(\"ALTER DATABASE bork RENAME TO nu_pogodi\")\n136     assert ddl.dbs == {\"nu_pogodi\": curr_user}\n137     ddl.send_and_wait(\"ALTER DATABASE nu_pogodi OWNER TO volk\")\n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 136,
      "line_range": [
        136
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "137     ddl.send_and_wait(\"ALTER DATABASE nu_pogodi OWNER TO volk\")\n138     assert ddl.dbs == {\"nu_pogodi\": \"volk\"}\n139     ddl.send_and_wait(\"DROP DATABASE nu_pogodi\")\n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 138,
      "line_range": [
        138
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "139     ddl.send_and_wait(\"DROP DATABASE nu_pogodi\")\n140     assert ddl.dbs == {}\n141     ddl.send_and_wait(\"DROP ROLE volk\")\n",
      "col_offset": 4,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 140,
      "line_range": [
        140
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "141     ddl.send_and_wait(\"DROP ROLE volk\")\n142     assert ddl.roles == {}\n143 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 142,
      "line_range": [
        142
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "144     ddl.send_and_wait(\"CREATE ROLE tarzan WITH PASSWORD 'of_the_apes'\")\n145     assert ddl.roles == {\"tarzan\": \"of_the_apes\"}\n146     ddl.send_and_wait(\"DROP ROLE tarzan\")\n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 145,
      "line_range": [
        145
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "146     ddl.send_and_wait(\"DROP ROLE tarzan\")\n147     assert ddl.roles == {}\n148     ddl.send_and_wait(\"CREATE ROLE tarzan WITH PASSWORD 'of_the_apes'\")\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 147,
      "line_range": [
        147
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "148     ddl.send_and_wait(\"CREATE ROLE tarzan WITH PASSWORD 'of_the_apes'\")\n149     assert ddl.roles == {\"tarzan\": \"of_the_apes\"}\n150     ddl.send_and_wait(\"ALTER ROLE tarzan WITH PASSWORD 'jungle_man'\")\n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 149,
      "line_range": [
        149
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "150     ddl.send_and_wait(\"ALTER ROLE tarzan WITH PASSWORD 'jungle_man'\")\n151     assert ddl.roles == {\"tarzan\": \"jungle_man\"}\n152     ddl.send_and_wait(\"ALTER ROLE tarzan RENAME TO mowgli\")\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 151,
      "line_range": [
        151
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "152     ddl.send_and_wait(\"ALTER ROLE tarzan RENAME TO mowgli\")\n153     assert ddl.roles == {\"mowgli\": \"jungle_man\"}\n154     ddl.send_and_wait(\"DROP ROLE mowgli\")\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 153,
      "line_range": [
        153
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "154     ddl.send_and_wait(\"DROP ROLE mowgli\")\n155     assert ddl.roles == {}\n156 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 155,
      "line_range": [
        155
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "163     ddl.wait()\n164     assert ddl.roles == {\"bork\": \"cork\"}\n165     cur.execute(\"BEGIN\")\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 164,
      "line_range": [
        164
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "168     ddl.wait()\n169     assert (\"stork\", \"pork\") not in ddl.roles.items()\n170     cur.execute(\"BEGIN\")\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 169,
      "line_range": [
        169
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "174     ddl.wait()\n175     assert ddl.roles == {\"stork\": \"pork\"}\n176     cur.execute(\"BEGIN\")\n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 175,
      "line_range": [
        175
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "186     ddl.wait()\n187     assert ddl.roles == {\"stork\": \"pork\", \"zork\": \"fork\"}\n188 \n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 187,
      "line_range": [
        187
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "191     ddl.wait()\n192     assert ddl.roles == {}\n193 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "200     ddl.wait()\n201     assert ddl.roles == {\"bork\": \"cork\"}\n202 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 201,
      "line_range": [
        201
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "204     ddl.wait()\n205     assert ddl.roles == {}\n206 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 205,
      "line_range": [
        205
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "210     ddl.wait()\n211     assert ddl.dbs == {\"stork\": \"cork\"}\n212 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 211,
      "line_range": [
        211
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "214     ddl.wait()\n215     assert ddl.dbs == {}\n216 \n",
      "col_offset": 4,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 215,
      "line_range": [
        215
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "228         ddl.wait()\n229     assert ddl.dbs == {\"failure\": \"cork\"}\n230     ddl.failures(False)\n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 229,
      "line_range": [
        229
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "238     # It should be invalid because cplane request failed\n239     assert result[0] == -2, \"Database 'failure' is not invalid\"\n240 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 239,
      "line_range": [
        239
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "243     ddl.wait()\n244     assert ddl.dbs == {}\n245 \n",
      "col_offset": 4,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 244,
      "line_range": [
        244
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "250         raise AssertionError(\"Could not count databases\")\n251     assert result[0] == 0, \"Database 'failure' still exists after drop\"\n252 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 251,
      "line_range": [
        251
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "258 \n259     with ddl.pg.cursor(user=\"superman\", password=\"jungle_man\") as superman_cur:\n260         # We allow real SUPERUSERs to ALTER neon_superuser\n",
      "col_offset": 9,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'jungle_man'",
      "line_number": 259,
      "line_range": [
        259
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "284             raise AssertionError(f\"Database '{db_name}' not found\")\n285         assert result[0] == connlimit, msg\n286 \n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 285,
      "line_range": [
        285
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "336             raise AssertionError(\"Could not count databases\")\n337         assert result[0] == 0, \"Database 'failure' still exists after restart\"\n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ddl_forwarding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 337,
      "line_range": [
        337
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44         config = ps_http.tenant_config(tenant_id)\n45         assert config.tenant_specific_overrides.get(\"min_resident_size_override\") == expect_override\n46         assert config.effective_config.get(\"min_resident_size_override\") == expect_effective\n",
      "col_offset": 8,
      "end_col_offset": 100,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "45         assert config.tenant_specific_overrides.get(\"min_resident_size_override\") == expect_override\n46         assert config.effective_config.get(\"min_resident_size_override\") == expect_effective\n47 \n",
      "col_offset": 8,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 46,
      "line_range": [
        46
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "151                 for table, column in tables_cols.items():\n152                     cur.execute(f\"select avg({column}) from {table}\")\n153                     _avg = cur.fetchone()\n",
      "col_offset": 34,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 152,
      "line_range": [
        152
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "219         timeline_dir = pageserver.timeline_dir(tenant_id, timeline_id)\n220         assert timeline_dir.exists()\n221         for file in timeline_dir.iterdir():\n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 220,
      "line_range": [
        220
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "316     tl_info = pageserver_http.timeline_detail(tenant_id, timeline_id)\n317     assert tl_info[\"last_record_lsn\"] == tl_info[\"disk_consistent_lsn\"]\n318     assert tl_info[\"disk_consistent_lsn\"] == tl_info[\"remote_consistent_lsn\"]\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 317,
      "line_range": [
        317
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "317     assert tl_info[\"last_record_lsn\"] == tl_info[\"disk_consistent_lsn\"]\n318     assert tl_info[\"disk_consistent_lsn\"] == tl_info[\"remote_consistent_lsn\"]\n319     pgbench_init_lsn = Lsn(tl_info[\"last_record_lsn\"])\n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 318,
      "line_range": [
        318
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "322     # log.info(f\"{layers}\")\n323     assert (\n324         len(layers.historic_layers) >= min_expected_layers\n325     ), \"evictions happen at layer granularity, but we often assert at byte-granularity\"\n326 \n",
      "col_offset": 4,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 323,
      "line_range": [
        323,
        324,
        325
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "386 \n387     assert broken_size_pre == broken_size_post, \"broken tenant should not be touched\"\n388     assert healthy_size_post < healthy_size_pre\n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 387,
      "line_range": [
        387
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "387     assert broken_size_pre == broken_size_post, \"broken tenant should not be touched\"\n388     assert healthy_size_post < healthy_size_pre\n389     assert healthy_size_post == 0\n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 388,
      "line_range": [
        388
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "388     assert healthy_size_post < healthy_size_pre\n389     assert healthy_size_post == 0\n390     env.neon_env.pageserver.allowed_errors.append(\".*\" + GLOBAL_LRU_LOG_LINE)\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 389,
      "line_range": [
        389
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "418 \n419     assert 0 <= actual_change, \"nothing can load layers during this test\"\n420     assert actual_change >= target, \"must evict more than half\"\n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 419,
      "line_range": [
        419
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "419     assert 0 <= actual_change, \"nothing can load layers during this test\"\n420     assert actual_change >= target, \"must evict more than half\"\n421     assert (\n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 420,
      "line_range": [
        420
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "420     assert actual_change >= target, \"must evict more than half\"\n421     assert (\n422         response[\"Finished\"][\"assumed\"][\"projected_after\"][\"freed_bytes\"] >= actual_change\n423     ), \"report accurately evicted bytes\"\n424     assert response[\"Finished\"][\"assumed\"][\"failed\"][\"count\"] == 0, \"zero failures expected\"\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 421,
      "line_range": [
        421,
        422,
        423
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "423     ), \"report accurately evicted bytes\"\n424     assert response[\"Finished\"][\"assumed\"][\"failed\"][\"count\"] == 0, \"zero failures expected\"\n425 \n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 424,
      "line_range": [
        424
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "443 \n444     assert len(du_by_timeline) == 2, \"this test assumes two tenants\"\n445     large_tenant = max(du_by_timeline, key=du_by_timeline.__getitem__)\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 444,
      "line_range": [
        444
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "446     small_tenant = min(du_by_timeline, key=du_by_timeline.__getitem__)\n447     assert du_by_timeline[large_tenant] > du_by_timeline[small_tenant]\n448     assert (\n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 447,
      "line_range": [
        447
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "447     assert du_by_timeline[large_tenant] > du_by_timeline[small_tenant]\n448     assert (\n449         du_by_timeline[large_tenant] - du_by_timeline[small_tenant] > 5 * env.layer_size\n450     ), \"ensure this test will do more than 1 eviction\"\n451 \n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 448,
      "line_range": [
        448,
        449,
        450
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "456     target = 1\n457     assert (\n458         du_by_timeline[large_tenant] > min_resident_size\n459     ), \"ensure the larger tenant will get a haircut\"\n460     ps_http.patch_tenant_config_client_side(\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 457,
      "line_range": [
        457,
        458,
        459
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "478     time.sleep(1)  # give log time to flush\n479     assert not env.neon_env.pageserver.log_contains(\n480         GLOBAL_LRU_LOG_LINE,\n481     ), \"this test is pointless if it fell back to global LRU\"\n482 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 479,
      "line_range": [
        479,
        480,
        481
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "487     actual_change = total_on_disk - later_total_on_disk\n488     assert 0 <= actual_change, \"nothing can load layers during this test\"\n489     assert actual_change >= target, \"eviction must always evict more than target\"\n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 488,
      "line_range": [
        488
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "488     assert 0 <= actual_change, \"nothing can load layers during this test\"\n489     assert actual_change >= target, \"eviction must always evict more than target\"\n490     assert (\n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 489,
      "line_range": [
        489
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "489     assert actual_change >= target, \"eviction must always evict more than target\"\n490     assert (\n491         response[\"Finished\"][\"assumed\"][\"projected_after\"][\"freed_bytes\"] >= actual_change\n492     ), \"report accurately evicted bytes\"\n493     assert response[\"Finished\"][\"assumed\"][\"failed\"][\"count\"] == 0, \"zero failures expected\"\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 490,
      "line_range": [
        490,
        491,
        492
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "492     ), \"report accurately evicted bytes\"\n493     assert response[\"Finished\"][\"assumed\"][\"failed\"][\"count\"] == 0, \"zero failures expected\"\n494 \n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 493,
      "line_range": [
        493
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "494 \n495     assert (\n496         later_du_by_timeline[small_tenant] == du_by_timeline[small_tenant]\n497     ), \"small tenant sees no haircut\"\n498     assert (\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 495,
      "line_range": [
        495,
        496,
        497
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "497     ), \"small tenant sees no haircut\"\n498     assert (\n499         later_du_by_timeline[large_tenant] < du_by_timeline[large_tenant]\n500     ), \"large tenant gets a haircut\"\n501     assert du_by_timeline[large_tenant] - later_du_by_timeline[large_tenant] >= target\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 498,
      "line_range": [
        498,
        499,
        500
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "500     ), \"large tenant gets a haircut\"\n501     assert du_by_timeline[large_tenant] - later_du_by_timeline[large_tenant] >= target\n502 \n",
      "col_offset": 4,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 501,
      "line_range": [
        501
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "525     actual_change = total_on_disk - later_total_on_disk\n526     assert 0 <= actual_change, \"nothing can load layers during this test\"\n527     assert actual_change >= target, \"eviction must always evict more than target\"\n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 526,
      "line_range": [
        526
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "526     assert 0 <= actual_change, \"nothing can load layers during this test\"\n527     assert actual_change >= target, \"eviction must always evict more than target\"\n528 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 527,
      "line_range": [
        527
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "573     actual_change = total_on_disk - later_total_on_disk\n574     assert 0 <= actual_change, \"nothing can load layers during this test\"\n575     assert actual_change >= target, \"eviction must always evict more than target\"\n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 574,
      "line_range": [
        574
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "574     assert 0 <= actual_change, \"nothing can load layers during this test\"\n575     assert actual_change >= target, \"eviction must always evict more than target\"\n576 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 575,
      "line_range": [
        575
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "578     for tenant, later_tenant_usage in later_du_by_timeline.items():\n579         assert (\n580             later_tenant_usage < du_by_timeline[tenant]\n581         ), \"all tenants should have lost some layers\"\n582 \n",
      "col_offset": 8,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 579,
      "line_range": [
        579,
        580,
        581
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "586     # matter.\n587     assert order in [EvictionOrder.RELATIVE_ORDER_EQUAL, EvictionOrder.RELATIVE_ORDER_SPARE]\n588     layers_now = env.count_layers_per_tenant(env.pageserver)\n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 587,
      "line_range": [
        587
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "598         abs_diff = abs(ratio - expected_ratio)\n599         assert original_count > count_now\n600 \n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 599,
      "line_range": [
        599
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "608         # for pg15 and pg16 the absdiff is < 0.01, for pg14 it is closer to 0.02\n609         assert abs_diff < expectation\n610 \n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 609,
      "line_range": [
        609
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "664 \n665     assert (\n666         len(ratios) == 4\n667     ), \"rest of the assertions expect 3 + 1 timelines, ratios, scales, all in order\"\n668     log.info(f\"{ratios}\")\n",
      "col_offset": 4,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 665,
      "line_range": [
        665,
        666,
        667
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "670     if order == EvictionOrder.RELATIVE_ORDER_EQUAL:\n671         assert all([x for x in ratios if x < 1.0]), \"all tenants lose layers\"\n672     elif order == EvictionOrder.RELATIVE_ORDER_SPARE:\n",
      "col_offset": 8,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 671,
      "line_range": [
        671
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "673         # with different layer sizes and pg versions, there are different combinations\n674         assert len([x for x in ratios if x < 1.0]) >= 2, \"require 2..4 tenants to lose layers\"\n675         assert ratios[3] < 1.0, \"largest tenant always loses layers\"\n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 674,
      "line_range": [
        674
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "674         assert len([x for x in ratios if x < 1.0]) >= 2, \"require 2..4 tenants to lose layers\"\n675         assert ratios[3] < 1.0, \"largest tenant always loses layers\"\n676     else:\n",
      "col_offset": 8,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 675,
      "line_range": [
        675
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "694         timeline_dir = pageserver.timeline_dir(tenant_id, timeline_id)\n695         assert timeline_dir.exists(), f\"timeline dir does not exist: {timeline_dir}\"\n696         total = 0\n",
      "col_offset": 8,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 695,
      "line_range": [
        695
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "713 \n714     assert smallest_layer is not None or total_on_disk == 0 and largest_layer == 0\n715     return (total_on_disk, largest_layer, smallest_layer or 0)\n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 714,
      "line_range": [
        714
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "775         post_eviction_total_size, _, _ = env.timelines_du(env.pageserver)\n776         assert post_eviction_total_size < 0.33 * total_size, \"we requested max 33% usage\"\n777 \n",
      "col_offset": 8,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 776,
      "line_range": [
        776
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "828         post_eviction_total_size, _, _ = env.timelines_du(env.pageserver)\n829         assert (\n830             total_size - post_eviction_total_size >= min_avail_bytes\n831         ), f\"we requested at least {min_avail_bytes} worth of free space\"\n832 \n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 829,
      "line_range": [
        829,
        830,
        831
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "877 \n878     assert (\n879         total_size - post_eviction_total_size >= evict_bytes\n880     ), \"we requested at least evict_bytes worth of free space\"\n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_disk_usage_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 878,
      "line_range": [
        878,
        879,
        880
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "126     except Exception as err:\n127         assert \"pgcrypto\" in str(err), f\"unexpected error creating anon extension {err}\"\n128 \n",
      "col_offset": 8,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_download_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 127,
      "line_range": [
        127
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55     log.debug(plan)\n56     assert \"Seq Scan on pgbench_accounts\" in plan\n57     assert \"Buffers: shared hit\" in plan\n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "56     assert \"Seq Scan on pgbench_accounts\" in plan\n57     assert \"Buffers: shared hit\" in plan\n58     assert \"File cache: hits=\" not in plan\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "57     assert \"Buffers: shared hit\" in plan\n58     assert \"File cache: hits=\" not in plan\n59     log.info(\"running explain analyze WITH LFC values to verify they do now show up\")\n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 58,
      "line_range": [
        58
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "65     log.debug(plan)\n66     assert \"Seq Scan on pgbench_accounts\" in plan\n67     assert \"Buffers: shared hit\" in plan\n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 66,
      "line_range": [
        66
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "66     assert \"Seq Scan on pgbench_accounts\" in plan\n67     assert \"Buffers: shared hit\" in plan\n68     assert \"File cache: hits=\" in plan\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 67,
      "line_range": [
        67
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "67     assert \"Buffers: shared hit\" in plan\n68     assert \"File cache: hits=\" in plan\n69     log.info(\"running explain analyze WITH LFC values to verify json output\")\n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 68,
      "line_range": [
        68
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "82     # Now you can assert the values\n83     assert file_cache_hits >= 5000, f\"Expected File Cache Hits to be > 5000, got {file_cache_hits}\"\n84     assert file_cache_misses == 0, f\"Expected File Cache Misses to be 0, got {file_cache_misses}\"\n",
      "col_offset": 4,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 83,
      "line_range": [
        83
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "83     assert file_cache_hits >= 5000, f\"Expected File Cache Hits to be > 5000, got {file_cache_hits}\"\n84     assert file_cache_misses == 0, f\"Expected File Cache Misses to be 0, got {file_cache_misses}\"\n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_explain_with_lfc_stats.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 84,
      "line_range": [
        84
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "24             res = cur.fetchone()\n25             assert res is not None\n26             version = res[0]\n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 25,
      "line_range": [
        25
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "32             res = cur.fetchone()\n33             assert not res, \"The 'neon_test_utils' extension is installed\"\n34 \n",
      "col_offset": 12,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 33,
      "line_range": [
        33
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "38     info(\"Extension install result: %s\", res)\n39     assert install_res[\"extension\"] == extension and install_res[\"version\"] == version\n40 \n",
      "col_offset": 4,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 39,
      "line_range": [
        39
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "46             res = cur.fetchone()\n47             assert res is not None\n48             (db_extension_name, db_extension_version) = res\n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "49 \n50     assert db_extension_name == extension and db_extension_version == version\n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 50,
      "line_range": [
        50
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "36         cur.execute(\n37             f\"\"\"CREATE TABLE tbl AS SELECT 'long string to consume some space' || g\n38                     from generate_series(1,{num_rows}) g\"\"\"\n39         )\n",
      "col_offset": 16,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_fullbackup.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 37,
      "line_range": [
        37,
        38
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "67         num_rows_found = vanilla_pg.safe_psql(\"select count(*) from tbl;\", user=\"cloud_admin\")[0][0]\n68         assert num_rows == num_rows_found\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_fullbackup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 68,
      "line_range": [
        68
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "53             updates_performed += 1\n54             id = random.randrange(1, NUM_ROWS)\n55             await pg_conn.fetchrow(f\"UPDATE foo SET counter = counter + 1 WHERE id = {id}\")\n",
      "col_offset": 17,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gc_aggressive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 54,
      "line_range": [
        54
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "54             id = random.randrange(1, NUM_ROWS)\n55             await pg_conn.fetchrow(f\"UPDATE foo SET counter = counter + 1 WHERE id = {id}\")\n56 \n",
      "col_offset": 37,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gc_aggressive.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 55,
      "line_range": [
        55
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "79         cur.execute(\n80             f\"\"\"\n81             INSERT INTO foo\n82                 SELECT g, 0, 'long string to consume some space' || g\n83                 FROM generate_series(1, {NUM_ROWS}) g\n84         \"\"\"\n85         )\n",
      "col_offset": 16,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gc_aggressive.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 80,
      "line_range": [
        80,
        81,
        82,
        83,
        84
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "91         r = cur.fetchone()\n92         assert r is not None\n93         assert r == (NUM_ROWS, UPDATES_TO_PERFORM)\n",
      "col_offset": 8,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gc_aggressive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "92         assert r is not None\n93         assert r == (NUM_ROWS, UPDATES_TO_PERFORM)\n94 \n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gc_aggressive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "139     before = get_num_remote_ops(\"index\", \"upload\")\n140     assert before > 0\n141 \n",
      "col_offset": 4,
      "end_col_offset": 21,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gc_aggressive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 140,
      "line_range": [
        140
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "160     log.info(f\"{after - before} new index uploads during test\")\n161     assert after - before < 5\n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_gc_aggressive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 161,
      "line_range": [
        161
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "56                         res = p_cur.fetchone()\n57                         assert res is not None\n58                         response = res\n",
      "col_offset": 24,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "71                     res = s_cur.fetchone()\n72                     assert res is not None\n73 \n",
      "col_offset": 20,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77                         response = secondary_cursor.fetchone()\n78                         assert response is not None\n79                         assert response == responses[query]\n",
      "col_offset": 24,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "78                         assert response is not None\n79                         assert response == responses[query]\n80 \n",
      "col_offset": 24,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 79,
      "line_range": [
        79
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "82             # reconnection fixes this.\n83             assert not secondary.log_contains(\n84                 \"incorrect resource manager data|record with incorrect|invalid magic number|unexpected pageaddr\"\n85             )\n86 \n",
      "col_offset": 12,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 83,
      "line_range": [
        83,
        84,
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "162             res = s_cur.fetchone()\n163             assert res is not None\n164 \n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 163,
      "line_range": [
        163
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "166             res = s_cur.fetchone()\n167             assert res[0] == 10000\n168 \n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 167,
      "line_range": [
        167
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "197             res = s_cur.fetchone()\n198             assert res[0] == 10000\n199 \n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 198,
      "line_range": [
        198
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "269                 log.info(f\"xmin is {slot_xmin}\")\n270                 assert int(slot_xmin) > 0\n271 \n",
      "col_offset": 16,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 270,
      "line_range": [
        270
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "286             log.info(f\"xmin is {slot_xmin}\")\n287             assert slot_xmin is None\n288 \n",
      "col_offset": 12,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 287,
      "line_range": [
        287
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "318             writecounter += 1\n319             await conn.execute(f\"UPDATE test SET counter = {writecounter}\")\n320         finished = True\n",
      "col_offset": 33,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 319,
      "line_range": [
        319
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "334             # assert(writecounter - readcounter < 1000)\n335             assert readcounter <= writecounter\n336             if reads % 100 == 0:\n",
      "col_offset": 12,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_hot_standby.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 335,
      "line_range": [
        335
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "35     )\n36     assert vanilla_pg.safe_psql(\"select count(*) from t\") == [(300000,)]\n37 \n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_import.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 36,
      "line_range": [
        36
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "139     endpoint = env.endpoints.create_start(branch_name, tenant_id=tenant)\n140     assert endpoint.safe_psql(\"select count(*) from t\") == [(300000,)]\n141 \n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_import.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 140,
      "line_range": [
        140
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "183     log.info(f\"timeline logical size = {logical_size / (1024 ** 2)}MB\")\n184     assert logical_size > 1024**3  # = 1GB\n185 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_import.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 184,
      "line_range": [
        184
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "195                 log.info(f\"Found a segment file: {f} in the backup archive file\")\n196     assert cnt_seg_files > 0\n197 \n",
      "col_offset": 4,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_import.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 196,
      "line_range": [
        196
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "208             cur.execute(\n209                 f\"\"\"CREATE TABLE tbl AS SELECT 'long string to consume some space' || g\n210                         from generate_series(1,{num_rows}) g\"\"\"\n211             )\n",
      "col_offset": 20,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_import.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 209,
      "line_range": [
        209,
        210
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "215             res = cur.fetchone()\n216             assert res is not None and isinstance(res[0], str)\n217             return Lsn(res[0])\n",
      "col_offset": 12,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_import.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 216,
      "line_range": [
        216
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "275     endpoint = env.endpoints.create_start(branch_name, tenant_id=tenant, lsn=lsn)\n276     assert endpoint.safe_psql(\"select count(*) from tbl\") == [(expected_num_rows,)]\n277 \n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_import.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 276,
      "line_range": [
        276
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "36 \n37     assert (\n38         minimum_initdb_size < minimum_good_layer_size\n39     ), \"keep checkpoint_distance higher than the initdb size (find it by experimenting)\"\n40 \n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 37,
      "line_range": [
        37,
        38,
        39
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "56         cur.execute(\n57             f\"create table int_array_test as select array_agg(g) as int_array from generate_series(1, {rows}) g group by g / 10;\"\n58         )\n",
      "col_offset": 14,
      "end_col_offset": 102,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "63         size = cur.fetchone()\n64         assert size is not None\n65         assert isinstance(size[0], int)\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 64,
      "line_range": [
        64
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "64         assert size is not None\n65         assert isinstance(size[0], int)\n66         log.info(f\"gin index size: {human_bytes(size[0])}\")\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 65,
      "line_range": [
        65
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "66         log.info(f\"gin index size: {human_bytes(size[0])}\")\n67         assert (\n68             size[0] > checkpoint_distance * 3\n69         ), f\"gin index is not large enough: {human_bytes(size[0])}\"\n70         wait_for_last_flush_lsn(env, ep, env.initial_tenant, env.initial_timeline)\n",
      "col_offset": 8,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 67,
      "line_range": [
        67,
        68,
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75     infos = ps_http.layer_map_info(env.initial_tenant, env.initial_timeline)\n76     assert len(infos.in_memory_layers) == 0, \"should had flushed open layers\"\n77     post_ingest = histogram_historic_layers(infos, buckets)\n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "94     infos = ps_http.layer_map_info(env.initial_tenant, env.initial_timeline)\n95     assert len(infos.in_memory_layers) == 0, \"no new inmem layers expected\"\n96     post_compact = histogram_historic_layers(infos, buckets)\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 95,
      "line_range": [
        95
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "100 \n101     assert (\n102         post_ingest.counts[3] == 0\n103     ), f\"there should be no layers larger than 2*checkpoint_distance ({human_bytes(2*checkpoint_distance)})\"\n104     assert post_ingest.counts[1] == 1, \"expect one smaller layer for initdb\"\n",
      "col_offset": 4,
      "end_col_offset": 108,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 101,
      "line_range": [
        101,
        102,
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "103     ), f\"there should be no layers larger than 2*checkpoint_distance ({human_bytes(2*checkpoint_distance)})\"\n104     assert post_ingest.counts[1] == 1, \"expect one smaller layer for initdb\"\n105     assert (\n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 104,
      "line_range": [
        104
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104     assert post_ingest.counts[1] == 1, \"expect one smaller layer for initdb\"\n105     assert (\n106         post_ingest.counts[0] <= 1\n107     ), \"expect at most one tiny layer from shutting down the endpoint\"\n108 \n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 105,
      "line_range": [
        105,
        106,
        107
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "109     # just make sure we don't have trouble splitting the layers apart\n110     assert post_compact.counts[3] == 0\n111 \n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 110,
      "line_range": [
        110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "134 def histogram(sizes: Iterable[int], minimum_sizes: list[Union[int, float]]) -> Histogram:\n135     assert all(minimum_sizes[i] < minimum_sizes[i + 1] for i in range(len(minimum_sizes) - 1))\n136     buckets = list(enumerate(minimum_sizes))\n",
      "col_offset": 4,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 135,
      "line_range": [
        135
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "147                 break\n148         assert found\n149 \n",
      "col_offset": 8,
      "end_col_offset": 20,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ingestion_layer_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 148,
      "line_range": [
        148
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "23     # 'plpgsql' is a default extension that is always installed.\n24     assert any(\n25         ext[\"extname\"] == \"plpgsql\" and ext[\"versions\"] == [\"1.0\"] for ext in res[\"extensions\"]\n26     ), \"The 'plpgsql' extension is missing\"\n27 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 24,
      "line_range": [
        24,
        25,
        26
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "28     # check that the neon_test_utils extension is not installed\n29     assert not any(\n30         ext[\"extname\"] == \"neon_test_utils\" for ext in res[\"extensions\"]\n31     ), \"The 'neon_test_utils' extension is installed\"\n32 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 29,
      "line_range": [
        29,
        30,
        31
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55     # and has the expected version\n56     assert any(\n57         ext[\"extname\"] == \"neon_test_utils\"\n58         and ext[\"versions\"] == [neon_test_utils_version]\n59         and ext[\"n_databases\"] == 1\n60         for ext in res[\"extensions\"]\n61     )\n62 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56,
        57,
        58,
        59,
        60,
        61
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "64     # this is a default extension that is always installed\n65     assert any(ext[\"extname\"] == \"plpgsql\" and ext[\"n_databases\"] == 4 for ext in res[\"extensions\"])\n66 \n",
      "col_offset": 4,
      "end_col_offset": 100,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 65,
      "line_range": [
        65
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "69         if ext[\"extname\"] == \"neon\":\n70             assert ext[\"n_databases\"] == 2\n71             ext[\"versions\"].sort()\n",
      "col_offset": 12,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 70,
      "line_range": [
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "71             ext[\"versions\"].sort()\n72             assert ext[\"versions\"] == [\"1.1\", \"1.2\"]\n73 \n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "84         if ext[\"extname\"] == \"neon\":\n85             assert ext[\"n_databases\"] == 2\n86             ext[\"versions\"].sort()\n",
      "col_offset": 12,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 85,
      "line_range": [
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "86             ext[\"versions\"].sort()\n87             assert ext[\"versions\"] == [\"1.2\", \"1.3\"]\n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_installed_extensions.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 87,
      "line_range": [
        87
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "49                     )\n50                 cur.execute(f\"insert into t_{i} values (generate_series(1,{partitions}))\")\n51                 cur.execute(\"vacuum full\")\n",
      "col_offset": 30,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_large_schema.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 50,
      "line_range": [
        50
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "71     for i in range(1, tables + 1):\n72         cur.execute(f\"SELECT count(*) FROM t_{i}\")\n73         assert cur.fetchone() == (partitions,)\n",
      "col_offset": 22,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_large_schema.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "72         cur.execute(f\"SELECT count(*) FROM t_{i}\")\n73         assert cur.fetchone() == (partitions,)\n74 \n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_large_schema.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 73,
      "line_range": [
        73
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "84             log.info(f\"layer {filename} size is {os.path.getsize(timeline_path + filename)}\")\n85             assert os.path.getsize(timeline_path + filename) < 512_000_000\n",
      "col_offset": 12,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_large_schema.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 85,
      "line_range": [
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "70             log.info(f\"layer {filename} size is {os.path.getsize(timeline_path + filename)}\")\n71             assert os.path.getsize(timeline_path + filename) < 512_000_000\n72 \n",
      "col_offset": 12,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_bloating.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 71,
      "line_range": [
        71
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "66     )\n67     assert (\n68         len(initial_local_layers) > 1\n69     ), f\"Should create multiple layers for timeline, but got {initial_local_layers}\"\n70 \n",
      "col_offset": 4,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 67,
      "line_range": [
        67,
        68,
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "72     initial_layer_map_info = client.layer_map_info(tenant_id=tenant_id, timeline_id=timeline_id)\n73     assert (\n74         not initial_layer_map_info.in_memory_layers\n75     ), \"Should have no in memory layers after flushing\"\n76     assert len(initial_local_layers) == len(\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 73,
      "line_range": [
        73,
        74,
        75
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75     ), \"Should have no in memory layers after flushing\"\n76     assert len(initial_local_layers) == len(\n77         initial_layer_map_info.historic_layers\n78     ), \"Should have the same layers in memory and on disk\"\n79 \n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76,
        77,
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "80     for returned_layer in initial_layer_map_info.historic_layers:\n81         assert (\n82             returned_layer.kind == \"Delta\"\n83         ), f\"Did not create and expect image layers, but got {returned_layer}\"\n84         assert (\n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 81,
      "line_range": [
        81,
        82,
        83
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "83         ), f\"Did not create and expect image layers, but got {returned_layer}\"\n84         assert (\n85             not returned_layer.remote\n86         ), f\"All created layers should be present locally, but got {returned_layer}\"\n87 \n",
      "col_offset": 8,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 84,
      "line_range": [
        84,
        85,
        86
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "88         returned_layer_name = parse_layer_file_name(returned_layer.layer_file_name)\n89         assert (\n90             returned_layer_name in initial_local_layers\n91         ), f\"Did not find returned layer {returned_layer_name} in local layers {list(initial_local_layers.keys())}\"\n92 \n",
      "col_offset": 8,
      "end_col_offset": 115,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 89,
      "line_range": [
        89,
        90,
        91
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "96         )\n97         assert (\n98             returned_layer.layer_file_size == local_layer_path.stat().st_size\n99         ), f\"Returned layer {returned_layer} has a different file size than local layer {local_layer_path}\"\n100 \n",
      "col_offset": 8,
      "end_col_offset": 107,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 97,
      "line_range": [
        97,
        98,
        99
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "105         )\n106         assert not env.pageserver.layer_exists(\n107             tenant_id, timeline_id, local_layer_name\n108         ), f\"Did not expect to find {local_layer_name} layer after evicting\"\n109 \n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 106,
      "line_range": [
        106,
        107,
        108
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "110     empty_layers = env.pageserver.list_layers(tenant_id, timeline_id)\n111     assert not empty_layers, f\"After evicting all layers, timeline {tenant_id}/{timeline_id} should have no layers locally, but got: {empty_layers}\"\n112 \n",
      "col_offset": 4,
      "end_col_offset": 148,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 111,
      "line_range": [
        111
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "113     evicted_layer_map_info = client.layer_map_info(tenant_id=tenant_id, timeline_id=timeline_id)\n114     assert (\n115         not evicted_layer_map_info.in_memory_layers\n116     ), \"Should have no in memory layers after flushing and evicting\"\n117     assert len(initial_local_layers) == len(\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 114,
      "line_range": [
        114,
        115,
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "116     ), \"Should have no in memory layers after flushing and evicting\"\n117     assert len(initial_local_layers) == len(\n118         evicted_layer_map_info.historic_layers\n119     ), \"Should have the same layers in memory and on disk initially\"\n120     for returned_layer in evicted_layer_map_info.historic_layers:\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 117,
      "line_range": [
        117,
        118,
        119
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "120     for returned_layer in evicted_layer_map_info.historic_layers:\n121         assert (\n122             returned_layer.kind == \"Delta\"\n123         ), f\"Did not create and expect image layers, but got {returned_layer}\"\n124         assert (\n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 121,
      "line_range": [
        121,
        122,
        123
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "123         ), f\"Did not create and expect image layers, but got {returned_layer}\"\n124         assert (\n125             returned_layer.remote\n126         ), f\"All layers should be evicted and not present locally, but got {returned_layer}\"\n127         returned_layer_name = parse_layer_file_name(returned_layer.layer_file_name)\n",
      "col_offset": 8,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 124,
      "line_range": [
        124,
        125,
        126
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "127         returned_layer_name = parse_layer_file_name(returned_layer.layer_file_name)\n128         assert (\n129             returned_layer_name in initial_local_layers\n130         ), f\"Did not find returned layer {returned_layer} in local layers {initial_local_layers}\"\n131 \n",
      "col_offset": 8,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 128,
      "line_range": [
        128,
        129,
        130
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "149     )\n150     assert (\n151         redownloaded_layers == initial_local_layers\n152     ), \"Should have the same layers locally after redownloading the evicted layers\"\n153     redownloaded_layer_map_info = client.layer_map_info(\n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 150,
      "line_range": [
        150,
        151,
        152
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "155     )\n156     assert (\n157         redownloaded_layer_map_info == initial_layer_map_info\n158     ), \"Should have the same layer map after redownloading the evicted layers\"\n159 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 156,
      "line_range": [
        156,
        157,
        158
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "253     log.info(\"by kind: %s\", by_kind)\n254     assert by_kind[\"Image\"] > 0\n255     assert by_kind[\"Delta\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 254,
      "line_range": [
        254
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "254     assert by_kind[\"Image\"] > 0\n255     assert by_kind[\"Delta\"] > 0\n256     assert by_kind[\"InMemory\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 255,
      "line_range": [
        255
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "255     assert by_kind[\"Delta\"] > 0\n256     assert by_kind[\"InMemory\"] == 0\n257     resident_layers = list(env.pageserver.timeline_dir(tenant_id, timeline_id).glob(\"*-*_*\"))\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 256,
      "line_range": [
        256
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "265         # we have disabled all background loops, so, this should hold\n266         assert len(resident_layers) == 0, \"ensure that all the layers are gone\"\n267 \n",
      "col_offset": 8,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 266,
      "line_range": [
        266
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "273         )\n274         assert (\n275             resident_physical_size_metric == 0\n276         ), \"ensure that resident_physical_size metric is zero\"\n277         assert resident_physical_size_metric == sum(\n",
      "col_offset": 8,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 274,
      "line_range": [
        274,
        275,
        276
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "276         ), \"ensure that resident_physical_size metric is zero\"\n277         assert resident_physical_size_metric == sum(\n278             layer.layer_file_size for layer in info.historic_layers if not layer.remote\n279         ), \"ensure that resident_physical_size metric corresponds to layer map dump\"\n280 \n",
      "col_offset": 8,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 277,
      "line_range": [
        277,
        278,
        279
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "283         )\n284         assert remote_physical_size_metric == sum(\n285             layer.layer_file_size for layer in info.historic_layers if layer.remote\n286         ), \"ensure that remote_physical_size metric corresponds to layer map dump\"\n287 \n",
      "col_offset": 8,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 284,
      "line_range": [
        284,
        285,
        286
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "297     time.sleep(1)\n298     assert not env.pageserver.log_contains(\"Nothing to GC\")\n299 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 298,
      "line_range": [
        298
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "305     post_gc_layers = set([layer.layer_file_name for layer in post_gc_info.historic_layers])\n306     assert post_gc_layers.issubset(pre_evict_layers)\n307     assert len(post_gc_layers) < len(pre_evict_layers)\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 306,
      "line_range": [
        306
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "306     assert post_gc_layers.issubset(pre_evict_layers)\n307     assert len(post_gc_layers) < len(pre_evict_layers)\n308 \n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 307,
      "line_range": [
        307
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "46 \n47     assert (\n48         len(new_temp_layer_files) == 0\n49     ), \"pageserver should clean its temporary new image layer files on failure\"\n50 \n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_writers_fail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 47,
      "line_range": [
        47,
        48,
        49
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "92 \n93     assert (\n94         len(new_temp_layer_files) == 0\n95     ), \"pageserver should clean its temporary new delta layer files on failure\"\n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layer_writers_fail.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93,
        94,
        95
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "65     def get_index_part():\n66         assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n67         ip_path = env.pageserver_remote_storage.index_path(tenant_id, timeline_id)\n",
      "col_offset": 8,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 66,
      "line_range": [
        66
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "78 \n79     assert len(get_future_layers()) == 0\n80 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 79,
      "line_range": [
        79
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "81     current = get_index_part()\n82     assert len(set(current.layer_metadata.keys())) == 1\n83     layer_file_name = list(current.layer_metadata.keys())[0]\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "83     layer_file_name = list(current.layer_metadata.keys())[0]\n84     assert isinstance(layer_file_name, DeltaLayerName)\n85     assert layer_file_name.is_l0(), f\"{layer_file_name}\"\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 84,
      "line_range": [
        84
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "84     assert isinstance(layer_file_name, DeltaLayerName)\n85     assert layer_file_name.is_l0(), f\"{layer_file_name}\"\n86 \n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 85,
      "line_range": [
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "94             cur.execute(\n95                 f\"\"\"\n96                 INSERT INTO foo\n97                 SELECT '{i}' || g\n98                 FROM generate_series(1, 10000) g\n99                 \"\"\"\n100             )\n",
      "col_offset": 20,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 95,
      "line_range": [
        95,
        96,
        97,
        98,
        99
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "106                 ps_http.timeline_checkpoint(tenant_id, timeline_id, force_repartition=True)\n107                 assert (\n108                     len(\n109                         [\n110                             layer\n111                             for layer in ps_http.layer_map_info(\n112                                 tenant_id, timeline_id\n113                             ).historic_layers\n114                             if layer.kind == \"Image\"\n115                         ]\n116                     )\n117                     == 0\n118                 )\n119     last_record_lsn = flush_ep_to_pageserver(env, endpoint, tenant_id, timeline_id)\n",
      "col_offset": 16,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 107,
      "line_range": [
        107,
        108,
        109,
        110,
        111,
        112,
        113,
        114,
        115,
        116,
        117,
        118
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "123     ip = get_index_part()\n124     assert len(ip.layer_metadata.keys())\n125     assert (\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 124,
      "line_range": [
        124
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "124     assert len(ip.layer_metadata.keys())\n125     assert (\n126         ip.disk_consistent_lsn < last_record_lsn\n127     ), \"sanity check for what above loop is supposed to do\"\n128 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 125,
      "line_range": [
        125,
        126,
        127
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132     )\n133     assert ps_http.tenant_config(tenant_id).effective_config[\"image_creation_threshold\"] == 1\n134     ps_http.timeline_compact(tenant_id, timeline_id, force_repartition=True)\n",
      "col_offset": 4,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "134     ps_http.timeline_compact(tenant_id, timeline_id, force_repartition=True)\n135     assert (\n136         len(\n137             [\n138                 layer\n139                 for layer in ps_http.layer_map_info(tenant_id, timeline_id).historic_layers\n140                 if layer.kind == \"Image\"\n141             ]\n142         )\n143         == 1\n144     )\n145     wait_for_upload_queue_empty(ps_http, tenant_id, timeline_id)\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 135,
      "line_range": [
        135,
        136,
        137,
        138,
        139,
        140,
        141,
        142,
        143,
        144
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "146     future_layers = get_future_layers()\n147     assert len(future_layers) == 1\n148     future_layer = future_layers[0]\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 147,
      "line_range": [
        147
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "148     future_layer = future_layers[0]\n149     assert isinstance(future_layer, ImageLayerName)\n150     assert future_layer.lsn == last_record_lsn\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 149,
      "line_range": [
        149
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "149     assert isinstance(future_layer, ImageLayerName)\n150     assert future_layer.lsn == last_record_lsn\n151     log.info(\n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 150,
      "line_range": [
        150
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "153     )\n154     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n155     future_layer_path = env.pageserver_remote_storage.remote_layer_path(\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 154,
      "line_range": [
        154
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "163         attachment = env.storage_controller.inspect(tenant_id)\n164         assert attachment is not None\n165         return attachment[0]\n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 164,
      "line_range": [
        164
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "180         future_layers = set(get_future_layers())\n181         assert future_layer not in future_layers\n182 \n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 181,
      "line_range": [
        181
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "197     log.info(f\"future layer path: {future_layer_path}\")\n198     assert future_layer_path.exists()\n199 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 198,
      "line_range": [
        198
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "216         post_stat = future_layer_path.stat()\n217         assert (\n218             pre_stat.st_mtime == post_stat.st_mtime\n219         ), \"observed PUT overtake the stucked DELETE => bug isn't fixed yet\"\n220         if time.monotonic() - start > max_race_opportunity_window:\n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 217,
      "line_range": [
        217,
        218,
        219
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "240         )\n241         assert layer_path.exists(), f\"{layer_file_name.to_str()}\"\n242 \n",
      "col_offset": 8,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 241,
      "line_range": [
        241
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "248     log.info(f\"future layer path: {future_layer_path}\")\n249     assert final_stat.st_mtime != pre_stat.st_mtime\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_layers_from_future.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 249,
      "line_range": [
        249
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "5 import re\n6 import subprocess\n7 import threading\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_resize.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 6,
      "line_range": [
        6
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "50     while thread.is_alive():\n51         size = random.randint(1, 512)\n52         cur.execute(f\"alter system set neon.file_cache_size_limit='{size}MB'\")\n",
      "col_offset": 15,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_resize.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 51,
      "line_range": [
        51
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "67         lfc_file_size = os.path.getsize(lfc_file_path)\n68         res = subprocess.run(\n69             [\"ls\", \"-sk\", lfc_file_path], check=True, text=True, capture_output=True\n70         )\n71         lfc_file_blocks = re.findall(\"([0-9A-F]+)\", res.stdout)[0]\n",
      "col_offset": 14,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_resize.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 68,
      "line_range": [
        68,
        69,
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "67         lfc_file_size = os.path.getsize(lfc_file_path)\n68         res = subprocess.run(\n69             [\"ls\", \"-sk\", lfc_file_path], check=True, text=True, capture_output=True\n70         )\n71         lfc_file_blocks = re.findall(\"([0-9A-F]+)\", res.stdout)[0]\n",
      "col_offset": 14,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_resize.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 68,
      "line_range": [
        68,
        69,
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "72         log.info(f\"Size of LFC file {lfc_file_size}, blocks {lfc_file_blocks}\")\n73         assert lfc_file_size <= 512 * 1024 * 1024\n74 \n",
      "col_offset": 8,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_resize.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 73,
      "line_range": [
        73
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "80 \n81     assert int(lfc_file_blocks) <= 128 * 1024\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_resize.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 81,
      "line_range": [
        81
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "65     log.info(f\"working set size after sequential scan on pgbench_accounts {blocks}\")\n66     assert pages * 0.8 < blocks < pages * 1.2\n67     # run a few point queries with index lookup\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_working_set_approximation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 66,
      "line_range": [
        66
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "74     log.info(f\"working set size after some index access of a few select pages only {blocks}\")\n75     assert blocks < 10\n76 \n",
      "col_offset": 4,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_working_set_approximation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 75,
      "line_range": [
        75
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "116 \n117     assert estimation_1k >= 20 and estimation_1k <= 40\n118     assert estimation_10k >= 200 and estimation_10k <= 400\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_working_set_approximation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 117,
      "line_range": [
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "117     assert estimation_1k >= 20 and estimation_1k <= 40\n118     assert estimation_10k >= 200 and estimation_10k <= 400\n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lfc_working_set_approximation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 118,
      "line_range": [
        118
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "36     cur.execute(\"CREATE TABLE lfctest (id int4 PRIMARY KEY, n int) WITH (fillfactor=10)\")\n37     cur.execute(f\"INSERT INTO lfctest SELECT g, 1 FROM generate_series(1, {n_rows}) g\")\n38 \n",
      "col_offset": 18,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_local_file_cache.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 37,
      "line_range": [
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "49         while not stop.is_set():\n50             id = random.randint(1, n_rows)\n51             cur.execute(f\"UPDATE lfctest SET n = n + 1 WHERE id = {id}\")\n",
      "col_offset": 17,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_local_file_cache.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 50,
      "line_range": [
        50
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "50             id = random.randint(1, n_rows)\n51             cur.execute(f\"UPDATE lfctest SET n = n + 1 WHERE id = {id}\")\n52             n_updates_performed += 1\n",
      "col_offset": 26,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_local_file_cache.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 51,
      "line_range": [
        51
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "81 \n82     assert query_scalar(cur, \"SELECT SUM(n) FROM lfctest\") == n_rows + n_updates_performed\n",
      "col_offset": 4,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_local_file_cache.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "50         log.info(\"libmetrics_tracing_event_count: %s\", val)\n51         assert val > (before or 0.0)\n52 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logging.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 51,
      "line_range": [
        51
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "22 def random_string(n: int):\n23     return \"\".join([choice(ascii_lowercase) for _ in range(n)])\n24 \n",
      "col_offset": 20,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 23,
      "line_range": [
        23
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "32         tenant_config = client.tenant_config(env.initial_tenant).effective_config\n33         assert pageserver_aux_file_policy == tenant_config[\"switch_aux_file_policy\"]\n34 \n",
      "col_offset": 8,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 33,
      "line_range": [
        33
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "70     logical_replication_sync(vanilla_pg, endpoint)\n71     assert vanilla_pg.safe_psql(\"select count(*) from t\")[0][0] == 1000\n72 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 71,
      "line_range": [
        71
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89     # Check that subscribers receives all data\n90     assert vanilla_pg.safe_psql(\"select count(*) from t\")[0][0] == 2000\n91 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "158     eq_q = \"select testcolumn1, testcolumn2, testcolumn3 from replication_example order by 1, 2, 3\"\n159     assert vanilla_pg.safe_psql(eq_q) == endpoint.safe_psql(eq_q)\n160     log.info(\"rewriteheap synced\")\n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 159,
      "line_range": [
        159
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "171     # it must be gone (but walproposer slot still exists, hence 1)\n172     assert endpoint.safe_psql(\"select count(*) from pg_replication_slots\")[0][0] == 1\n173 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 172,
      "line_range": [
        172
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "178     def slot_removed(ep):\n179         assert (\n180             endpoint.safe_psql(\n181                 \"select count(*) from pg_replication_slots where slot_name = 'stale_slot'\"\n182             )[0][0]\n183             == 0\n184         )\n185 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 179,
      "line_range": [
        179,
        180,
        181,
        182,
        183,
        184
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "198     cur.execute(\"select pg_create_logical_replication_slot('stale_slot', 'pgoutput');\")\n199     assert (\n200         endpoint.safe_psql(\n201             \"select count(*) from pg_replication_slots where slot_name = 'stale_slot'\"\n202         )[0][0]\n203         == 1\n204     )\n205 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 199,
      "line_range": [
        199,
        200,
        201,
        202,
        203,
        204
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "314         res = [r[0] for r in cur.fetchall()]\n315         assert res == [1, 2]\n316 \n",
      "col_offset": 8,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 315,
      "line_range": [
        315
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "323     # Make sure the 2 isn't replicated\n324     assert [r[0] for r in vanilla_pg.safe_psql(\"select * from t\")] == [1]\n325 \n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 324,
      "line_range": [
        324
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "331     logical_replication_sync(vanilla_pg, endpoint)\n332     assert [r[0] for r in vanilla_pg.safe_psql(\"select * from t\")] == [1, 2]\n333 \n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 332,
      "line_range": [
        332
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "337     logical_replication_sync(vanilla_pg, endpoint)\n338     assert [r[0] for r in vanilla_pg.safe_psql(\"select * from t\")] == [1, 2, 3]\n339 \n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 338,
      "line_range": [
        338
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "342         logs = log_file.read()\n343         assert \"could not receive data from WAL stream\" not in logs\n344 \n",
      "col_offset": 8,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 343,
      "line_range": [
        343
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "386     logical_replication_sync(vanilla_pg, endpoint)\n387     assert vanilla_pg.safe_psql(\n388         \"select sum(somedata) from replication_example\"\n389     ) == endpoint.safe_psql(\"select sum(somedata) from replication_example\")\n390 \n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 387,
      "line_range": [
        387,
        388,
        389
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "419     value = random_string(10_000_000)\n420     cur.execute(f\"INSERT INTO reptbl VALUES (1, '{value}')\")\n421     logical_replication_sync(vanilla_pg, endpoint)\n",
      "col_offset": 18,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 420,
      "line_range": [
        420
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "421     logical_replication_sync(vanilla_pg, endpoint)\n422     assert vanilla_pg.safe_psql(\"select id, largeval from reptbl\") == [(1, value)]\n423 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 422,
      "line_range": [
        422
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "425     cur.execute(\"DELETE FROM reptbl WHERE id = 1\")\n426     cur.execute(f\"INSERT INTO reptbl VALUES (2, '{value}')\")\n427     logical_replication_sync(vanilla_pg, endpoint)\n",
      "col_offset": 18,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 426,
      "line_range": [
        426
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "427     logical_replication_sync(vanilla_pg, endpoint)\n428     assert vanilla_pg.safe_psql(\"select id, largeval from reptbl\") == [(2, value)]\n429 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 428,
      "line_range": [
        428
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "430     value = random_string(10_000_000)\n431     cur.execute(f\"UPDATE reptbl SET largeval='{value}'\")\n432     logical_replication_sync(vanilla_pg, endpoint)\n",
      "col_offset": 18,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 431,
      "line_range": [
        431
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "432     logical_replication_sync(vanilla_pg, endpoint)\n433     assert vanilla_pg.safe_psql(\"select id, largeval from reptbl\") == [(2, value)]\n434 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 433,
      "line_range": [
        433
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "438     value = random_string(10_000_000)\n439     cur.execute(f\"UPDATE reptbl SET largeval='{value}'\")\n440     logical_replication_sync(vanilla_pg, endpoint)\n",
      "col_offset": 18,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 439,
      "line_range": [
        439
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "440     logical_replication_sync(vanilla_pg, endpoint)\n441     assert vanilla_pg.safe_psql(\"select id, largeval from reptbl\") == [(2, value)]\n442 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 441,
      "line_range": [
        441
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "505 \n506     with pub.cursor(dbname=\"neondb\", user=\"mr_whiskers\", password=\"cat\") as cur:\n507         cur.execute(\"CREATE PUBLICATION pub FOR ALL TABLES\")\n",
      "col_offset": 9,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'cat'",
      "line_number": 506,
      "line_range": [
        506
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "511         res = cur.fetchall()\n512         assert [r[0] for r in res] == [10, 20]\n513 \n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 512,
      "line_range": [
        512
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "513 \n514     with sub.cursor(dbname=\"neondb\", user=\"mr_whiskers\", password=\"cat\") as cur:\n515         cur.execute(\"CREATE TABLE t (a int)\")\n",
      "col_offset": 9,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'cat'",
      "line_number": 514,
      "line_range": [
        514
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "521 \n522         with pub.cursor(dbname=\"neondb\", user=\"mr_whiskers\", password=\"cat\") as pcur:\n523             pcur.execute(\"INSERT INTO t VALUES (30), (40)\")\n",
      "col_offset": 13,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'cat'",
      "line_number": 522,
      "line_range": [
        522
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "528             log.info(res)\n529             assert len(res) == 4\n530             assert [r[0] for r in res] == [10, 20, 30, 40]\n",
      "col_offset": 12,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 529,
      "line_range": [
        529
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "529             assert len(res) == 4\n530             assert [r[0] for r in res] == [10, 20, 30, 40]\n531 \n",
      "col_offset": 12,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 530,
      "line_range": [
        530
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "554         )\n555         assert flush_lsn >= publisher_flush_lsn\n556 \n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 555,
      "line_range": [
        555
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "612     vanilla_pg.safe_psql(\"checkpoint;\")\n613     assert sub.safe_psql_scalar(\"SELECT count(*) FROM t\") == 1000\n614 \n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 613,
      "line_range": [
        613
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "621     logical_replication_wait_flush_lsn_sync(vanilla_pg)\n622     assert sub.safe_psql_scalar(\"SELECT count(*) FROM t\") == 1000\n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_logical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 622,
      "line_range": [
        622
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "22     if with_lease:\n23         assert result.get(\"valid_until\")\n24     else:\n",
      "col_offset": 8,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 23,
      "line_range": [
        23
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "24     else:\n25         assert result.get(\"valid_until\") is None\n26 \n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 25,
      "line_range": [
        25
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "88         )\n89         assert result[\"kind\"] == \"future\"\n90         assert_lsn_lease_granted(result, with_lease)\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 89,
      "line_range": [
        89
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91         # make sure that we return a well advanced lsn here\n92         assert Lsn(result[\"lsn\"]) > start_lsn\n93 \n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "98         )\n99         assert result[\"kind\"] == \"past\"\n100         assert_lsn_lease_granted(result, with_lease)\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 99,
      "line_range": [
        99
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "102         # make sure that we return the minimum lsn here at the start of the range\n103         assert Lsn(result[\"lsn\"]) < start_lsn\n104 \n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 103,
      "line_range": [
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "110             )\n111             assert result[\"kind\"] not in [\"past\", \"nodata\"]\n112             assert_lsn_lease_granted(result, with_lease)\n",
      "col_offset": 12,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 111,
      "line_range": [
        111
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "122             )\n123             assert endpoint_here.safe_psql(\"SELECT max(x) FROM foo\")[0][0] == i\n124 \n",
      "col_offset": 12,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 123,
      "line_range": [
        123
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "136         )\n137         assert result[\"kind\"] == \"past\"\n138         assert_lsn_lease_granted(result, with_lease)\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 137,
      "line_range": [
        137
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "139         # make sure that we return the minimum lsn here at the start of the range\n140         assert Lsn(result[\"lsn\"]) >= last_flush_lsn\n141 \n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 140,
      "line_range": [
        140
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "244         except PageserverApiException as error:\n245             assert error.status_code == 500\n246             assert str(error) == \"Invalid LSN\"\n",
      "col_offset": 12,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 245,
      "line_range": [
        245
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "245             assert error.status_code == 500\n246             assert str(error) == \"Invalid LSN\"\n247             env.pageserver.allowed_errors.append(\".*Invalid LSN.*\")\n",
      "col_offset": 12,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 246,
      "line_range": [
        246
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "259         except PageserverApiException as error:\n260             assert error.status_code == 500\n261             assert re.match(key_not_found_error, str(error))\n",
      "col_offset": 12,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 260,
      "line_range": [
        260
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "260             assert error.status_code == 500\n261             assert re.match(key_not_found_error, str(error))\n262             env.pageserver.allowed_errors.append(key_not_found_error)\n",
      "col_offset": 12,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 261,
      "line_range": [
        261
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "280             )\n281             assert timestamp < after_timestamp, \"after_timestamp after timestamp\"\n282             if i > 1:\n",
      "col_offset": 12,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 281,
      "line_range": [
        281
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "283                 before_timestamp = tbl[i - step_size][1]\n284                 assert timestamp >= before_timestamp, \"before_timestamp before timestamp\"\n",
      "col_offset": 16,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_lsn_mapping.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 284,
      "line_range": [
        284
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "22         migration_id = cur.fetchall()\n23         assert migration_id[0][0] == num_migrations\n24 \n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_migrations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 23,
      "line_range": [
        23
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "32         migration_id = cur.fetchall()\n33         assert migration_id[0][0] == num_migrations\n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_migrations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 33,
      "line_range": [
        33
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "53         if i % update_every == 0:\n54             conn.cursor().execute(f\"update t1 set n_updated = n_updated + 1 where i = {i % 50}\")\n55         else:\n",
      "col_offset": 36,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_multixact.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 54,
      "line_range": [
        54
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "68     res = cur.fetchone()\n69     assert res is not None\n70     next_multixact_id = res[0]\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_multixact.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 69,
      "line_range": [
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "73     # Ensure that we did lock some tuples\n74     assert int(next_multixact_id) > int(next_multixact_id_old)\n75 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_multixact.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "84     # Check that we restored pg_controlfile correctly\n85     assert next_multixact_id_new == next_multixact_id\n86 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_multixact.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 85,
      "line_range": [
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3 import os\n4 import subprocess\n5 from pathlib import Path\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 4,
      "line_range": [
        4
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "37     cli_timeline_ids = sorted([timeline_id for (_, timeline_id) in timelines_cli])\n38     assert timelines_api == cli_timeline_ids\n39 \n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 38,
      "line_range": [
        38
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "62 \n63     assert main_timeline_id in timelines_cli\n64     assert nested_timeline_id in timelines_cli\n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 63,
      "line_range": [
        63
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "63     assert main_timeline_id in timelines_cli\n64     assert nested_timeline_id in timelines_cli\n65 \n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 64,
      "line_range": [
        64
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "73 \n74     assert tenants_api == tenants_cli\n75 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "97 \n98     assert env.initial_tenant in tenants\n99     assert tenant1 in tenants\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 98,
      "line_range": [
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "98     assert env.initial_tenant in tenants\n99     assert tenant1 in tenants\n100     assert tenant2 in tenants\n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 99,
      "line_range": [
        99
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "99     assert tenant1 in tenants\n100     assert tenant2 in tenants\n101 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 100,
      "line_range": [
        100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "108     # an initial timeline should be created upon tenant creation\n109     assert len(timelines) == 1\n110     assert timelines[0][0] == DEFAULT_BRANCH_NAME\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 109,
      "line_range": [
        109
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "109     assert len(timelines) == 1\n110     assert timelines[0][0] == DEFAULT_BRANCH_NAME\n111 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 110,
      "line_range": [
        110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "116     # Connect to sk port on v4 loopback\n117     res = requests.get(f\"http://127.0.0.1:{env.safekeepers[0].port.http}/v1/status\")\n118     assert res.ok\n",
      "col_offset": 10,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 117,
      "line_range": [
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "117     res = requests.get(f\"http://127.0.0.1:{env.safekeepers[0].port.http}/v1/status\")\n118     assert res.ok\n119 \n",
      "col_offset": 4,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 118,
      "line_range": [
        118
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "216     for example in positive:\n217         assert parse_project_git_version_output(example) == commit\n218 \n",
      "col_offset": 8,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 217,
      "line_range": [
        217
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "233 \n234     assert input in str(e)\n235 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 234,
      "line_range": [
        234
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "256     for bin in binaries:\n257         out = subprocess.check_output([neon_binpath / bin, \"--version\"]).decode(\"utf-8\")\n258         parse_project_git_version_output(out)\n",
      "col_offset": 14,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 257,
      "line_range": [
        257
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "28             # Ensure that the default version is also updated in the neon.control file\n29             assert cur.fetchone() == (\"1.5\",)\n30             cur.execute(\"SELECT * from neon.NEON_STAT_FILE_CACHE\")\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_extension.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 29,
      "line_range": [
        29
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "32             log.info(res)\n33             assert len(res) == 1\n34             assert len(res[0]) == 5\n",
      "col_offset": 12,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_extension.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 33,
      "line_range": [
        33
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "33             assert len(res) == 1\n34             assert len(res[0]) == 5\n35 \n",
      "col_offset": 12,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_extension.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 34,
      "line_range": [
        34
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "52             # Ensure that the default version is also updated in the neon.control file\n53             assert cur.fetchone() == (\"1.5\",)\n54             cur.execute(\"SELECT * from neon.NEON_STAT_FILE_CACHE\")\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_extension.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 53,
      "line_range": [
        53
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "87             cur.execute(\"SELECT extversion from pg_extension where extname='neon'\")\n88             assert cur.fetchone() == (\"1.0\",)  # Ensure the extension gets downgraded\n89 \n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_extension.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 88,
      "line_range": [
        88
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "97             cur.execute(\"SELECT extversion from pg_extension where extname='neon'\")\n98             assert cur.fetchone() != (\"1.0\",)  # Ensure the extension gets upgraded\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_extension.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 98,
      "line_range": [
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "87     with pytest.raises(RuntimeError):\n88         assert expected_message in env.neon_cli.endpoint_start(\"ep2\").stderr\n89 \n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_local_cli.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 88,
      "line_range": [
        88
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "42 \n43     with pub.cursor(dbname=\"neondb\", user=\"mr_whiskers\", password=\"cat\") as cur:\n44         cur.execute(\"SELECT pg_has_role('mr_whiskers', 'neon_superuser', 'member')\")\n",
      "col_offset": 9,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'cat'",
      "line_number": 43,
      "line_range": [
        43
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "44         cur.execute(\"SELECT pg_has_role('mr_whiskers', 'neon_superuser', 'member')\")\n45         assert cur.fetchall()[0][0]\n46         cur.execute(\"SELECT pg_has_role('mr_whiskers', 'neon_superuser', 'usage')\")\n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "46         cur.execute(\"SELECT pg_has_role('mr_whiskers', 'neon_superuser', 'usage')\")\n47         assert cur.fetchall()[0][0]\n48 \n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "50             cur.execute(\"SELECT pg_has_role('mr_whiskers', 'neon_superuser', 'set')\")\n51             assert cur.fetchall()[0][0]\n52 \n",
      "col_offset": 12,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 51,
      "line_range": [
        51
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "59         res = cur.fetchall()\n60         assert [r[0] for r in res] == [10, 20]\n61 \n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 60,
      "line_range": [
        60
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "61 \n62     with sub.cursor(dbname=\"neondb\", user=\"mr_whiskers\", password=\"cat\") as cur:\n63         cur.execute(\"CREATE TABLE t (a int)\")\n",
      "col_offset": 9,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'cat'",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "69 \n70         with pub.cursor(dbname=\"neondb\", user=\"mr_whiskers\", password=\"cat\") as pcur:\n71             pcur.execute(\"INSERT INTO t VALUES (30), (40)\")\n",
      "col_offset": 13,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'cat'",
      "line_number": 70,
      "line_range": [
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "76             log.info(res)\n77             assert len(res) == 4\n78             assert [r[0] for r in res] == [10, 20, 30, 40]\n",
      "col_offset": 12,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 77,
      "line_range": [
        77
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77             assert len(res) == 4\n78             assert [r[0] for r in res] == [10, 20, 30, 40]\n79 \n",
      "col_offset": 12,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "83         cur.execute(\"SELECT query from pg_stat_activity LIMIT 1\")\n84         assert cur.fetchall()[0][0] != \"<insufficient privilege>\"\n85         # Test that pg_monitor is not working for non neon_superuser role without grant\n",
      "col_offset": 8,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 84,
      "line_range": [
        84
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89         cur.execute(\"SELECT query from pg_stat_activity LIMIT 1\")\n90         assert cur.fetchall()[0][0] == \"<insufficient privilege>\"\n91         cur.execute(\"RESET ROLE\")\n",
      "col_offset": 8,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "95         cur.execute(\"SELECT query from pg_stat_activity LIMIT 1\")\n96         assert cur.fetchall()[0][0] != \"<insufficient privilege>\"\n97         cur.execute(\"RESET ROLE\")\n",
      "col_offset": 8,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_neon_superuser.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 96,
      "line_range": [
        96
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "65     cur.execute(\"SELECT count(*) FROM t\")\n66     assert cur.fetchone() == (iterations,)\n67 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 66,
      "line_range": [
        66
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "94     )\n95     assert vanilla_pg.safe_psql(\"select count(*) from tt\") == [(300000,)]\n96     vanilla_pg.safe_psql(\"CREATE TABLE t (t text);\")\n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 95,
      "line_range": [
        95
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "124     )\n125     assert endpoint.safe_psql(\"select count(*) from t\") == [(1,)]\n126 \n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 125,
      "line_range": [
        125
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "186     cur.execute(\"SELECT count(*) from t\")\n187     assert cur.fetchone() == (10000 + 1 + 1,)\n188 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 187,
      "line_range": [
        187
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "232             rec = cur.fetchone()\n233             assert rec is not None\n234             (ckpt_oldest_multi_xid, ckpt_next_multi_xid) = rec\n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 233,
      "line_range": [
        233
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "360     cur = conn.cursor()\n361     assert query_scalar(cur, \"select count(*) from tt\") == 10  # sanity check\n362 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 361,
      "line_range": [
        361
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "418         # to around 100000 and above.)\n419         assert row_xmax < 100\n420 \n",
      "col_offset": 8,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 419,
      "line_range": [
        419
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "433     # We should have observed the state before wraparound\n434     assert observed_before_wraparound\n435 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 434,
      "line_range": [
        434
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "452     log.info(f\"next_multixact_id after restart: {next_multixact_id_after_restart}\")\n453     assert next_multixact_id_after_restart >= next_multixact_id_before_restart\n454 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 453,
      "line_range": [
        453
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "460     log.info(f\"next_multi_offset after restart: {next_multi_offset_after_restart}\")\n461     assert next_multi_offset_after_restart < 100000\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_next_xid.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 461,
      "line_range": [
        461
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "20 \n21     assert res_1[-1][0] == (5000050000,)\n22     # TODO check detach on live instance\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_normal_work.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 21,
      "line_range": [
        21
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "28     res_2 = endpoint.safe_psql(\"SELECT sum(key) FROM t\")\n29     assert res_2[0] == (5000050000,)\n30 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_normal_work.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 29,
      "line_range": [
        29
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "22     cur.execute(\"SELECT x from t1\")\n23     assert cur.fetchone() == (1,)\n24     cur.execute(\"SELECT x from t2\")\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_oid_overflow.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 23,
      "line_range": [
        23
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "24     cur.execute(\"SELECT x from t2\")\n25     assert cur.fetchone() == (2,)\n26 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_oid_overflow.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 25,
      "line_range": [
        25
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44     cur.execute(\"SELECT x from t1\")\n45     assert cur.fetchone() == (1,)\n46     cur.execute(\"SELECT x from t2\")\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_oid_overflow.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "46     cur.execute(\"SELECT x from t2\")\n47     assert cur.fetchone() == (2,)\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_oid_overflow.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "52     row = cur.fetchone()\n53     assert row is not None\n54     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_old_request_lsn.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 53,
      "line_range": [
        53
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "54     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n55     assert int(row[0]) < int(row[1])\n56 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_old_request_lsn.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 55,
      "line_range": [
        55
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "72     cur.execute(\"SELECT COUNT(*), SUM(val) FROM foo\")\n73     assert cur.fetchone() == (100000, 101000)\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_old_request_lsn.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 73,
      "line_range": [
        73
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "87         cur.execute(\n88             f\"\"\"CREATE TABLE tbl AS SELECT g as id, 'long string to consume some space' || g\n89         from generate_series(1,{num_rows}) g\"\"\"\n90         )\n",
      "col_offset": 16,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 88,
      "line_range": [
        88,
        89
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "130     before_downloads = get_num_downloaded_layers(client)\n131     assert before_downloads != 0, \"basebackup should on-demand non-zero layers\"\n132 \n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 131,
      "line_range": [
        131
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "138     with endpoint.cursor() as cur:\n139         assert query_scalar(cur, \"select count(*) from tbl where id = 500000\") == 1\n140 \n",
      "col_offset": 8,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 139,
      "line_range": [
        139
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "142     log.info(f\"layers downloaded before {before_downloads} and after {after_downloads}\")\n143     assert after_downloads > before_downloads\n144 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 143,
      "line_range": [
        143
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "185         cur.execute(\n186             f\"\"\"\n187         CREATE TABLE testtab(id serial primary key, checkpoint_number int, data text);\n188         INSERT INTO testtab (checkpoint_number, data) SELECT 0, 'data' FROM generate_series(1, {table_len});\n189         \"\"\"\n190         )\n",
      "col_offset": 16,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 186,
      "line_range": [
        186,
        187,
        188,
        189
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "199         with endpoint.cursor() as cur:\n200             cur.execute(f\"UPDATE testtab SET checkpoint_number = {checkpoint_number}\")\n201             current_lsn = Lsn(query_scalar(cur, \"SELECT pg_current_wal_flush_lsn()\"))\n",
      "col_offset": 26,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 200,
      "line_range": [
        200
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "245     log.info(filled_size)\n246     assert filled_current_physical == filled_size, \"we don't yet do layer eviction\"\n247 \n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 246,
      "line_range": [
        246
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "264     # current_physical_size because they are loaded as `RemoteLayer`s.\n265     assert filled_current_physical == get_api_current_physical_size()\n266 \n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 265,
      "line_range": [
        265
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "275             # assert query_scalar(cur, f\"select count(*) from testtab where checkpoint_number={checkpoint_number}\") == 100000\n276             assert (\n277                 query_scalar(\n278                     cur,\n279                     f\"select count(*) from testtab where checkpoint_number<>{checkpoint_number}\",\n280                 )\n281                 == 0\n282             )\n283             assert (\n",
      "col_offset": 12,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 276,
      "line_range": [
        276,
        277,
        278,
        279,
        280,
        281,
        282
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "278                     cur,\n279                     f\"select count(*) from testtab where checkpoint_number<>{checkpoint_number}\",\n280                 )\n",
      "col_offset": 22,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 279,
      "line_range": [
        279
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "282             )\n283             assert (\n284                 query_scalar(\n285                     cur,\n286                     f\"select count(*) from testtab where checkpoint_number={checkpoint_number}\",\n287                 )\n288                 == table_len\n289             )\n290 \n",
      "col_offset": 12,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 283,
      "line_range": [
        283,
        284,
        285,
        286,
        287,
        288,
        289
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "285                     cur,\n286                     f\"select count(*) from testtab where checkpoint_number={checkpoint_number}\",\n287                 )\n",
      "col_offset": 22,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 286,
      "line_range": [
        286
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "303         if len(num_layers_downloaded) > 4:\n304             assert after_downloads > num_layers_downloaded[len(num_layers_downloaded) - 4]\n305 \n",
      "col_offset": 12,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 304,
      "line_range": [
        304
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "309         if len(resident_size) > 4:\n310             assert resident_size[-1] > resident_size[len(resident_size) - 4]\n311 \n",
      "col_offset": 12,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 310,
      "line_range": [
        310
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "314         # It should not change.\n315         assert filled_current_physical == get_api_current_physical_size()\n316         endpoint_old.stop()\n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 315,
      "line_range": [
        315
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "363         cur.execute(\n364             f\"\"\"\n365         CREATE TABLE testtab(id serial primary key, checkpoint_number int, data text);\n366         INSERT INTO testtab (checkpoint_number, data) SELECT 0, 'data' FROM generate_series(1, {table_len});\n367         \"\"\"\n368         )\n",
      "col_offset": 16,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 364,
      "line_range": [
        364,
        365,
        366,
        367
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "397     log.info(f\"filled_size: {filled_size}\")\n398     assert filled_current_physical == filled_size, \"we don't yet do layer eviction\"\n399 \n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 398,
      "line_range": [
        398
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "420     this_time = get_api_current_physical_size()\n421     assert (\n422         filled_current_physical == this_time\n423     ), \"current_physical_size is sum of loaded layer sizes, independent of whether local or remote\"\n424 \n",
      "col_offset": 4,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 421,
      "line_range": [
        421,
        422,
        423
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "426     log.info(f\"post_unlink_size: {post_unlink_size}\")\n427     assert (\n428         post_unlink_size < filled_size\n429     ), \"we just deleted layers and didn't cause anything to re-download them yet\"\n430 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 427,
      "line_range": [
        427,
        428,
        429
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "439     log.info(f\"info={info}\")\n440     assert info[\"state\"] == \"Completed\"\n441     assert info[\"total_layer_count\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 440,
      "line_range": [
        440
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "440     assert info[\"state\"] == \"Completed\"\n441     assert info[\"total_layer_count\"] > 0\n442     assert info[\"successful_download_count\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 441,
      "line_range": [
        441
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "441     assert info[\"total_layer_count\"] > 0\n442     assert info[\"successful_download_count\"] == 0\n443     # can't assert == total_layer_count because timeline_detail also tries to\n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 442,
      "line_range": [
        442
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "444     # download layers for logical size, but this might not always hold.\n445     assert info[\"failed_download_count\"] > 0\n446     assert (\n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 445,
      "line_range": [
        445
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "445     assert info[\"failed_download_count\"] > 0\n446     assert (\n447         info[\"total_layer_count\"]\n448         == info[\"successful_download_count\"] + info[\"failed_download_count\"]\n449     )\n450     assert get_api_current_physical_size() == filled_current_physical\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 446,
      "line_range": [
        446,
        447,
        448,
        449
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "449     )\n450     assert get_api_current_physical_size() == filled_current_physical\n451     assert (\n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 450,
      "line_range": [
        450
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "450     assert get_api_current_physical_size() == filled_current_physical\n451     assert (\n452         get_resident_physical_size() == post_unlink_size\n453     ), \"didn't download anything new due to failpoint\"\n454 \n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 451,
      "line_range": [
        451,
        452,
        453
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "465 \n466     assert info[\"state\"] == \"Completed\"\n467     assert info[\"total_layer_count\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 466,
      "line_range": [
        466
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "466     assert info[\"state\"] == \"Completed\"\n467     assert info[\"total_layer_count\"] > 0\n468     assert info[\"successful_download_count\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 467,
      "line_range": [
        467
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "467     assert info[\"total_layer_count\"] > 0\n468     assert info[\"successful_download_count\"] > 0\n469     assert info[\"failed_download_count\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 468,
      "line_range": [
        468
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "468     assert info[\"successful_download_count\"] > 0\n469     assert info[\"failed_download_count\"] == 0\n470     assert (\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 469,
      "line_range": [
        469
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "469     assert info[\"failed_download_count\"] == 0\n470     assert (\n471         info[\"total_layer_count\"]\n472         == info[\"successful_download_count\"] + info[\"failed_download_count\"]\n473     )\n474 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 470,
      "line_range": [
        470,
        471,
        472,
        473
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "477 \n478     assert filled_size == refilled_size, \"we redownloaded all the layers\"\n479     assert get_api_current_physical_size() == filled_current_physical\n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 478,
      "line_range": [
        478
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "478     assert filled_size == refilled_size, \"we redownloaded all the layers\"\n479     assert get_api_current_physical_size() == filled_current_physical\n480 \n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 479,
      "line_range": [
        479
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "486     with endpoint_old.cursor() as cur:\n487         assert query_scalar(cur, \"select count(*) from testtab\") == table_len\n488 \n",
      "col_offset": 8,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 487,
      "line_range": [
        487
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "516         total_bytes = m.query_one(\"pageserver_remote_ondemand_downloaded_bytes_total\").value\n517         assert (\n518             total_bytes < 2**53 and total_bytes.is_integer()\n519         ), \"bytes should still be safe integer-in-f64\"\n520         count = m.query_one(\"pageserver_remote_ondemand_downloaded_layers_total\").value\n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 517,
      "line_range": [
        517,
        518,
        519
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "520         count = m.query_one(\"pageserver_remote_ondemand_downloaded_layers_total\").value\n521         assert count < 2**53 and count.is_integer(), \"count should still be safe integer-in-f64\"\n522         return (int(total_bytes), int(count))\n",
      "col_offset": 8,
      "end_col_offset": 96,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 521,
      "line_range": [
        521
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "542     layers = pageserver_http.layer_map_info(tenant_id, timeline_id)\n543     assert not layers.in_memory_layers, \"no inmemory layers expected after post-commit checkpoint\"\n544     assert len(layers.historic_layers) == 1 + 2, \"should have initdb layer and 2 deltas\"\n",
      "col_offset": 4,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 543,
      "line_range": [
        543
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "543     assert not layers.in_memory_layers, \"no inmemory layers expected after post-commit checkpoint\"\n544     assert len(layers.historic_layers) == 1 + 2, \"should have initdb layer and 2 deltas\"\n545 \n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 544,
      "line_range": [
        544
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "558         log.info(f\"post compact: {layer}\")\n559     assert len(layers.historic_layers) == 1, \"should have compacted to single layer\"\n560 \n",
      "col_offset": 4,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 559,
      "line_range": [
        559
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "563     # use gte to allow pageserver to do other random stuff; this test could be run on a shared pageserver\n564     assert post_compact[0] >= layer_sizes\n565     assert post_compact[1] >= 3, \"should had downloaded the three layers\"\n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 564,
      "line_range": [
        564
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "564     assert post_compact[0] >= layer_sizes\n565     assert post_compact[1] >= 3, \"should had downloaded the three layers\"\n566 \n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 565,
      "line_range": [
        565
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "639     layers = pageserver_http.layer_map_info(tenant_id, timeline_id)\n640     assert not layers.in_memory_layers, \"no inmemory layers expected after post-commit checkpoint\"\n641 \n",
      "col_offset": 4,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 640,
      "line_range": [
        640
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "647 \n648     assert dict(kinds_before) == {\"Delta\": 4}\n649 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 648,
      "line_range": [
        648
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "662 \n663     assert dict(kinds_after) == {\"Delta\": 4, \"Image\": 1}\n664 \n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 663,
      "line_range": [
        663
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "689     info = client.layer_map_info(env.initial_tenant, env.initial_timeline)\n690     assert len(info.delta_layers()) == 1\n691 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 690,
      "line_range": [
        690
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "774     neon_env_builder.enable_pageserver_remote_storage(RemoteStorageKind.MOCK_S3)\n775     assert isinstance(neon_env_builder.pageserver_remote_storage, S3Storage)\n776     neon_env_builder.pageserver_remote_storage.custom_timeout = \"1s\"\n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 775,
      "line_range": [
        775
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "789     info = client.layer_map_info(env.initial_tenant, env.initial_timeline)\n790     assert len(info.delta_layers()) == 1\n791 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 790,
      "line_range": [
        790
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "859 \n860         assert elapsed < 30, \"too long passed: {elapsed=}\"\n861 \n",
      "col_offset": 8,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 860,
      "line_range": [
        860
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132     cur_replica.execute(\"SELECT * FROM clogtest\")\n133     assert cur_replica.fetchall() == [(1,), (3,)]\n134 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_ondemand_slru_download.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "21     # check initial tenant is there\n22     assert initial_tenant in {TenantId(t[\"id\"]) for t in client.tenant_list()}\n23 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 22,
      "line_range": [
        22
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "30     )\n31     assert tenant_id in {TenantId(t[\"id\"]) for t in client.tenant_list()}\n32 \n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 31,
      "line_range": [
        31
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "33     timelines = client.timeline_list(tenant_id)\n34     assert len(timelines) == 0, \"initial tenant should not have any timelines\"\n35 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 34,
      "line_range": [
        34
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44     timelines = client.timeline_list(tenant_id)\n45     assert len(timelines) > 0\n46 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "47     # check it is there\n48     assert timeline_id in {TimelineId(b[\"timeline_id\"]) for b in client.timeline_list(tenant_id)}\n49     for timeline in timelines:\n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 48,
      "line_range": [
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "56 \n57         assert TenantId(timeline_details[\"tenant_id\"]) == tenant_id\n58         assert TimelineId(timeline_details[\"timeline_id\"]) == timeline_id\n",
      "col_offset": 8,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "57         assert TenantId(timeline_details[\"tenant_id\"]) == tenant_id\n58         assert TimelineId(timeline_details[\"timeline_id\"]) == timeline_id\n59 \n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 58,
      "line_range": [
        58
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "69 \n70         assert (\n71             timeline_details.get(\"wal_source_connstr\") is None\n72         ), \"Should not be able to connect to WAL streaming without PG compute node running\"\n73         assert (\n",
      "col_offset": 8,
      "end_col_offset": 91,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 70,
      "line_range": [
        70,
        71,
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "72         ), \"Should not be able to connect to WAL streaming without PG compute node running\"\n73         assert (\n74             timeline_details.get(\"last_received_msg_lsn\") is None\n75         ), \"Should not be able to connect to WAL streaming without PG compute node running\"\n76         assert (\n",
      "col_offset": 8,
      "end_col_offset": 91,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 73,
      "line_range": [
        73,
        74,
        75
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75         ), \"Should not be able to connect to WAL streaming without PG compute node running\"\n76         assert (\n77             timeline_details.get(\"last_received_msg_ts\") is None\n78         ), \"Should not be able to connect to WAL streaming without PG compute node running\"\n79 \n",
      "col_offset": 8,
      "end_col_offset": 91,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76,
        77,
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89     # a successful `timeline_details` response must contain the below fields\n90     assert \"wal_source_connstr\" in timeline_details.keys()\n91     assert \"last_received_msg_lsn\" in timeline_details.keys()\n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "90     assert \"wal_source_connstr\" in timeline_details.keys()\n91     assert \"last_received_msg_lsn\" in timeline_details.keys()\n92     assert \"last_received_msg_ts\" in timeline_details.keys()\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 91,
      "line_range": [
        91
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91     assert \"last_received_msg_lsn\" in timeline_details.keys()\n92     assert \"last_received_msg_ts\" in timeline_details.keys()\n93 \n",
      "col_offset": 4,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "93 \n94     assert (\n95         timeline_details[\"last_received_msg_lsn\"] is not None\n96     ), \"the last received message's LSN is empty\"\n97 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94,
        95,
        96
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "98     last_msg_lsn = Lsn(timeline_details[\"last_received_msg_lsn\"])\n99     assert (\n100         prev_msg_lsn is None or prev_msg_lsn < last_msg_lsn\n101     ), f\"the last received message's LSN {last_msg_lsn} hasn't been updated compared to the previous message's LSN {prev_msg_lsn}\"\n102 \n",
      "col_offset": 4,
      "end_col_offset": 130,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_api.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 99,
      "line_range": [
        99,
        100,
        101
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "33     cur.execute(\"SELECT count(*) FROM foo\")\n34     assert cur.fetchone() == (10000,)\n35 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_catchup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 34,
      "line_range": [
        34
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "70     cur.execute(\"SELECT count(*) FROM foo\")\n71     assert cur.fetchone() == (20000,)\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_catchup.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 71,
      "line_range": [
        71
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55     # now the duplicate L1 has been created, but is not yet uploaded\n56     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n57 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_crash_consistency.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "82 \n83     assert l1_found is not None, \"failed to find L1 locally\"\n84 \n",
      "col_offset": 4,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_crash_consistency.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 83,
      "line_range": [
        83
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "87     )\n88     assert not uploaded.exists(), \"to-be-overwritten should not yet be uploaded\"\n89 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_crash_consistency.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 88,
      "line_range": [
        88
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "92 \n93     assert not env.pageserver.layer_exists(\n94         tenant_id, timeline_id, l1_found\n95     ), \"partial compaction result should had been removed during startup\"\n96 \n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_crash_consistency.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93,
        94,
        95
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "101 \n102     assert env.pageserver.layer_exists(tenant_id, timeline_id, l1_found), \"the L1 reappears\"\n103 \n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_crash_consistency.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 102,
      "line_range": [
        102
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "106     )\n107     assert uploaded.exists(), \"the L1 is uploaded\"\n108 \n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_crash_consistency.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 107,
      "line_range": [
        107
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "70         tenant_id = env.initial_tenant\n71     assert tenant_id is not None\n72 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 71,
      "line_range": [
        71
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "74         timeline_id = env.initial_timeline\n75     assert timeline_id is not None\n76 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 75,
      "line_range": [
        75
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "120 \n121     assert depth >= 0\n122     return int(depth)\n",
      "col_offset": 4,
      "end_col_offset": 21,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 121,
      "line_range": [
        121
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "126     v = get_deletion_queue_depth(ps_http)\n127     assert v is not None\n128     assert size_fn(v) is True\n",
      "col_offset": 4,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 127,
      "line_range": [
        127
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "127     assert v is not None\n128     assert size_fn(v) is True\n129 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 128,
      "line_range": [
        128
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "173 \n174     assert neon_env_builder.pageserver_remote_storage is not None\n175     pre_upgrade_keys = list(\n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 174,
      "line_range": [
        174
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "183     for key in pre_upgrade_keys:\n184         assert parse_generation_suffix(key) is None\n185 \n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 184,
      "line_range": [
        184
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "214     # Bucket now contains a mixture of suffixed and non-suffixed objects\n215     assert len(suffixed_objects) > 0\n216     assert len(legacy_objects) > 0\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 215,
      "line_range": [
        215
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "215     assert len(suffixed_objects) > 0\n216     assert len(legacy_objects) > 0\n217 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 216,
      "line_range": [
        216
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "222 \n223     assert get_deletion_queue_unexpected_errors(env.pageserver.http_client()) == 0\n224 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 223,
      "line_range": [
        223
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "227     healthy, metadata_summary = env.storage_scrubber.scan_metadata()\n228     assert metadata_summary[\"tenant_count\"] == 1  # Scrubber should have seen our timeline\n229     assert metadata_summary[\"timeline_count\"] == 1\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 228,
      "line_range": [
        228
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "228     assert metadata_summary[\"tenant_count\"] == 1  # Scrubber should have seen our timeline\n229     assert metadata_summary[\"timeline_count\"] == 1\n230     assert metadata_summary[\"timeline_shard_count\"] == 1\n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 229,
      "line_range": [
        229
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "229     assert metadata_summary[\"timeline_count\"] == 1\n230     assert metadata_summary[\"timeline_shard_count\"] == 1\n231     assert healthy\n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 230,
      "line_range": [
        230
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "230     assert metadata_summary[\"timeline_shard_count\"] == 1\n231     assert healthy\n232 \n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 231,
      "line_range": [
        231
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "252     assert_deletion_queue(ps_http, lambda n: n == 0)\n253     assert get_deletion_queue_dropped(ps_http) == 0\n254 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 253,
      "line_range": [
        253
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "256     timeline = ps_http.timeline_detail(env.initial_tenant, env.initial_timeline)\n257     assert timeline[\"remote_consistent_lsn\"] == timeline[\"remote_consistent_lsn_visible\"]\n258     assert get_deletion_queue_dropped_lsn_updates(ps_http) == 0\n",
      "col_offset": 4,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 257,
      "line_range": [
        257
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "257     assert timeline[\"remote_consistent_lsn\"] == timeline[\"remote_consistent_lsn_visible\"]\n258     assert get_deletion_queue_dropped_lsn_updates(ps_http) == 0\n259 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 258,
      "line_range": [
        258
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "272     # The executed counter has not incremented\n273     assert get_deletion_queue_executed(ps_http) == executed_before\n274     # The dropped counter has incremented to consume all of the deletions that were previously enqueued\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 273,
      "line_range": [
        273
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "274     # The dropped counter has incremented to consume all of the deletions that were previously enqueued\n275     assert get_deletion_queue_dropped(ps_http) == queue_depth_before\n276 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 275,
      "line_range": [
        275
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "279     timeline = ps_http.timeline_detail(env.initial_tenant, env.initial_timeline)\n280     assert timeline[\"remote_consistent_lsn\"] != timeline[\"remote_consistent_lsn_visible\"]\n281     assert get_deletion_queue_dropped_lsn_updates(ps_http) > 0\n",
      "col_offset": 4,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 280,
      "line_range": [
        280
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "280     assert timeline[\"remote_consistent_lsn\"] != timeline[\"remote_consistent_lsn_visible\"]\n281     assert get_deletion_queue_dropped_lsn_updates(ps_http) > 0\n282 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 281,
      "line_range": [
        281
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "284 \n285     assert get_deletion_queue_unexpected_errors(ps_http) == 0\n286 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 285,
      "line_range": [
        285
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "344 \n345     assert get_deletion_queue_unexpected_errors(ps_http) == 0\n346     assert get_deletion_queue_dropped_lsn_updates(ps_http) == 0\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 345,
      "line_range": [
        345
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "345     assert get_deletion_queue_unexpected_errors(ps_http) == 0\n346     assert get_deletion_queue_dropped_lsn_updates(ps_http) == 0\n347 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 346,
      "line_range": [
        346
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "356         def assert_some_validations():\n357             assert get_deletion_queue_validated(ps_http) > 0\n358 \n",
      "col_offset": 12,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 357,
      "line_range": [
        357
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "364         def assert_header_written():\n365             assert (main_pageserver.workdir / \"deletion\" / \"header-01\").exists()\n366 \n",
      "col_offset": 12,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 365,
      "line_range": [
        365
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "383     def assert_deletions_submitted(n: int) -> None:\n384         assert ps_http.get_metric_value(\"pageserver_deletion_queue_submitted_total\") == n\n385 \n",
      "col_offset": 8,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 384,
      "line_range": [
        384
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "397         #   because on re-attach they were from the immediately preceding generation\n398         assert get_deletion_queue_executed(ps_http) == before_restart_depth\n399     elif validate_before == ValidateBefore.VALIDATE:\n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 398,
      "line_range": [
        398
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "401         #   validated before restart.\n402         assert get_deletion_queue_executed(ps_http) == before_restart_depth\n403     else:\n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 402,
      "line_range": [
        402
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "404         # If we lost the attachment, we should have dropped our pre-restart deletions.\n405         assert get_deletion_queue_dropped(ps_http) == before_restart_depth\n406 \n",
      "col_offset": 8,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 405,
      "line_range": [
        405
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "406 \n407     assert get_deletion_queue_unexpected_errors(ps_http) == 0\n408     assert get_deletion_queue_dropped_lsn_updates(ps_http) == 0\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 407,
      "line_range": [
        407
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "407     assert get_deletion_queue_unexpected_errors(ps_http) == 0\n408     assert get_deletion_queue_dropped_lsn_updates(ps_http) == 0\n409 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 408,
      "line_range": [
        408
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "418 \n419     assert get_deletion_queue_unexpected_errors(ps_http) == 0\n420     assert get_deletion_queue_dropped_lsn_updates(ps_http) == 0\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 419,
      "line_range": [
        419
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "419     assert get_deletion_queue_unexpected_errors(ps_http) == 0\n420     assert get_deletion_queue_dropped_lsn_updates(ps_http) == 0\n421 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 420,
      "line_range": [
        420
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "451     time.sleep(10)\n452     assert get_deletion_queue_validated(ps_http) == validated\n453 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 452,
      "line_range": [
        452
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "470     time.sleep(10)\n471     assert get_deletion_queue_depth(ps_http) > 0\n472     assert get_deletion_queue_validated(ps_http) == 0\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 471,
      "line_range": [
        471
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "471     assert get_deletion_queue_depth(ps_http) > 0\n472     assert get_deletion_queue_validated(ps_http) == 0\n473     assert get_deletion_queue_executed(ps_http) == 0\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 472,
      "line_range": [
        472
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "472     assert get_deletion_queue_validated(ps_http) == 0\n473     assert get_deletion_queue_executed(ps_http) == 0\n474 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 473,
      "line_range": [
        473
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "478     ps_http.deletion_queue_flush(execute=True)\n479     assert get_deletion_queue_depth(ps_http) == 0\n480     assert get_deletion_queue_validated(ps_http) > 0\n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 479,
      "line_range": [
        479
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "479     assert get_deletion_queue_depth(ps_http) == 0\n480     assert get_deletion_queue_validated(ps_http) > 0\n481     assert get_deletion_queue_executed(ps_http) > 0\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 480,
      "line_range": [
        480
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "480     assert get_deletion_queue_validated(ps_http) > 0\n481     assert get_deletion_queue_executed(ps_http) > 0\n482 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 481,
      "line_range": [
        481
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "489     ps_http.deletion_queue_flush(execute=True)\n490     assert get_deletion_queue_depth(ps_http) == 0\n491     assert get_deletion_queue_validated(ps_http) > 0\n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 490,
      "line_range": [
        490
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "490     assert get_deletion_queue_depth(ps_http) == 0\n491     assert get_deletion_queue_validated(ps_http) > 0\n492     assert get_deletion_queue_executed(ps_http) > 0\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 491,
      "line_range": [
        491
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "491     assert get_deletion_queue_validated(ps_http) > 0\n492     assert get_deletion_queue_executed(ps_http) > 0\n493 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 492,
      "line_range": [
        492
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "631 \n632     assert raised == 2 and serving_ps_idx is not None\n633 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 632,
      "line_range": [
        632
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "684 \n685         assert files_renamed > 0\n686 \n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 685,
      "line_range": [
        685
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "691     # Assert that there were no on-demand downloads\n692     assert (\n693         attached_pageserver.http_client().get_metric_value(\n694             \"pageserver_remote_ondemand_downloaded_layers_total\"\n695         )\n696         == 0\n697     )\n698 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 692,
      "line_range": [
        692,
        693,
        694,
        695,
        696,
        697
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "700     secondary_pageserver.http_client().tenant_secondary_download(tenant_id)\n701     assert (\n702         secondary_pageserver.http_client().get_metric_value(\n703             \"pageserver_secondary_download_layer_total\"\n704         )\n705         == 0\n706     )\n707 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 701,
      "line_range": [
        701,
        702,
        703,
        704,
        705,
        706
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "717     (victim_layer_name, victim_path) = local_layers[0]\n718     assert os.path.exists(victim_path)\n719 \n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 718,
      "line_range": [
        718
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "722     )\n723     assert not os.path.exists(victim_path)\n724 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 723,
      "line_range": [
        723
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "728     # We should download into the same local path we started with\n729     assert os.path.exists(victim_path)\n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_generations.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 729,
      "line_range": [
        729
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "79     smgr_query_seconds_pre = ps_http.get_metric_value(metric_name, metrics_query)\n80     assert smgr_query_seconds_pre is not None\n81 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_getpage_throttle.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 80,
      "line_range": [
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "95     threshold = 0.05 * expect_ncompleted\n96     assert (\n97         threshold / rate_limit_rps < 0.1 * duration_secs\n98     ), \"test self-test: unrealistic expecations regarding precision in this test\"\n99     assert (\n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_getpage_throttle.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 96,
      "line_range": [
        96,
        97,
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "98     ), \"test self-test: unrealistic expecations regarding precision in this test\"\n99     assert (\n100         delta_abs < 0.05 * expect_ncompleted\n101     ), \"the throttling deviates more than 5percent from the expectation\"\n102 \n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_getpage_throttle.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 99,
      "line_range": [
        99,
        100,
        101
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "115     smgr_query_seconds_post = ps_http.get_metric_value(metric_name, metrics_query)\n116     assert smgr_query_seconds_post is not None\n117     actual_smgr_query_seconds = smgr_query_seconds_post - smgr_query_seconds_pre\n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_getpage_throttle.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 116,
      "line_range": [
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "118 \n119     assert (\n120         duration_secs >= 10 * actual_smgr_query_seconds\n121     ), \"smgr metrics should not include throttle wait time\"\n122 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_getpage_throttle.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 119,
      "line_range": [
        119,
        120,
        121
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "140 \n141     assert conf == without_fair\n142 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_getpage_throttle.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 141,
      "line_range": [
        141
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "40             await conn.execute(\n41                 f\"INSERT INTO t SELECT i, CONCAT('payload_', i) FROM generate_series({offset},{entries}) as i\"\n42             )\n",
      "col_offset": 18,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 41,
      "line_range": [
        41
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "71             )\n72             assert waited >= last_flush_lsn\n73 \n",
      "col_offset": 12,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "86         value = pageserver_http.get_metric_value(\"pageserver_wal_ingest_records_received_total\")\n87         assert value is not None\n88         return value\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 87,
      "line_range": [
        87
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104 def assert_dirty_bytes(env, v):\n105     assert get_dirty_bytes(env) == v\n106 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 105,
      "line_range": [
        105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "109     dirty_bytes = get_dirty_bytes(env)\n110     assert dirty_bytes > 0\n111     return dirty_bytes\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 110,
      "line_range": [
        110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "159     # because we shut down compute endpoints before flushing.\n160     assert get_dirty_bytes(env) == 0\n161 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 160,
      "line_range": [
        160
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "166 \n167     assert total_wal_ingested_after_restart == 0\n168 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 167,
      "line_range": [
        167
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "196     # and the teardown of SK connections shouldn't prompt any layer freezing.\n197     assert get_dirty_bytes(env) > 0\n198 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 197,
      "line_range": [
        197
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "226 \n227         assert get_dirty_bytes(env) >= dirty_after_write\n228 \n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 227,
      "line_range": [
        227
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "247     ephemeral_bytes_per_memory_kb = (max_dirty_data * 1024) // system_memory\n248     assert ephemeral_bytes_per_memory_kb > 0\n249 \n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 248,
      "line_range": [
        248
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "279         this_timeline_ingested = last_flush_lsn - initdb_lsn\n280         assert (\n281             this_timeline_ingested < checkpoint_distance * 0.8\n282         ), \"this test is supposed to fill InMemoryLayer\"\n283         total_bytes_ingested += this_timeline_ingested\n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 280,
      "line_range": [
        280,
        281,
        282
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "285     log.info(f\"Ingested {total_bytes_ingested} bytes since initdb (vs max dirty {max_dirty_data})\")\n286     assert total_bytes_ingested > max_dirty_data\n287 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 286,
      "line_range": [
        286
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "311     def assert_bytes_rolled():\n312         assert total_bytes_ingested - get_total_historic_layers() <= max_dirty_data\n313 \n",
      "col_offset": 8,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 312,
      "line_range": [
        312
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "321         dirty_bytes = get_dirty_bytes(env)\n322         assert dirty_bytes < max_dirty_data\n323 \n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_layer_rolling.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 322,
      "line_range": [
        322
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "50         is_last = request.headers[\"pageserver-metrics-last-upload-in-batch\"]\n51         assert is_last in [\"true\", \"false\"]\n52         uploads.put((events, is_last == \"true\"))\n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 51,
      "line_range": [
        51
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55     neon_env_builder.enable_pageserver_remote_storage(RemoteStorageKind.LOCAL_FS)\n56     assert neon_env_builder.pageserver_remote_storage is not None\n57 \n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "123     remote_uploaded = get_num_remote_ops(\"index\", \"upload\")\n124     assert remote_uploaded > 0\n125 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 124,
      "line_range": [
        124
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "156         rounds += 1\n157         assert rounds < 10, \"did not get synthetic_storage_size in 10 uploads\"\n158         # once we have it in verifiers, it will assert that future batches will contain it\n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 157,
      "line_range": [
        157
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "182     bucket_dumps = {}\n183     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n184     for dirpath, _dirs, files in os.walk(env.pageserver_remote_storage.root):\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 183,
      "line_range": [
        183
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "190 \n191     assert len(bucket_dumps) >= 1\n192     assert all(\"events\" in data for data in bucket_dumps.values())\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 191,
      "line_range": [
        191
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "191     assert len(bucket_dumps) >= 1\n192     assert all(\"events\" in data for data in bucket_dumps.values())\n193 \n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "211         is_last = request.headers[\"pageserver-metrics-last-upload-in-batch\"]\n212         assert is_last in [\"true\", \"false\"]\n213         uploads.put((events, is_last == \"true\"))\n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 212,
      "line_range": [
        212
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "287 \n288     assert (\n289         len(initially.matching) == 2\n290     ), f\"expecting actual file and tempfile, but not found: {initially.matching}\"\n291 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 288,
      "line_range": [
        288,
        289,
        290
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "308     only = set([\"last_consumption_metrics.json\"])\n309     assert (\n310         initially.matching.intersection(later.matching) == only\n311     ), \"only initial tempfile should had been removed\"\n312     assert initially.other.issuperset(later.other), \"no other files should had been removed\"\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 309,
      "line_range": [
        309,
        310,
        311
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "311     ), \"only initial tempfile should had been removed\"\n312     assert initially.other.issuperset(later.other), \"no other files should had been removed\"\n313 \n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 312,
      "line_range": [
        312
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "379     def ingest(self, event):\n380         assert TenantId(event[\"tenant_id\"]) == self.id\n381 \n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 380,
      "line_range": [
        380
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "459     def ingest(self, event, parent):\n460         assert event[\"type\"] == \"incremental\"\n461         self.value = event[\"value\"]\n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 460,
      "line_range": [
        460
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "467             # this holds across restarts\n468             assert self.timerange[1] == timerange[0], \"time ranges should be continious\"\n469         self.timerange = timerange\n",
      "col_offset": 12,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 468,
      "line_range": [
        468
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "475             # about 30MB on the first event. it is not consistent.\n476             assert self.value is not None\n477         else:\n",
      "col_offset": 12,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 476,
      "line_range": [
        476
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "477         else:\n478             assert self.value == absolute.values[-1] - absolute.values[-2]\n479             # sounds like this should hold, but it will not for branches -- probably related to timing\n",
      "col_offset": 12,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 478,
      "line_range": [
        478
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "489     def ingest(self, event, parent):\n490         assert isinstance(parent, TenantMetricsVerifier)\n491         assert event[\"type\"] == \"absolute\"\n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 490,
      "line_range": [
        490
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "490         assert isinstance(parent, TenantMetricsVerifier)\n491         assert event[\"type\"] == \"absolute\"\n492         value = event[\"value\"]\n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 491,
      "line_range": [
        491
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "497             # this is assuming no one goes and deletes the cache file\n498             assert (\n499                 self.value is not None\n500             ), \"after calculating first synthetic size, cached or more recent should be sent\"\n501         self.prev = self.value\n",
      "col_offset": 12,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 498,
      "line_range": [
        498,
        499,
        500
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "67         log.info(\"Connection to PS failed\")\n68     assert not endpoint.log_contains(\"ERROR:  cannot wait on socket event without a socket.*\")\n",
      "col_offset": 4,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_reconnect.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 68,
      "line_range": [
        68
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "27 \n28     assert (\n29         pageserver_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"})\n30         == 1\n31     )\n32 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 28,
      "line_range": [
        28,
        29,
        30,
        31
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "56     row = cur.fetchone()\n57     assert row is not None\n58     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 57,
      "line_range": [
        57
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "58     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n59     assert int(row[0]) < int(row[1])\n60 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 59,
      "line_range": [
        59
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "65     # We reloaded our tenant\n66     assert (\n67         pageserver_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"})\n68         == 1\n69     )\n70 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 66,
      "line_range": [
        66,
        67,
        68,
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "71     cur.execute(\"SELECT count(*) FROM foo\")\n72     assert cur.fetchone() == (100000,)\n73 \n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "87     log.info(\"Tenant status : %s\", tenant_status)\n88     assert tenant_status[\"state\"][\"slug\"] == \"Attaching\"\n89 \n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 88,
      "line_range": [
        88
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91     cur.execute(\"SELECT count(*) FROM foo\")\n92     assert cur.fetchone() == (100000,)\n93 \n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "130         log.info(f\"metric {phase}={sample.value}\")\n131         assert phase in [e[0] for e in expectations], f\"Unexpected phase {phase}\"\n132         values[phase] = sample\n",
      "col_offset": 8,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 131,
      "line_range": [
        131
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "135     for phase, expectation in expectations:\n136         assert phase in values, f\"No data for phase {phase}\"\n137         sample = values[phase]\n",
      "col_offset": 8,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 136,
      "line_range": [
        136
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "137         sample = values[phase]\n138         assert expectation(\n139             sample.value, prev_value\n140         ), f\"Unexpected value for {phase}: {sample.value}\"\n141         prev_value = sample.value\n",
      "col_offset": 8,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 138,
      "line_range": [
        138,
        139,
        140
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "143     # Startup is complete, this metric should exist but be zero\n144     assert metrics.query_one(\"pageserver_startup_is_loading\").value == 0\n145 \n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 144,
      "line_range": [
        144
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "147     # which bucket values: just nonzero\n148     assert any(\n149         bucket.value > 0\n150         for bucket in metrics.query_all(\"pageserver_tenant_activation_seconds_bucket\")\n151     )\n152 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 148,
      "line_range": [
        148,
        149,
        150,
        151
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "204             row = cur.fetchone()\n205             assert row is not None\n206             log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 205,
      "line_range": [
        205
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "206             log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n207             assert int(row[0]) < int(row[1])\n208 \n",
      "col_offset": 12,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 207,
      "line_range": [
        207
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "211     seed = 0xDEADBEEF\n212     rng = random.Random(seed)\n213 \n",
      "col_offset": 10,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 212,
      "line_range": [
        212
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "224         num_updates = endpoint.safe_psql(\"SELECT sum(updates) FROM foo\")[0][0]\n225         assert num_updates == i * 100000\n226 \n",
      "col_offset": 8,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 225,
      "line_range": [
        225
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "140     # chosen order, but not to change the order every time we run the test.\n141     rng = random.Random(seed)\n142 \n",
      "col_offset": 10,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 141,
      "line_range": [
        141
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "184                 # \"attach in same generation\" operation later\n185                 assert last_state_ps[1] is not None  # latest_attached == pageserfer.id implies this\n186                 # The re-attach API increments generation by exactly one.\n",
      "col_offset": 16,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 185,
      "line_range": [
        185
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "189                 tenants = pageserver.http_client().tenant_list()\n190                 assert len(tenants) == 1\n191                 assert tenants[0][\"generation\"] == new_generation\n",
      "col_offset": 16,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 190,
      "line_range": [
        190
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "190                 assert len(tenants) == 1\n191                 assert tenants[0][\"generation\"] == new_generation\n192 \n",
      "col_offset": 16,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 191,
      "line_range": [
        191
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "249     gc_summary = env.storage_scrubber.pageserver_physical_gc(min_age_secs=1)\n250     assert gc_summary[\"remote_storage_errors\"] == 0\n251     assert gc_summary[\"indices_deleted\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 250,
      "line_range": [
        250
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "250     assert gc_summary[\"remote_storage_errors\"] == 0\n251     assert gc_summary[\"indices_deleted\"] > 0\n252 \n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 251,
      "line_range": [
        251
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "264         location_conf = {\"mode\": \"Detached\", \"secondary_conf\": None, \"tenant_conf\": {}}\n265         assert ps.list_layers(tenant_id, timeline_id) != []\n266         ps.tenant_location_configure(tenant_id, location_conf)\n",
      "col_offset": 8,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 265,
      "line_range": [
        265
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "268         # Confirm that all local disk state was removed on detach\n269         assert ps.list_layers(tenant_id, timeline_id) == []\n270 \n",
      "col_offset": 8,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 269,
      "line_range": [
        269
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "322     log.info(f\"Acquired generation {migrated_generation} for destination pageserver\")\n323     assert migrated_generation == initial_generation + 1\n324 \n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 323,
      "line_range": [
        323
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "356         )\n357         assert destination_lsn >= origin_lsn\n358 \n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 357,
      "line_range": [
        357
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "408     env = neon_env_builder.init_start()  # initial_tenant_conf=TENANT_CONF)\n409     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n410 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 409,
      "line_range": [
        409
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "422     def validate_heatmap(heatmap):\n423         assert len(heatmap[\"timelines\"]) == 1\n424         assert heatmap[\"timelines\"][0][\"timeline_id\"] == str(timeline_id)\n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 423,
      "line_range": [
        423
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "423         assert len(heatmap[\"timelines\"]) == 1\n424         assert heatmap[\"timelines\"][0][\"timeline_id\"] == str(timeline_id)\n425         assert len(heatmap[\"timelines\"][0][\"layers\"]) > 0\n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 424,
      "line_range": [
        424
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "424         assert heatmap[\"timelines\"][0][\"timeline_id\"] == str(timeline_id)\n425         assert len(heatmap[\"timelines\"][0][\"layers\"]) > 0\n426         layers = heatmap[\"timelines\"][0][\"layers\"]\n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 425,
      "line_range": [
        425
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "428         # Each layer appears at most once\n429         assert len(set(layer[\"name\"] for layer in layers)) == len(layers)\n430 \n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 429,
      "line_range": [
        429
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "442     log.info(f\"Read back heatmap: {heatmap_second}\")\n443     assert heatmap_second != heatmap_first\n444     validate_heatmap(heatmap_second)\n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 443,
      "line_range": [
        443
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "492     env = neon_env_builder.init_start(initial_tenant_conf=TENANT_CONF)\n493     assert env.storage_controller is not None\n494     assert isinstance(env.pageserver_remote_storage, S3Storage)  # Satisfy linter\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 493,
      "line_range": [
        493
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "493     assert env.storage_controller is not None\n494     assert isinstance(env.pageserver_remote_storage, S3Storage)  # Satisfy linter\n495 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 494,
      "line_range": [
        494
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "529 \n530     assert list_elegible_layers(ps_attached, tenant_id, timeline_id) == ps_secondary.list_layers(\n531         tenant_id, timeline_id\n532     )\n533 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 530,
      "line_range": [
        530,
        531,
        532
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "547     try:\n548         assert list_elegible_layers(\n549             ps_attached, tenant_id, timeline_id\n550         ) == ps_secondary.list_layers(tenant_id, timeline_id)\n551     except:\n",
      "col_offset": 8,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 548,
      "line_range": [
        548,
        549,
        550
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "583         )\n584         assert layer_to_evict.name not in heatmap_layers\n585         assert parse_layer_file_name(some_other_layer.name).to_str() in heatmap_layers\n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 584,
      "line_range": [
        584
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "584         assert layer_to_evict.name not in heatmap_layers\n585         assert parse_layer_file_name(some_other_layer.name).to_str() in heatmap_layers\n586 \n",
      "col_offset": 8,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 585,
      "line_range": [
        585
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "588 \n589         assert layer_to_evict not in ps_attached.list_layers(tenant_id, timeline_id)\n590         assert list_elegible_layers(\n",
      "col_offset": 8,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 589,
      "line_range": [
        589
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "589         assert layer_to_evict not in ps_attached.list_layers(tenant_id, timeline_id)\n590         assert list_elegible_layers(\n591             ps_attached, tenant_id, timeline_id\n592         ) == ps_secondary.list_layers(tenant_id, timeline_id)\n593     except:\n",
      "col_offset": 8,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 590,
      "line_range": [
        590,
        591,
        592
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "602     healthy, _ = env.storage_scrubber.scan_metadata()\n603     assert healthy\n604 \n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 603,
      "line_range": [
        603
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "716             # One or more layers should be present for all timelines\n717             assert ps_secondary.list_layers(tenant_id, timeline_id)\n718 \n",
      "col_offset": 12,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 717,
      "line_range": [
        717
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "741         # This one was not deleted\n742         assert ps_secondary.list_layers(tenant_id, timelines[0])\n743 \n",
      "col_offset": 8,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 742,
      "line_range": [
        742
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "747         )\n748         assert not ps_secondary.list_layers(tenant_id, expect_del_timeline)\n749 \n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 748,
      "line_range": [
        748
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "756         v = ps.http_client().get_metric_value(\"pageserver_secondary_download_heatmap_total\")\n757         assert v is not None\n758         total_heatmap_downloads += int(v)\n",
      "col_offset": 8,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 757,
      "line_range": [
        757
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "764 \n765     assert download_rate < expect_download_rate * 2\n766 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 765,
      "line_range": [
        765
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "805     # Expect lots of layers\n806     assert len(ps_attached.list_layers(tenant_id, timeline_id)) > 10\n807 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 806,
      "line_range": [
        806
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "830     (status, progress_1) = http_client.tenant_secondary_download(tenant_id, wait_ms=4000)\n831     assert status == 202\n832     assert progress_1[\"heatmap_mtime\"] is not None\n",
      "col_offset": 4,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 831,
      "line_range": [
        831
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "831     assert status == 202\n832     assert progress_1[\"heatmap_mtime\"] is not None\n833     assert progress_1[\"layers_downloaded\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 832,
      "line_range": [
        832
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "832     assert progress_1[\"heatmap_mtime\"] is not None\n833     assert progress_1[\"layers_downloaded\"] > 0\n834     assert progress_1[\"bytes_downloaded\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 833,
      "line_range": [
        833
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "833     assert progress_1[\"layers_downloaded\"] > 0\n834     assert progress_1[\"bytes_downloaded\"] > 0\n835     assert progress_1[\"layers_total\"] > progress_1[\"layers_downloaded\"]\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 834,
      "line_range": [
        834
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "834     assert progress_1[\"bytes_downloaded\"] > 0\n835     assert progress_1[\"layers_total\"] > progress_1[\"layers_downloaded\"]\n836     assert progress_1[\"bytes_total\"] > progress_1[\"bytes_downloaded\"]\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 835,
      "line_range": [
        835
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "835     assert progress_1[\"layers_total\"] > progress_1[\"layers_downloaded\"]\n836     assert progress_1[\"bytes_total\"] > progress_1[\"bytes_downloaded\"]\n837 \n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 836,
      "line_range": [
        836
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "839     (status, progress_2) = http_client.tenant_secondary_download(tenant_id, wait_ms=1000)\n840     assert status == 202\n841     assert progress_2[\"heatmap_mtime\"] is not None\n",
      "col_offset": 4,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 840,
      "line_range": [
        840
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "840     assert status == 202\n841     assert progress_2[\"heatmap_mtime\"] is not None\n842     assert progress_2[\"layers_downloaded\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 841,
      "line_range": [
        841
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "841     assert progress_2[\"heatmap_mtime\"] is not None\n842     assert progress_2[\"layers_downloaded\"] > 0\n843     assert progress_2[\"bytes_downloaded\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 842,
      "line_range": [
        842
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "842     assert progress_2[\"layers_downloaded\"] > 0\n843     assert progress_2[\"bytes_downloaded\"] > 0\n844     assert progress_2[\"layers_total\"] > progress_2[\"layers_downloaded\"]\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 843,
      "line_range": [
        843
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "843     assert progress_2[\"bytes_downloaded\"] > 0\n844     assert progress_2[\"layers_total\"] > progress_2[\"layers_downloaded\"]\n845     assert progress_2[\"bytes_total\"] > progress_2[\"bytes_downloaded\"]\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 844,
      "line_range": [
        844
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "844     assert progress_2[\"layers_total\"] > progress_2[\"layers_downloaded\"]\n845     assert progress_2[\"bytes_total\"] > progress_2[\"bytes_downloaded\"]\n846 \n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 845,
      "line_range": [
        845
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "849     # new heatmap should have been uploaded.\n850     assert progress_2[\"layers_downloaded\"] >= progress_1[\"layers_downloaded\"]\n851     assert progress_2[\"bytes_downloaded\"] >= progress_1[\"bytes_downloaded\"]\n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 850,
      "line_range": [
        850
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "850     assert progress_2[\"layers_downloaded\"] >= progress_1[\"layers_downloaded\"]\n851     assert progress_2[\"bytes_downloaded\"] >= progress_1[\"bytes_downloaded\"]\n852     assert progress_2[\"layers_total\"] == progress_1[\"layers_total\"]\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 851,
      "line_range": [
        851
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "851     assert progress_2[\"bytes_downloaded\"] >= progress_1[\"bytes_downloaded\"]\n852     assert progress_2[\"layers_total\"] == progress_1[\"layers_total\"]\n853     assert progress_2[\"bytes_total\"] == progress_1[\"bytes_total\"]\n",
      "col_offset": 4,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 852,
      "line_range": [
        852
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "852     assert progress_2[\"layers_total\"] == progress_1[\"layers_total\"]\n853     assert progress_2[\"bytes_total\"] == progress_1[\"bytes_total\"]\n854 \n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 853,
      "line_range": [
        853
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "859     (status, progress_3) = http_client.tenant_secondary_download(tenant_id, wait_ms=20000)\n860     assert status == 200\n861     assert progress_3[\"heatmap_mtime\"] is not None\n",
      "col_offset": 4,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 860,
      "line_range": [
        860
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "860     assert status == 200\n861     assert progress_3[\"heatmap_mtime\"] is not None\n862     assert progress_3[\"layers_total\"] == progress_3[\"layers_downloaded\"]\n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 861,
      "line_range": [
        861
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "861     assert progress_3[\"heatmap_mtime\"] is not None\n862     assert progress_3[\"layers_total\"] == progress_3[\"layers_downloaded\"]\n863     assert progress_3[\"bytes_total\"] == progress_3[\"bytes_downloaded\"]\n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 862,
      "line_range": [
        862
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "862     assert progress_3[\"layers_total\"] == progress_3[\"layers_downloaded\"]\n863     assert progress_3[\"bytes_total\"] == progress_3[\"bytes_downloaded\"]\n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pageserver_secondary.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 863,
      "line_range": [
        863
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "162                 cursor.execute(query)\n163                 assert cursor.fetchone() == result\n164         else:\n",
      "col_offset": 16,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 163,
      "line_range": [
        163
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "165             cursor.execute(query)\n166             assert cursor.fetchone() == result\n167 \n",
      "col_offset": 12,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 166,
      "line_range": [
        166
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "178             )\n179             assert cur.fetchone() == (1,)\n180 \n",
      "col_offset": 12,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 179,
      "line_range": [
        179
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "180 \n181             assert check_buffers(cur) is None\n182             # Ensure all caches required for connection start are correctly\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 181,
      "line_range": [
        181
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "192             )\n193             assert cur.fetchone() == ([True],)\n194 \n",
      "col_offset": 12,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 193,
      "line_range": [
        193
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "200             cur.execute(\"SHOW statement_timeout;\")\n201             assert cur.fetchone() == (\"500ms\",)\n202             assert check_buffers(cur) is None\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 201,
      "line_range": [
        201
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "201             assert cur.fetchone() == (\"500ms\",)\n202             assert check_buffers(cur) is None\n203             exec_may_cancel(\n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 202,
      "line_range": [
        202
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "222             )\n223             assert cur.fetchone() == (256,)\n224 \n",
      "col_offset": 12,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 223,
      "line_range": [
        223
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "270 \n271             assert cur.fetchone() == (1024, 1024, 1025, 2048, 1573376)\n272 \n",
      "col_offset": 12,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 271,
      "line_range": [
        271
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "278 \n279             assert cur.fetchone() == (1024, 1024, 1, 1024, 524800)\n280 \n",
      "col_offset": 12,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_query_cancellation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 279,
      "line_range": [
        279
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "18         stdout = f.read()\n19         assert \"ABORT\" in stdout\n20         assert \"COMMIT\" in stdout\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_waldump.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 19,
      "line_range": [
        19
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "19         assert \"ABORT\" in stdout\n20         assert \"COMMIT\" in stdout\n21 \n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_waldump.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 20,
      "line_range": [
        20
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "51 \n52     assert endpoint.pgdata_dir\n53     wal_path = os.path.join(endpoint.pgdata_dir, \"pg_wal/000000010000000000000001\")\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pg_waldump.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 52,
      "line_range": [
        52
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "42                                 s_cur.execute(\n43                                     \"select * from t where pk=%s\", (random.randrange(1, 2 * pk),)\n44                                 )\n",
      "col_offset": 68,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_physical_replication.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 43,
      "line_range": [
        43
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "38             res = main_cur.fetchone()\n39             assert res is not None\n40             lsn_a = res[0]\n",
      "col_offset": 12,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pitr_gc.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 39,
      "line_range": [
        39
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "45     res = main_cur.fetchone()\n46     assert res is not None\n47 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pitr_gc.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 46,
      "line_range": [
        46
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "69     hundred_cur.execute(\"SELECT count(*) FROM foo\")\n70     assert hundred_cur.fetchone() == (100,)\n71 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pitr_gc.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 70,
      "line_range": [
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "73     main_cur.execute(\"SELECT count(*) FROM foo\")\n74     assert main_cur.fetchone() == (10000,)\n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_pitr_gc.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "18     stdout = Path(f\"{output_prefix}.stdout\")\n19     assert stdout.exists(), \"postgres --version didn't print anything to stdout\"\n20 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_postgres_version.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 19,
      "line_range": [
        19
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "29     match = re.search(pattern, output, re.IGNORECASE)\n30     assert match is not None, f\"Can't parse {output} with {pattern}\"\n31 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_postgres_version.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 30,
      "line_range": [
        30
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "34 \n35     assert (\n36         pg_version.v_prefixed in expected_revisions\n37     ), f\"Released PostgreSQL version `{pg_version.v_prefixed}` doesn't exist in `vendor/revisions.json`, please update it if these changes are intentional\"\n38     msg = f\"Unexpected Postgres {pg_version} version: `{output}`, please update `vendor/revisions.json` if these changes are intentional\"\n",
      "col_offset": 4,
      "end_col_offset": 155,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_postgres_version.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 35,
      "line_range": [
        35,
        36,
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "38     msg = f\"Unexpected Postgres {pg_version} version: `{output}`, please update `vendor/revisions.json` if these changes are intentional\"\n39     assert [version, commit] == expected_revisions[pg_version.v_prefixed], msg\n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_postgres_version.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 39,
      "line_range": [
        39
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "4 import json\n5 import subprocess\n6 import time\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 5,
      "line_range": [
        5
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "26     def query(*args) -> Any:\n27         static_proxy.http_query(\n28             \"SELECT pg_sleep(10);\",\n29             args,\n30             user=\"http_auth\",\n31             password=\"http\",\n32             expected_code=200,\n33         )\n34 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 27,
      "line_range": [
        27,
        28,
        29,
        30,
        31,
        32,
        33
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "51     out = static_proxy.safe_psql(\"select 1\", sslsni=0, options=\"project=generic-project-name\")\n52     assert out[0][0] == 1\n53 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 52,
      "line_range": [
        52
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55     out = static_proxy.safe_psql(\"select 1\", sslsni=0, options=\"endpoint=generic-project-name\")\n56     assert out[0][0] == 1\n57 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "59     out = static_proxy.safe_psql(\"select 42\", host=\"generic-project-name.localtest.me\")\n60     assert out[0][0] == 42\n61 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 60,
      "line_range": [
        60
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "69     user = \"borat\"\n70     password = \"password\"\n71     static_proxy.safe_psql(f\"create role {user} with login password '{password}'\")\n",
      "col_offset": 15,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'password'",
      "line_number": 70,
      "line_range": [
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "75     out = static_proxy.safe_psql(\"select 1\", sslsni=0, user=user, password=magic)\n76     assert out[0][0] == 1\n77 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "79     out = static_proxy.safe_psql(\"select 1\", sslsni=0, user=user, password=magic)\n80     assert out[0][0] == 1\n81 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 80,
      "line_range": [
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "102 \n103     assert psql.stdout is not None\n104     out = (await psql.stdout.read()).decode(\"utf-8\").strip()\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 103,
      "line_range": [
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104     out = (await psql.stdout.read()).decode(\"utf-8\").strip()\n105     assert out == \"42\"\n106 \n",
      "col_offset": 4,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 105,
      "line_range": [
        105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "118     out = static_proxy.safe_psql(\"show proxytest.option\", options=options, sslsni=0)\n119     assert out[0][0] == \"value\"\n120 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 119,
      "line_range": [
        119
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "122     out = static_proxy.safe_psql(\"show proxytest.foo\", options=options, sslsni=0)\n123     assert out[0][0] == \" str\"\n124 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 123,
      "line_range": [
        123
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "126     out = static_proxy.safe_psql(\"show proxytest.option\", options=options)\n127     assert out[0][0] == \"value\"\n128 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 127,
      "line_range": [
        127
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "130     out = static_proxy.safe_psql(\"show proxytest.foo\", options=options)\n131     assert out[0][0] == \" str\"\n132 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 131,
      "line_range": [
        131
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "142     text = str(exprinfo.value).strip()\n143     assert text.find(\"password authentication failed for user 'pinocchio'\") != -1\n144 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 143,
      "line_range": [
        143
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "152     text = str(exprinfo.value).strip()\n153     assert text.find(\"password authentication failed for user 'pinocchio'\") != -1\n154 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 153,
      "line_range": [
        153
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "156     with pytest.raises(psycopg2.Error) as exprinfo:\n157         static_proxy.connect(user=\"pinocchio\", password=\"bad\")\n158     text = str(exprinfo.value).strip()\n",
      "col_offset": 8,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'bad'",
      "line_number": 157,
      "line_range": [
        157
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "158     text = str(exprinfo.value).strip()\n159     assert text.find(\"password authentication failed for user 'pinocchio'\") != -1\n160 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 159,
      "line_range": [
        159
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "161     # Finally, check that the user can connect\n162     with static_proxy.connect(user=\"pinocchio\", password=\"magic\"):\n163         pass\n",
      "col_offset": 9,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'magic'",
      "line_number": 162,
      "line_range": [
        162
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "196                 # Check that proxy has forwarded this parameter.\n197                 assert conn.get_parameter_status(name) == value\n198 \n",
      "col_offset": 16,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 197,
      "line_range": [
        197
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "216     connstr = f\"postgresql://http:http@{static_proxy.domain}:{static_proxy.proxy_port}/postgres\"\n217     response = requests.post(\n218         f\"https://api.localtest.me:{static_proxy.external_http_port}/sql\",\n219         data=json.dumps({\"query\": \"select 42 as answer\", \"params\": []}),\n220         headers={\"Content-Type\": \"application/sql\", \"Neon-Connection-String\": connstr},\n221         verify=str(static_proxy.test_output_dir / \"proxy.crt\"),\n222     )\n223     assert response.status_code == 200, response.text\n",
      "col_offset": 15,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 217,
      "line_range": [
        217,
        218,
        219,
        220,
        221,
        222
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "222     )\n223     assert response.status_code == 200, response.text\n224     rows = response.json()[\"rows\"]\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 223,
      "line_range": [
        223
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "224     rows = response.json()[\"rows\"]\n225     assert rows == [{\"answer\": 42}]\n226 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 225,
      "line_range": [
        225
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "233         connstr = f\"postgresql://http:http@{static_proxy.domain}:{static_proxy.proxy_port}/postgres\"\n234         response = requests.post(\n235             f\"https://{static_proxy.domain}:{static_proxy.external_http_port}/sql\",\n236             data=json.dumps({\"query\": sql, \"params\": params}),\n237             headers={\"Content-Type\": \"application/sql\", \"Neon-Connection-String\": connstr},\n238             verify=str(static_proxy.test_output_dir / \"proxy.crt\"),\n239         )\n240         assert response.status_code == 200, response.text\n",
      "col_offset": 19,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 234,
      "line_range": [
        234,
        235,
        236,
        237,
        238,
        239
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "239         )\n240         assert response.status_code == 200, response.text\n241         return response.json()\n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 240,
      "line_range": [
        240
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "243     rows = q(\"select 42 as answer\")[\"rows\"]\n244     assert rows == [{\"answer\": 42}]\n245 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 244,
      "line_range": [
        244
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "246     rows = q(\"select $1 as answer\", [42])[\"rows\"]\n247     assert rows == [{\"answer\": \"42\"}]\n248 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 247,
      "line_range": [
        247
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "249     rows = q(\"select $1 * 1 as answer\", [42])[\"rows\"]\n250     assert rows == [{\"answer\": 42}]\n251 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 250,
      "line_range": [
        250
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "252     rows = q(\"select $1::int[] as answer\", [[1, 2, 3]])[\"rows\"]\n253     assert rows == [{\"answer\": [1, 2, 3]}]\n254 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 253,
      "line_range": [
        253
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "255     rows = q(\"select $1::json->'a' as answer\", [{\"a\": {\"b\": 42}}])[\"rows\"]\n256     assert rows == [{\"answer\": {\"b\": 42}}]\n257 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 256,
      "line_range": [
        256
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "258     rows = q(\"select $1::jsonb[] as answer\", [[{}]])[\"rows\"]\n259     assert rows == [{\"answer\": [{}]}]\n260 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 259,
      "line_range": [
        259
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "261     rows = q(\"select $1::jsonb[] as answer\", [[{\"foo\": 1}, {\"bar\": 2}]])[\"rows\"]\n262     assert rows == [{\"answer\": [{\"foo\": 1}, {\"bar\": 2}]}]\n263 \n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 262,
      "line_range": [
        262
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "264     rows = q(\"select * from pg_class limit 1\")[\"rows\"]\n265     assert len(rows) == 1\n266 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 265,
      "line_range": [
        265
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "267     res = q(\"create table t(id serial primary key, val int)\")\n268     assert res[\"command\"] == \"CREATE\"\n269     assert res[\"rowCount\"] is None\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 268,
      "line_range": [
        268
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "268     assert res[\"command\"] == \"CREATE\"\n269     assert res[\"rowCount\"] is None\n270 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 269,
      "line_range": [
        269
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "271     res = q(\"insert into t(val) values (10), (20), (30) returning id\")\n272     assert res[\"command\"] == \"INSERT\"\n273     assert res[\"rowCount\"] == 3\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 272,
      "line_range": [
        272
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "272     assert res[\"command\"] == \"INSERT\"\n273     assert res[\"rowCount\"] == 3\n274     assert res[\"rows\"] == [{\"id\": 1}, {\"id\": 2}, {\"id\": 3}]\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 273,
      "line_range": [
        273
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "273     assert res[\"rowCount\"] == 3\n274     assert res[\"rows\"] == [{\"id\": 1}, {\"id\": 2}, {\"id\": 3}]\n275 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 274,
      "line_range": [
        274
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "276     res = q(\"select * from t\")\n277     assert res[\"command\"] == \"SELECT\"\n278     assert res[\"rowCount\"] == 3\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 277,
      "line_range": [
        277
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "277     assert res[\"command\"] == \"SELECT\"\n278     assert res[\"rowCount\"] == 3\n279 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 278,
      "line_range": [
        278
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "280     res = q(\"drop table t\")\n281     assert res[\"command\"] == \"DROP\"\n282     assert res[\"rowCount\"] is None\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 281,
      "line_range": [
        281
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "281     assert res[\"command\"] == \"DROP\"\n282     assert res[\"rowCount\"] is None\n283 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 282,
      "line_range": [
        282
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "296         connstr = f\"postgresql://http:http@{static_proxy.domain}:{static_proxy.proxy_port}/{urllib.parse.quote(db)}\"\n297         response = requests.post(\n298             f\"https://{static_proxy.domain}:{static_proxy.external_http_port}/sql\",\n299             data=json.dumps({\"query\": sql, \"params\": params}),\n300             headers={\"Content-Type\": \"application/sql\", \"Neon-Connection-String\": connstr},\n301             verify=str(static_proxy.test_output_dir / \"proxy.crt\"),\n302         )\n303         assert response.status_code == 200, response.text\n",
      "col_offset": 19,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 297,
      "line_range": [
        297,
        298,
        299,
        300,
        301,
        302
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "302         )\n303         assert response.status_code == 200, response.text\n304         return response.json()\n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 303,
      "line_range": [
        303
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "306     rows = q(\"select 42 as answer\")[\"rows\"]\n307     assert rows == [{\"answer\": 42}]\n308 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 307,
      "line_range": [
        307
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "317         )\n318         response = requests.post(\n319             f\"https://{static_proxy.domain}:{static_proxy.external_http_port}/sql\",\n320             data=json.dumps({\"query\": sql, \"params\": params}),\n321             headers={\n322                 \"Content-Type\": \"application/sql\",\n323                 \"Neon-Connection-String\": connstr,\n324                 \"Neon-Raw-Text-Output\": \"true\" if raw_text else \"false\",\n325                 \"Neon-Array-Mode\": \"true\" if array_mode else \"false\",\n326             },\n327             verify=str(static_proxy.test_output_dir / \"proxy.crt\"),\n328         )\n329         assert response.status_code == 200\n",
      "col_offset": 19,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 318,
      "line_range": [
        318,
        319,
        320,
        321,
        322,
        323,
        324,
        325,
        326,
        327,
        328
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "328         )\n329         assert response.status_code == 200\n330         return response.json()\n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 329,
      "line_range": [
        329
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "332     rows = q(\"select 1 as n, 'a' as s, '{1,2,3}'::int4[] as arr\", False, False)[\"rows\"]\n333     assert rows == [{\"arr\": [1, 2, 3], \"n\": 1, \"s\": \"a\"}]\n334 \n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 333,
      "line_range": [
        333
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "335     rows = q(\"select 1 as n, 'a' as s, '{1,2,3}'::int4[] as arr\", False, True)[\"rows\"]\n336     assert rows == [[1, \"a\", [1, 2, 3]]]\n337 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 336,
      "line_range": [
        336
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "338     rows = q(\"select 1 as n, 'a' as s, '{1,2,3}'::int4[] as arr\", True, False)[\"rows\"]\n339     assert rows == [{\"arr\": \"{1,2,3}\", \"n\": \"1\", \"s\": \"a\"}]\n340 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 339,
      "line_range": [
        339
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "341     rows = q(\"select 1 as n, 'a' as s, '{1,2,3}'::int4[] as arr\", True, True)[\"rows\"]\n342     assert rows == [[\"1\", \"a\", \"{1,2,3}\"]]\n343 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 342,
      "line_range": [
        342
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "353         connstr = f\"postgresql://http:http@{static_proxy.domain}:{static_proxy.proxy_port}/postgres\"\n354         response = requests.post(\n355             f\"https://{static_proxy.domain}:{static_proxy.external_http_port}/sql\",\n356             data=json.dumps(\n357                 {\"queries\": list(map(lambda x: {\"query\": x[0], \"params\": x[1] or []}, queries))}\n358             ),\n359             headers={\n360                 \"Content-Type\": \"application/sql\",\n361                 \"Neon-Connection-String\": connstr,\n362                 \"Neon-Batch-Isolation-Level\": \"Serializable\",\n363                 \"Neon-Batch-Read-Only\": \"true\" if read_only else \"false\",\n364                 \"Neon-Batch-Deferrable\": \"true\" if deferrable else \"false\",\n365             },\n366             verify=str(static_proxy.test_output_dir / \"proxy.crt\"),\n367         )\n368         assert response.status_code == 200\n",
      "col_offset": 19,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 354,
      "line_range": [
        354,
        355,
        356,
        357,
        358,
        359,
        360,
        361,
        362,
        363,
        364,
        365,
        366,
        367
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "367         )\n368         assert response.status_code == 200\n369         return response.json()[\"results\"], response.headers\n",
      "col_offset": 8,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 368,
      "line_range": [
        368
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "385 \n386     assert headers[\"Neon-Batch-Isolation-Level\"] == \"Serializable\"\n387     assert \"Neon-Batch-Read-Only\" not in headers\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 386,
      "line_range": [
        386
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "386     assert headers[\"Neon-Batch-Isolation-Level\"] == \"Serializable\"\n387     assert \"Neon-Batch-Read-Only\" not in headers\n388     assert \"Neon-Batch-Deferrable\" not in headers\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 387,
      "line_range": [
        387
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "387     assert \"Neon-Batch-Read-Only\" not in headers\n388     assert \"Neon-Batch-Deferrable\" not in headers\n389 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 388,
      "line_range": [
        388
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "389 \n390     assert result[0][\"rows\"] == [{\"answer\": 42}]\n391     assert result[1][\"rows\"] == [{\"answer\": \"42\"}]\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 390,
      "line_range": [
        390
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "390     assert result[0][\"rows\"] == [{\"answer\": 42}]\n391     assert result[1][\"rows\"] == [{\"answer\": \"42\"}]\n392     assert result[2][\"rows\"] == [{\"answer\": 42}]\n",
      "col_offset": 4,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 391,
      "line_range": [
        391
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "391     assert result[1][\"rows\"] == [{\"answer\": \"42\"}]\n392     assert result[2][\"rows\"] == [{\"answer\": 42}]\n393     assert result[3][\"rows\"] == [{\"answer\": [1, 2, 3]}]\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 392,
      "line_range": [
        392
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "392     assert result[2][\"rows\"] == [{\"answer\": 42}]\n393     assert result[3][\"rows\"] == [{\"answer\": [1, 2, 3]}]\n394     assert result[4][\"rows\"] == [{\"answer\": {\"b\": 42}}]\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 393,
      "line_range": [
        393
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "393     assert result[3][\"rows\"] == [{\"answer\": [1, 2, 3]}]\n394     assert result[4][\"rows\"] == [{\"answer\": {\"b\": 42}}]\n395     assert len(result[5][\"rows\"]) == 1\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 394,
      "line_range": [
        394
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "394     assert result[4][\"rows\"] == [{\"answer\": {\"b\": 42}}]\n395     assert len(result[5][\"rows\"]) == 1\n396     res = result[6]\n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 395,
      "line_range": [
        395
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "396     res = result[6]\n397     assert res[\"command\"] == \"CREATE\"\n398     assert res[\"rowCount\"] is None\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 397,
      "line_range": [
        397
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "397     assert res[\"command\"] == \"CREATE\"\n398     assert res[\"rowCount\"] is None\n399     res = result[7]\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 398,
      "line_range": [
        398
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "399     res = result[7]\n400     assert res[\"command\"] == \"INSERT\"\n401     assert res[\"rowCount\"] == 3\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 400,
      "line_range": [
        400
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "400     assert res[\"command\"] == \"INSERT\"\n401     assert res[\"rowCount\"] == 3\n402     assert res[\"rows\"] == [{\"id\": 1}, {\"id\": 2}, {\"id\": 3}]\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 401,
      "line_range": [
        401
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "401     assert res[\"rowCount\"] == 3\n402     assert res[\"rows\"] == [{\"id\": 1}, {\"id\": 2}, {\"id\": 3}]\n403     res = result[8]\n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 402,
      "line_range": [
        402
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "403     res = result[8]\n404     assert res[\"command\"] == \"SELECT\"\n405     assert res[\"rowCount\"] == 3\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 404,
      "line_range": [
        404
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "404     assert res[\"command\"] == \"SELECT\"\n405     assert res[\"rowCount\"] == 3\n406     res = result[9]\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 405,
      "line_range": [
        405
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "406     res = result[9]\n407     assert res[\"command\"] == \"DROP\"\n408     assert res[\"rowCount\"] is None\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 407,
      "line_range": [
        407
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "407     assert res[\"command\"] == \"DROP\"\n408     assert res[\"rowCount\"] is None\n409     assert len(result) == 10\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 408,
      "line_range": [
        408
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "408     assert res[\"rowCount\"] is None\n409     assert len(result) == 10\n410 \n",
      "col_offset": 4,
      "end_col_offset": 28,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 409,
      "line_range": [
        409
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "417     )\n418     assert headers[\"Neon-Batch-Isolation-Level\"] == \"Serializable\"\n419     assert headers[\"Neon-Batch-Read-Only\"] == \"true\"\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 418,
      "line_range": [
        418
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "418     assert headers[\"Neon-Batch-Isolation-Level\"] == \"Serializable\"\n419     assert headers[\"Neon-Batch-Read-Only\"] == \"true\"\n420     assert headers[\"Neon-Batch-Deferrable\"] == \"true\"\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 419,
      "line_range": [
        419
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "419     assert headers[\"Neon-Batch-Read-Only\"] == \"true\"\n420     assert headers[\"Neon-Batch-Deferrable\"] == \"true\"\n421 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 420,
      "line_range": [
        420
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "421 \n422     assert result[0][\"rows\"] == [{\"answer\": 42}]\n423 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 422,
      "line_range": [
        422
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "428     connstr = f\"postgresql://http:http@{static_proxy.domain}:{static_proxy.proxy_port}/postgres\"\n429     response = requests.post(\n430         f\"https://{static_proxy.domain}:{static_proxy.external_http_port}/sql\",\n431         data=json.dumps(\n432             {\n433                 \"queries\": [\n434                     {\"query\": \"select $1 as answer\", \"params\": [42], \"arrayMode\": True},\n435                     {\"query\": \"select $1 as answer\", \"params\": [42], \"arrayMode\": False},\n436                 ]\n437             }\n438         ),\n439         headers={\n440             \"Content-Type\": \"application/sql\",\n441             \"Neon-Connection-String\": connstr,\n442             \"Neon-Batch-Isolation-Level\": \"Serializable\",\n443             \"Neon-Batch-Read-Only\": \"false\",\n444             \"Neon-Batch-Deferrable\": \"false\",\n445         },\n446         verify=str(static_proxy.test_output_dir / \"proxy.crt\"),\n447     )\n448     assert response.status_code == 200\n",
      "col_offset": 15,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 400,
        "link": "https://cwe.mitre.org/data/definitions/400.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Call to requests without timeout",
      "line_number": 429,
      "line_range": [
        429,
        430,
        431,
        432,
        433,
        434,
        435,
        436,
        437,
        438,
        439,
        440,
        441,
        442,
        443,
        444,
        445,
        446,
        447
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b113_request_without_timeout.html",
      "test_id": "B113",
      "test_name": "request_without_timeout"
    },
    {
      "code": "447     )\n448     assert response.status_code == 200\n449     results = response.json()[\"results\"]\n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 448,
      "line_range": [
        448
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "450 \n451     assert results[0][\"rowAsArray\"]\n452     assert results[0][\"rows\"] == [[\"42\"]]\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 451,
      "line_range": [
        451
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "451     assert results[0][\"rowAsArray\"]\n452     assert results[0][\"rows\"] == [[\"42\"]]\n453 \n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 452,
      "line_range": [
        452
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "453 \n454     assert not results[1][\"rowAsArray\"]\n455     assert results[1][\"rows\"] == [{\"answer\": \"42\"}]\n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 454,
      "line_range": [
        454
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "454     assert not results[1][\"rowAsArray\"]\n455     assert results[1][\"rows\"] == [{\"answer\": \"42\"}]\n456 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 455,
      "line_range": [
        455
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "475     rows = get_pid(200, \"http\")[\"rows\"]\n476     assert rows == [{\"pid\": pid1}]\n477 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 476,
      "line_range": [
        476
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "481     res = get_pid(400, \"foobar\")\n482     assert \"password authentication failed for user\" in res[\"message\"]\n483 \n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 482,
      "line_range": [
        482
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "487     rows = get_pid(200, \"http2\")[\"rows\"]\n488     assert rows == [{\"pid\": pid1}]\n489 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 488,
      "line_range": [
        488
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "493     res = get_pid(400, \"http\", user=\"http_auth2\")\n494     assert \"password authentication failed for user\" in res[\"message\"]\n495 \n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 494,
      "line_range": [
        494
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "499 \n500     static_proxy.http_query(\n501         \"select 1\",\n502         [],\n503         user=\"http+auth$$\",\n504         password=\"%+$^&*@!\",\n505         expected_code=200,\n506     )\n507 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: '%+$^&*@!'",
      "line_number": 500,
      "line_range": [
        500,
        501,
        502,
        503,
        504,
        505,
        506
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "514     def query(status: int, query: str, *args) -> Any:\n515         static_proxy.http_query(\n516             query,\n517             args,\n518             user=\"http_auth\",\n519             password=\"http\",\n520             expected_code=status,\n521         )\n522 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 515,
      "line_range": [
        515,
        516,
        517,
        518,
        519,
        520,
        521
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "531     def query(status: int, query: str) -> Any:\n532         return static_proxy.http_query(\n533             query,\n534             [],\n535             user=\"http_auth2\",\n536             password=\"http\",\n537             expected_code=status,\n538         )\n539 \n",
      "col_offset": 15,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 532,
      "line_range": [
        532,
        533,
        534,
        535,
        536,
        537,
        538
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "543     pid2 = query(200, GET_CONNECTION_PID_QUERY)[\"rows\"][0][\"pid\"]\n544     assert pid1 != pid2\n545 \n",
      "col_offset": 4,
      "end_col_offset": 23,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 544,
      "line_range": [
        544
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "553     def query(status: int, query: str) -> Any:\n554         return static_proxy.http_query(\n555             query,\n556             [],\n557             user=\"http_auth\",\n558             password=\"http\",\n559             expected_code=status,\n560         )\n561 \n",
      "col_offset": 15,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 554,
      "line_range": [
        554,
        555,
        556,
        557,
        558,
        559,
        560
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "566     )\n567     assert \"response is too large (max is 10485760 bytes)\" in response[\"message\"]\n568 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 567,
      "line_range": [
        567
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "575     def query(status: int, query: str) -> Any:\n576         return static_proxy.http_query(\n577             query,\n578             [],\n579             user=\"http_auth\",\n580             password=\"http\",\n581             expected_code=status,\n582         )\n583 \n",
      "col_offset": 15,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 576,
      "line_range": [
        576,
        577,
        578,
        579,
        580,
        581,
        582
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "587     )\n588     assert response[\"rows\"][0][\"data\"] == [\"foo\", \"bar\", \"baz\"]\n589 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 588,
      "line_range": [
        588
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "594 \n595     resp = await static_proxy.http2_query(\n596         \"select 42 as answer\", [], user=\"http\", password=\"http\", expected_code=200\n597     )\n598     assert resp[\"rows\"] == [{\"answer\": 42}]\n",
      "col_offset": 17,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 595,
      "line_range": [
        595,
        596,
        597
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "597     )\n598     assert resp[\"rows\"] == [{\"answer\": 42}]\n599 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 598,
      "line_range": [
        598
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "613         # Timeout and cancel the request on the client side before the query completes.\n614         static_proxy.http_query(\n615             query,\n616             [static_proxy.http_timeout_seconds - 1, 1],\n617             user=\"http\",\n618             password=\"http\",\n619             timeout=2,\n620         )\n621     except requests.exceptions.ReadTimeout:\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 614,
      "line_range": [
        614,
        615,
        616,
        617,
        618,
        619,
        620
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "626 \n627     res = static_proxy.http_query(query, [1, 1], user=\"http\", password=\"http\", expected_code=200)\n628     assert res[\"command\"] == \"INSERT\", \"HTTP query should insert\"\n",
      "col_offset": 10,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 627,
      "line_range": [
        627
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "627     res = static_proxy.http_query(query, [1, 1], user=\"http\", password=\"http\", expected_code=200)\n628     assert res[\"command\"] == \"INSERT\", \"HTTP query should insert\"\n629     assert res[\"rowCount\"] == 1, \"HTTP query should insert\"\n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 628,
      "line_range": [
        628
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "628     assert res[\"command\"] == \"INSERT\", \"HTTP query should insert\"\n629     assert res[\"rowCount\"] == 1, \"HTTP query should insert\"\n630 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 629,
      "line_range": [
        629
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "630 \n631     res = static_proxy.http_query(query, [0, 1], user=\"http\", password=\"http\", expected_code=400)\n632     assert (\n",
      "col_offset": 10,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 631,
      "line_range": [
        631
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "631     res = static_proxy.http_query(query, [0, 1], user=\"http\", password=\"http\", expected_code=400)\n632     assert (\n633         \"duplicate key value violates unique constraint\" in res[\"message\"]\n634     ), \"HTTP query should conflict\"\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 632,
      "line_range": [
        632,
        633,
        634
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "17     vanilla_pg.safe_psql(\n18         f\"INSERT INTO {TABLE_NAME} (endpoint_id, allowed_ips) VALUES ('private-project', '8.8.8.8')\"\n19     )\n",
      "col_offset": 10,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 18,
      "line_range": [
        18
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "21     vanilla_pg.safe_psql(\n22         f\"INSERT INTO {TABLE_NAME} (endpoint_id, allowed_ips) VALUES ('generic-project', '::1,127.0.0.1')\"\n23     )\n",
      "col_offset": 10,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 22,
      "line_range": [
        22
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "28         text = str(exprinfo.value).strip()\n29         assert \"not allowed to connect\" in text\n30 \n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 29,
      "line_range": [
        29
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "41     out = static_proxy.safe_psql(query=\"select 1\", sslsni=0, options=\"project=generic-project\")\n42     assert out[0][0] == 1\n43 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 42,
      "line_range": [
        42
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "45     out = static_proxy.safe_psql(query=\"select 1\", sslsni=0, options=\"endpoint=generic-project\")\n46     assert out[0][0] == 1\n47 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 46,
      "line_range": [
        46
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "49     out = static_proxy.safe_psql(query=\"select 1\", host=\"generic-project.localtest.me\")\n50     assert out[0][0] == 1\n51 \n",
      "col_offset": 4,
      "end_col_offset": 25,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 50,
      "line_range": [
        50
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "58     vanilla_pg.safe_psql(\n59         f\"INSERT INTO {TABLE_NAME} (endpoint_id, allowed_ips) VALUES ('proxy', '8.8.8.8')\"\n60     )\n",
      "col_offset": 10,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 59,
      "line_range": [
        59
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "62     def query(status: int, query: str, *args):\n63         static_proxy.http_query(\n64             query,\n65             args,\n66             user=\"http_auth\",\n67             password=\"http\",\n68             expected_code=status,\n69         )\n70 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'http'",
      "line_number": 63,
      "line_range": [
        63,
        64,
        65,
        66,
        67,
        68,
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b106_hardcoded_password_funcarg.html",
      "test_id": "B106",
      "test_name": "hardcoded_password_funcarg"
    },
    {
      "code": "73     vanilla_pg.safe_psql(\n74         f\"UPDATE {TABLE_NAME} SET allowed_ips = '8.8.8.8,127.0.0.1' WHERE endpoint_id = 'proxy'\"\n75     )\n",
      "col_offset": 10,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_allowed_ips.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "28     for event in events:\n29         assert event[\"metric\"] == \"proxy_io_bytes_per_client\"\n30         assert event[\"endpoint_id\"] == \"test_endpoint_id\"\n",
      "col_offset": 8,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 29,
      "line_range": [
        29
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "29         assert event[\"metric\"] == \"proxy_io_bytes_per_client\"\n30         assert event[\"endpoint_id\"] == \"test_endpoint_id\"\n31         assert event[\"value\"] >= 0\n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 30,
      "line_range": [
        30
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "30         assert event[\"endpoint_id\"] == \"test_endpoint_id\"\n31         assert event[\"value\"] >= 0\n32         assert event[\"stop_time\"] >= event[\"start_time\"]\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 31,
      "line_range": [
        31
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "31         assert event[\"value\"] >= 0\n32         assert event[\"stop_time\"] >= event[\"start_time\"]\n33 \n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 32,
      "line_range": [
        32
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "94 \n95     assert psql.stdout is not None\n96     out = (await psql.stdout.read()).decode(\"utf-8\").strip()\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 95,
      "line_range": [
        95
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "96     out = (await psql.stdout.read()).decode(\"utf-8\").strip()\n97     assert out == \"42\"\n98 \n",
      "col_offset": 4,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 97,
      "line_range": [
        97
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "110 \n111     assert psql.stdout is not None\n112     out = (await psql.stdout.read()).decode(\"utf-8\").strip()\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 111,
      "line_range": [
        111
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "112     out = (await psql.stdout.read()).decode(\"utf-8\").strip()\n113     assert out == \"42\"\n114 \n",
      "col_offset": 4,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_metric_collection.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 113,
      "line_range": [
        113
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "14     user = \"ws_auth\"\n15     password = \"ws\"\n16 \n",
      "col_offset": 15,
      "end_col_offset": 19,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'ws'",
      "line_number": 15,
      "line_range": [
        15
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "42         startup_response = await websocket.recv()\n43         assert isinstance(startup_response, bytes)\n44         assert startup_response[0:1] == b\"R\", \"should be authentication message\"\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 43,
      "line_range": [
        43
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "43         assert isinstance(startup_response, bytes)\n44         assert startup_response[0:1] == b\"R\", \"should be authentication message\"\n45         assert startup_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 44,
      "line_range": [
        44
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44         assert startup_response[0:1] == b\"R\", \"should be authentication message\"\n45         assert startup_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n46         assert startup_response[5:9] == b\"\\x00\\x00\\x00\\x03\", \"should be cleartext\"\n",
      "col_offset": 8,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "45         assert startup_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n46         assert startup_response[5:9] == b\"\\x00\\x00\\x00\\x03\", \"should be cleartext\"\n47 \n",
      "col_offset": 8,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 46,
      "line_range": [
        46
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "52         auth_response = await websocket.recv()\n53         assert isinstance(auth_response, bytes)\n54         assert auth_response[0:1] == b\"R\", \"should be authentication message\"\n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 53,
      "line_range": [
        53
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "53         assert isinstance(auth_response, bytes)\n54         assert auth_response[0:1] == b\"R\", \"should be authentication message\"\n55         assert auth_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n",
      "col_offset": 8,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 54,
      "line_range": [
        54
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "54         assert auth_response[0:1] == b\"R\", \"should be authentication message\"\n55         assert auth_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n56         assert auth_response[5:9] == b\"\\x00\\x00\\x00\\x00\", \"should be authenticated\"\n",
      "col_offset": 8,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 55,
      "line_range": [
        55
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55         assert auth_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n56         assert auth_response[5:9] == b\"\\x00\\x00\\x00\\x00\", \"should be authenticated\"\n57 \n",
      "col_offset": 8,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "62         query_response = await websocket.recv()\n63         assert isinstance(query_response, bytes)\n64         # 'T\\x00\\x00\\x00!\\x00\\x01?column?\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x17\\x00\\x04\\xff\\xff\\xff\\xff\\x00\\x00'\n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 63,
      "line_range": [
        63
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "68 \n69         assert query_response[0:1] == b\"T\", \"should be row description message\"\n70         row_description_len = int.from_bytes(query_response[1:5], byteorder=\"big\") + 1\n",
      "col_offset": 8,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 69,
      "line_range": [
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "74         )\n75         assert row_description[5:7] == b\"\\x00\\x01\", \"should have 1 column\"\n76         assert row_description[7:16] == b\"?column?\\0\", \"column should be named ?column?\"\n",
      "col_offset": 8,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 75,
      "line_range": [
        75
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75         assert row_description[5:7] == b\"\\x00\\x01\", \"should have 1 column\"\n76         assert row_description[7:16] == b\"?column?\\0\", \"column should be named ?column?\"\n77         assert row_description[22:26] == b\"\\x00\\x00\\x00\\x17\", \"column should be an int4\"\n",
      "col_offset": 8,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "76         assert row_description[7:16] == b\"?column?\\0\", \"column should be named ?column?\"\n77         assert row_description[22:26] == b\"\\x00\\x00\\x00\\x17\", \"column should be an int4\"\n78 \n",
      "col_offset": 8,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 77,
      "line_range": [
        77
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "78 \n79         assert query_response[0:1] == b\"D\", \"should be data row message\"\n80         data_row_len = int.from_bytes(query_response[1:5], byteorder=\"big\") + 1\n",
      "col_offset": 8,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 79,
      "line_range": [
        79
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "81         data_row, query_response = query_response[:data_row_len], query_response[data_row_len:]\n82         assert (\n83             data_row == b\"D\\x00\\x00\\x00\\x0b\\x00\\x01\\x00\\x00\\x00\\x011\"\n84         ), \"should contain 1 column with text value 1\"\n85 \n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 82,
      "line_range": [
        82,
        83,
        84
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "85 \n86         assert query_response[0:1] == b\"C\", \"should be command complete message\"\n87         command_complete_len = int.from_bytes(query_response[1:5], byteorder=\"big\") + 1\n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 86,
      "line_range": [
        86
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91         )\n92         assert command_complete == b\"C\\x00\\x00\\x00\\x0dSELECT 1\\0\"\n93 \n",
      "col_offset": 8,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "93 \n94         assert query_response[0:6] == b\"Z\\x00\\x00\\x00\\x05I\", \"should be ready for query (idle)\"\n95 \n",
      "col_offset": 8,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "109     user = \"ws_auth\"\n110     password = \"ws\"\n111 \n",
      "col_offset": 15,
      "end_col_offset": 19,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'ws'",
      "line_number": 110,
      "line_range": [
        110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "150         startup_response = await websocket.recv()\n151         assert isinstance(startup_response, bytes)\n152         assert startup_response[0:1] == b\"R\", \"should be authentication message\"\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 151,
      "line_range": [
        151
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "151         assert isinstance(startup_response, bytes)\n152         assert startup_response[0:1] == b\"R\", \"should be authentication message\"\n153         assert startup_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 152,
      "line_range": [
        152
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "152         assert startup_response[0:1] == b\"R\", \"should be authentication message\"\n153         assert startup_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n154         assert startup_response[5:9] == b\"\\x00\\x00\\x00\\x03\", \"should be cleartext\"\n",
      "col_offset": 8,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 153,
      "line_range": [
        153
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "153         assert startup_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n154         assert startup_response[5:9] == b\"\\x00\\x00\\x00\\x03\", \"should be cleartext\"\n155 \n",
      "col_offset": 8,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 154,
      "line_range": [
        154
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "156         auth_response = await websocket.recv()\n157         assert isinstance(auth_response, bytes)\n158         assert auth_response[0:1] == b\"R\", \"should be authentication message\"\n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 157,
      "line_range": [
        157
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "157         assert isinstance(auth_response, bytes)\n158         assert auth_response[0:1] == b\"R\", \"should be authentication message\"\n159         assert auth_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n",
      "col_offset": 8,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 158,
      "line_range": [
        158
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "158         assert auth_response[0:1] == b\"R\", \"should be authentication message\"\n159         assert auth_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n160         assert auth_response[5:9] == b\"\\x00\\x00\\x00\\x00\", \"should be authenticated\"\n",
      "col_offset": 8,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 159,
      "line_range": [
        159
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "159         assert auth_response[1:5] == b\"\\x00\\x00\\x00\\x08\", \"should be 8 bytes long message\"\n160         assert auth_response[5:9] == b\"\\x00\\x00\\x00\\x00\", \"should be authenticated\"\n161 \n",
      "col_offset": 8,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 160,
      "line_range": [
        160
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "162         query_response = await websocket.recv()\n163         assert isinstance(query_response, bytes)\n164         # 'T\\x00\\x00\\x00!\\x00\\x01?column?\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x17\\x00\\x04\\xff\\xff\\xff\\xff\\x00\\x00'\n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 163,
      "line_range": [
        163
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "168 \n169         assert query_response[0:1] == b\"T\", \"should be row description message\"\n170         row_description_len = int.from_bytes(query_response[1:5], byteorder=\"big\") + 1\n",
      "col_offset": 8,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 169,
      "line_range": [
        169
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "174         )\n175         assert row_description[5:7] == b\"\\x00\\x01\", \"should have 1 column\"\n176         assert row_description[7:16] == b\"?column?\\0\", \"column should be named ?column?\"\n",
      "col_offset": 8,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 175,
      "line_range": [
        175
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "175         assert row_description[5:7] == b\"\\x00\\x01\", \"should have 1 column\"\n176         assert row_description[7:16] == b\"?column?\\0\", \"column should be named ?column?\"\n177         assert row_description[22:26] == b\"\\x00\\x00\\x00\\x17\", \"column should be an int4\"\n",
      "col_offset": 8,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 176,
      "line_range": [
        176
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "176         assert row_description[7:16] == b\"?column?\\0\", \"column should be named ?column?\"\n177         assert row_description[22:26] == b\"\\x00\\x00\\x00\\x17\", \"column should be an int4\"\n178 \n",
      "col_offset": 8,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 177,
      "line_range": [
        177
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "178 \n179         assert query_response[0:1] == b\"D\", \"should be data row message\"\n180         data_row_len = int.from_bytes(query_response[1:5], byteorder=\"big\") + 1\n",
      "col_offset": 8,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 179,
      "line_range": [
        179
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "181         data_row, query_response = query_response[:data_row_len], query_response[data_row_len:]\n182         assert (\n183             data_row == b\"D\\x00\\x00\\x00\\x0b\\x00\\x01\\x00\\x00\\x00\\x011\"\n184         ), \"should contain 1 column with text value 1\"\n185 \n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 182,
      "line_range": [
        182,
        183,
        184
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "185 \n186         assert query_response[0:1] == b\"C\", \"should be command complete message\"\n187         command_complete_len = int.from_bytes(query_response[1:5], byteorder=\"big\") + 1\n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 186,
      "line_range": [
        186
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "191         )\n192         assert command_complete == b\"C\\x00\\x00\\x00\\x0dSELECT 1\\0\"\n193 \n",
      "col_offset": 8,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "193 \n194         assert query_response[0:6] == b\"Z\\x00\\x00\\x00\\x05I\", \"should be ready for query (idle)\"\n195 \n",
      "col_offset": 8,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_proxy_websockets.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 194,
      "line_range": [
        194
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "31             first = c.fetchone()\n32             assert first is not None\n33 \n",
      "col_offset": 12,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 32,
      "line_range": [
        32
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "39 \n40             assert first != second, \"Failed to update page\"\n41 \n",
      "col_offset": 12,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 40,
      "line_range": [
        40
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44             cache_entries = query_scalar(\n45                 c, f\"select count(*) from pg_buffercache where relfilenode = {relfilenode}\"\n46             )\n",
      "col_offset": 21,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "46             )\n47             assert cache_entries > 0, \"No buffers cached for the test relation\"\n48 \n",
      "col_offset": 12,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "49             c.execute(\n50                 f\"select reltablespace, reldatabase, relfilenode from pg_buffercache where relfilenode = {relfilenode}\"\n51             )\n",
      "col_offset": 18,
      "end_col_offset": 105,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 50,
      "line_range": [
        50
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "52             reln = c.fetchone()\n53             assert reln is not None\n54 \n",
      "col_offset": 12,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 53,
      "line_range": [
        53
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "59             cache_entries = query_scalar(\n60                 c, f\"select count(*) from pg_buffercache where relfilenode = {relfilenode}\"\n61             )\n",
      "col_offset": 21,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 60,
      "line_range": [
        60
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "61             )\n62             assert cache_entries == 0, \"Failed to clear buffer cache\"\n63 \n",
      "col_offset": 12,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "66             c.execute(\n67                 f\"select lsn, lower, upper from page_header(get_raw_page_at_lsn('foo', 'main', 0, '{first[0]}', NULL))\"\n68             )\n",
      "col_offset": 18,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 67,
      "line_range": [
        67
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "69             direct_first = c.fetchone()\n70             assert first == direct_first, \"Failed fetch page at historic lsn\"\n71 \n",
      "col_offset": 12,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 70,
      "line_range": [
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "72             cache_entries = query_scalar(\n73                 c, f\"select count(*) from pg_buffercache where relfilenode = {relfilenode}\"\n74             )\n",
      "col_offset": 21,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 73,
      "line_range": [
        73
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "74             )\n75             assert cache_entries == 0, \"relation buffers detected after invalidation\"\n76 \n",
      "col_offset": 12,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 75,
      "line_range": [
        75
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "82             direct_latest = c.fetchone()\n83             assert second == direct_latest, \"Failed fetch page at latest lsn\"\n84 \n",
      "col_offset": 12,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 83,
      "line_range": [
        83
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "85             cache_entries = query_scalar(\n86                 c, f\"select count(*) from pg_buffercache where relfilenode = {relfilenode}\"\n87             )\n",
      "col_offset": 21,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 86,
      "line_range": [
        86
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "87             )\n88             assert cache_entries == 0, \"relation buffers detected after invalidation\"\n89 \n",
      "col_offset": 12,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 88,
      "line_range": [
        88
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "94             c.execute(\n95                 f\"select lsn, lower, upper from page_header(get_raw_page_at_lsn({reln[0]}, {reln[1]}, {reln[2]}, 0, 0, '{first[0]}', NULL))\"\n96             )\n",
      "col_offset": 18,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 95,
      "line_range": [
        95
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "97             direct_first = c.fetchone()\n98             assert first == direct_first, \"Failed fetch page at historic lsn using oid\"\n99 \n",
      "col_offset": 12,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 98,
      "line_range": [
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104             c.execute(\n105                 f\"select lsn, lower, upper from page_header(get_raw_page_at_lsn({reln[0]}, {reln[1]}, {reln[2]}, 0, 0, NULL, NULL))\"\n106             )\n",
      "col_offset": 18,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 105,
      "line_range": [
        105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "107             direct_latest = c.fetchone()\n108             assert second == direct_latest, \"Failed fetch page at latest lsn\"\n109 \n",
      "col_offset": 12,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 108,
      "line_range": [
        108
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "116             c.execute(\n117                 f\"select lsn, lower, upper from page_header(get_raw_page_at_lsn({reln[0]}, {reln[1]}, {reln[2]}, 0, 0, '{first[0]}', NULL))\"\n118             )\n",
      "col_offset": 18,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 117,
      "line_range": [
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "119             direct_first = c.fetchone()\n120             assert first == direct_first, \"Failed fetch page at historic lsn using oid\"\n121 \n",
      "col_offset": 12,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 120,
      "line_range": [
        120
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "166             )\n167             assert c.fetchone() == expected, \"Expected null output\"\n168 \n",
      "col_offset": 12,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 167,
      "line_range": [
        167
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "171             )\n172             assert c.fetchone() == expected, \"Expected null output\"\n173 \n",
      "col_offset": 12,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 172,
      "line_range": [
        172
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "176             )\n177             assert c.fetchone() == expected, \"Expected null output\"\n178 \n",
      "col_offset": 12,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_read_validation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 177,
      "line_range": [
        177
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89     hundred_cur.execute(\"SELECT count(*) FROM foo\")\n90     assert hundred_cur.fetchone() == (100,)\n91 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "95     more_cur.execute(\"SELECT count(*) FROM foo\")\n96     assert more_cur.fetchone() == (200100,)\n97 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 96,
      "line_range": [
        96
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "99     main_cur.execute(\"SELECT count(*) FROM foo\")\n100     assert main_cur.fetchone() == (400100,)\n101 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 100,
      "line_range": [
        100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "109     cur.execute(\"SELECT 1\")\n110     assert cur.fetchone() == (1,)\n111 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 110,
      "line_range": [
        110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "163             cur.execute(\n164                 f\"INSERT INTO t0 (v0, v1) SELECT g, '{data}' FROM generate_series({start}, {end}) g ON CONFLICT (v0) DO UPDATE SET v1 = EXCLUDED.v1\"\n165             )\n",
      "col_offset": 18,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 164,
      "line_range": [
        164
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "185             cur.execute(\"SELECT count(*) FROM t0\")\n186             assert cur.fetchone() == (ROW_COUNT,)\n187 \n",
      "col_offset": 12,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 186,
      "line_range": [
        186
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "208                 cur.execute(\"SELECT count(*) FROM t0\")\n209                 assert cur.fetchone() == (ROW_COUNT,)\n210 \n",
      "col_offset": 16,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 209,
      "line_range": [
        209
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "246 \n247         assert gc_result[\"layers_removed\"] > 0, \"Old layers should be removed after leases expired.\"\n248 \n",
      "col_offset": 8,
      "end_col_offset": 100,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 247,
      "line_range": [
        247
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "271         with endpoint.cursor() as cur:\n272             cur.execute(f\"UPDATE testtab SET iteration = {i}\")\n273             current_lsn = Lsn(query_scalar(cur, \"SELECT pg_current_wal_flush_lsn()\"))\n",
      "col_offset": 26,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 272,
      "line_range": [
        272
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "291         with endpoint_old.cursor() as cur:\n292             assert query_scalar(cur, f\"select count(*) from testtab where iteration={i}\") == 100000\n293             assert query_scalar(cur, f\"select count(*) from testtab where iteration<>{i}\") == 0\n",
      "col_offset": 12,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 292,
      "line_range": [
        292
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "291         with endpoint_old.cursor() as cur:\n292             assert query_scalar(cur, f\"select count(*) from testtab where iteration={i}\") == 100000\n293             assert query_scalar(cur, f\"select count(*) from testtab where iteration<>{i}\") == 0\n",
      "col_offset": 39,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 292,
      "line_range": [
        292
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "292             assert query_scalar(cur, f\"select count(*) from testtab where iteration={i}\") == 100000\n293             assert query_scalar(cur, f\"select count(*) from testtab where iteration<>{i}\") == 0\n",
      "col_offset": 12,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 293,
      "line_range": [
        293
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "292             assert query_scalar(cur, f\"select count(*) from testtab where iteration={i}\") == 100000\n293             assert query_scalar(cur, f\"select count(*) from testtab where iteration<>{i}\") == 0\n",
      "col_offset": 39,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_readonly_node.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 293,
      "line_range": [
        293
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "65             cur.execute(\"select count(*) from foo\")\n66             assert cur.fetchone() == (100000,)\n",
      "col_offset": 12,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_recovery.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 66,
      "line_range": [
        66
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "112             cur.execute(\n113                 f\"\"\"\n114                 CREATE TABLE t{checkpoint_number}(id int primary key, data text);\n115                 INSERT INTO t{checkpoint_number} VALUES ({data_id}, '{data}|{checkpoint_number}');\n116             \"\"\"\n117             )\n",
      "col_offset": 20,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 113,
      "line_range": [
        113,
        114,
        115,
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "165     tenant_info = wait_until_tenant_state(pageserver_http, tenant_id, \"Broken\", 15)\n166     assert tenant_info[\"attachment_status\"] == {\n167         \"slug\": \"failed\",\n168         \"data\": {\"reason\": \"storage-sync-list-remote-timelines\"},\n169     }\n170 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 166,
      "line_range": [
        166,
        167,
        168,
        169
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "175     gen_state = env.storage_controller.inspect(tenant_id)\n176     assert gen_state is not None\n177     generation = gen_state[0]\n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 176,
      "line_range": [
        176
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "187     layer_download_failed_regex = r\"Failed to download a remote file: simulated failure of remote operation Download.*[0-9A-F]+-[0-9A-F]+\"\n188     assert not env.pageserver.log_contains(\n189         layer_download_failed_regex\n190     ), \"we shouldn't have tried any layer downloads yet since list remote timelines has a failpoint\"\n191     env.pageserver.start()\n",
      "col_offset": 4,
      "end_col_offset": 100,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 188,
      "line_range": [
        188,
        189,
        190
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "204     log.info(\"Timeline detail after attach completed: %s\", detail)\n205     assert (\n206         Lsn(detail[\"last_record_lsn\"]) >= current_lsn\n207     ), \"current db Lsn should should not be less than the one stored on remote storage\"\n208 \n",
      "col_offset": 4,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 205,
      "line_range": [
        205,
        206,
        207
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "212         for checkpoint_number in checkpoint_numbers:\n213             assert (\n214                 query_scalar(cur, f\"SELECT data FROM t{checkpoint_number} WHERE id = {data_id};\")\n215                 == f\"{data}|{checkpoint_number}\"\n216             )\n217 \n",
      "col_offset": 12,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 213,
      "line_range": [
        213,
        214,
        215,
        216
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "213             assert (\n214                 query_scalar(cur, f\"SELECT data FROM t{checkpoint_number} WHERE id = {data_id};\")\n215                 == f\"{data}|{checkpoint_number}\"\n",
      "col_offset": 36,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 214,
      "line_range": [
        214
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "218     log.info(\"ensure that we needed to retry downloads due to test_remote_failures=1\")\n219     assert env.pageserver.log_contains(layer_download_failed_regex)\n220 \n",
      "col_offset": 4,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 219,
      "line_range": [
        219
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "277                 [\n278                     f\"\"\"\n279                     INSERT INTO foo (id, val)\n280                     SELECT g, '{data}'\n281                     FROM generate_series(1, {FOO_ROWS_COUNT}) g\n282                     ON CONFLICT (id) DO UPDATE\n283                     SET val = EXCLUDED.val\n284                     \"\"\",\n285                     # to ensure that GC can actually remove some layers\n",
      "col_offset": 24,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 278,
      "line_range": [
        278,
        279,
        280,
        281,
        282,
        283,
        284
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "304     print_gc_result(gc_result)\n305     assert gc_result[\"layers_removed\"] > 0\n306 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 305,
      "line_range": [
        305
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "328         print_gc_result(gc_result)\n329         assert gc_result[\"layers_removed\"] > 0\n330         result[0] = True\n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 329,
      "line_range": [
        329
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "353     churn_while_failpoints_active_thread.join(60)\n354     assert not churn_while_failpoints_active_thread.is_alive()\n355     assert churn_thread_result[0]\n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 354,
      "line_range": [
        354
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "354     assert not churn_while_failpoints_active_thread.is_alive()\n355     assert churn_thread_result[0]\n356 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 355,
      "line_range": [
        355
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "377     with endpoint.cursor() as cur:\n378         assert query_scalar(cur, \"SELECT COUNT(*) FROM foo WHERE val = 'd'\") == FOO_ROWS_COUNT\n379 \n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 378,
      "line_range": [
        378
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "416             [\n417                 f\"\"\"\n418                INSERT INTO foo (id, val)\n419                SELECT g, '{data}'\n420                FROM generate_series(1, 20000) g\n421                ON CONFLICT (id) DO UPDATE\n422                SET val = EXCLUDED.val\n423                \"\"\",\n424                 # to ensure that GC can actually remove some layers\n",
      "col_offset": 20,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 417,
      "line_range": [
        417,
        418,
        419,
        420,
        421,
        422,
        423
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "427         )\n428         assert timeline_id is not None\n429         wait_for_last_flush_lsn(env, endpoint, tenant_id, timeline_id)\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 428,
      "line_range": [
        428
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "437     def fetch_calls_started():\n438         assert timeline_id is not None\n439         for (file_kind, op_kind), observations in calls_started.items():\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 438,
      "line_range": [
        438
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "446             )\n447             assert val is not None, f\"expecting metric to be present: {file_kind} {op_kind}\"\n448             val = int(val)\n",
      "col_offset": 12,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 447,
      "line_range": [
        447
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "453             log.info(f\"ensure_calls_started_grew: {file_kind} {op_kind}: {observations}\")\n454             assert all(\n455                 x < y for x, y in zip(observations, observations[1:])\n456             ), f\"observations for {file_kind} {op_kind} did not grow monotonically: {observations}\"\n457 \n",
      "col_offset": 12,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 454,
      "line_range": [
        454,
        455,
        456
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "471         print_gc_result(gc_result)\n472         assert gc_result[\"layers_removed\"] > 0\n473 \n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 472,
      "line_range": [
        472
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "515     with endpoint.cursor() as cur:\n516         assert query_scalar(cur, \"SELECT COUNT(*) FROM foo WHERE val = 'd'\") == 20000\n517 \n",
      "col_offset": 8,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 516,
      "line_range": [
        516
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "569         except PageserverApiException:\n570             assert (\n571                 checkpoint_allowed_to_fail.is_set()\n572             ), \"checkpoint op should only fail in response to timeline deletion\"\n573 \n",
      "col_offset": 12,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 570,
      "line_range": [
        570,
        571,
        572
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "579     def assert_compacted_and_uploads_queued():\n580         assert timeline_path.exists()\n581         assert len(list(timeline_path.glob(\"*\"))) >= 8\n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 580,
      "line_range": [
        580
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "580         assert timeline_path.exists()\n581         assert len(list(timeline_path.glob(\"*\"))) >= 8\n582         assert (\n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 581,
      "line_range": [
        581
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "581         assert len(list(timeline_path.glob(\"*\"))) >= 8\n582         assert (\n583             get_queued_count(client, tenant_id, timeline_id, file_kind=\"index\", op_kind=\"upload\")\n584             > 0\n585         )\n586 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 582,
      "line_range": [
        582,
        583,
        584,
        585
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "608 \n609     assert not timeline_path.exists()\n610 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 609,
      "line_range": [
        609
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "611     # to please mypy\n612     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n613     remote_timeline_path = env.pageserver_remote_storage.timeline_path(tenant_id, timeline_id)\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 612,
      "line_range": [
        612
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "619     ]\n620     assert len(filtered) == 0\n621 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 620,
      "line_range": [
        620
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "622     # timeline deletion should kill ongoing uploads, so, the metric will be gone\n623     assert (\n624         get_queued_count(client, tenant_id, timeline_id, file_kind=\"index\", op_kind=\"upload\")\n625         is None\n626     )\n627 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 623,
      "line_range": [
        623,
        624,
        625,
        626
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "629     checkpoint_thread.join(20.0)\n630     assert not checkpoint_thread.is_alive()\n631 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 630,
      "line_range": [
        630
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "659     expected_timelines = set([env.initial_timeline, new_branch_timeline_id])\n660     assert (\n661         timelines_before_detach == expected_timelines\n662     ), f\"Expected to have an initial timeline and the branch timeline only, but got {timelines_before_detach}\"\n663 \n",
      "col_offset": 4,
      "end_col_offset": 110,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 660,
      "line_range": [
        660,
        661,
        662
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "674 \n675     assert (\n676         timelines_before_detach == timelines_after_detach\n677     ), f\"Expected to have same timelines after reattach, but got {timelines_after_detach}\"\n678 \n",
      "col_offset": 4,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 675,
      "line_range": [
        675,
        676,
        677
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "714     timeline_dir = env.pageserver.timeline_dir(env.initial_tenant, new_branch_timeline_id)\n715     assert timeline_dir.is_dir()\n716 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 715,
      "line_range": [
        715
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "716 \n717     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n718 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 717,
      "line_range": [
        717
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "721     )\n722     assert (\n723         not new_branch_on_remote_storage.exists()\n724     ), \"failpoint should had prohibited index_part.json upload\"\n725 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 722,
      "line_range": [
        722,
        723,
        724
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "760 \n761         assert not new_branch_on_remote_storage.exists(), \"failpoint should had stopped uploading\"\n762 \n",
      "col_offset": 8,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 761,
      "line_range": [
        761
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "765 \n766         assert (\n767             exception is None\n768         ), \"create_timeline should have succeeded, because we deleted unuploaded local state\"\n769 \n",
      "col_offset": 8,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 766,
      "line_range": [
        766,
        767,
        768
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "772 \n773         assert env.pageserver_remote_storage.index_path(\n774             env.initial_tenant, new_branch_timeline_id\n775         ).is_file(), \"uploads scheduled during initial load should had been awaited for\"\n776     finally:\n",
      "col_offset": 8,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 773,
      "line_range": [
        773,
        774,
        775
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "809     deltas_at_creation = len(layers_at_creation.delta_layers())\n810     assert (\n811         deltas_at_creation == 1\n812     ), \"are you fixing #5863? make sure we end up with 2 deltas at the end of endpoint lifecycle\"\n813 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 810,
      "line_range": [
        810,
        811,
        812
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "875     detail = client.timeline_detail(tenant_id, timeline_id)\n876     assert Lsn(detail[\"last_record_lsn\"]) == Lsn(detail[\"remote_consistent_lsn\"])\n877 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 876,
      "line_range": [
        876
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "93     secondary_cur.execute(\"select count(*) from t\")\n94     assert secondary_cur.fetchone() == (0,)\n95 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "136     secondary_cur.execute(\"select count(*) from t\")\n137     assert secondary_cur.fetchone() == (1,)\n138 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 137,
      "line_range": [
        137
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "168     secondary_cur.execute(\"select 123\")\n169     assert secondary_cur.fetchone() == (123,)\n170 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 169,
      "line_range": [
        169
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "227     start_secondary_thread.join(5)\n228     assert secondary.log_contains(\"consistent recovery state reached\")\n229     assert secondary.log_contains(\"started streaming WAL from primary\")\n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 228,
      "line_range": [
        228
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "228     assert secondary.log_contains(\"consistent recovery state reached\")\n229     assert secondary.log_contains(\"started streaming WAL from primary\")\n230     # The \"redo starts\" message is printed when the first WAL record is\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 229,
      "line_range": [
        229
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "238     # should not be open for connections yet\n239     assert start_secondary_thread.is_alive()\n240     assert not secondary.is_running()\n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 239,
      "line_range": [
        239
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "239     assert start_secondary_thread.is_alive()\n240     assert not secondary.is_running()\n241     assert not secondary.log_contains(\"database system is ready to accept read-only connections\")\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 240,
      "line_range": [
        240
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "240     assert not secondary.is_running()\n241     assert not secondary.log_contains(\"database system is ready to accept read-only connections\")\n242 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 241,
      "line_range": [
        241
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "255     secondary_cur.execute(\"select count(*) from t\")\n256     assert secondary_cur.fetchone() == (100000,)\n257 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 256,
      "line_range": [
        256
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "265     secondary_cur.execute(\"select count(*) from t\")\n266     assert secondary_cur.fetchone() == (100000,)\n267 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 266,
      "line_range": [
        266
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "273     secondary_cur.execute(\"select count(*) from t\")\n274     assert secondary_cur.fetchone() == (100000,)\n275 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 274,
      "line_range": [
        274
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "279     secondary_cur.execute(\"select count(*) from t\")\n280     assert secondary_cur.fetchone() == (110001,)\n281 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 280,
      "line_range": [
        280
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "339     secondary_cur.execute(\"select count(*) from t\")\n340     assert secondary_cur.fetchone() == (1,)\n341 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 340,
      "line_range": [
        340
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "378     wait_until(20, 0.5, check_replica_crashed)\n379     assert secondary.log_contains(\"too many KnownAssignedXids\")\n380 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 379,
      "line_range": [
        379
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "414     s_cur.execute(\"select * from t where pk = 1\")\n415     assert s_cur.fetchone() == (1, 0)\n416 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 415,
      "line_range": [
        415
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "477     secondary_cur.execute(\"select count(*) from t\")\n478     assert secondary_cur.fetchone() == (0,)\n479     secondary_cur.execute(\"select count(*) from t1\")\n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 478,
      "line_range": [
        478
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "479     secondary_cur.execute(\"select count(*) from t1\")\n480     assert secondary_cur.fetchone() == (0,)\n481     secondary_cur.execute(\"select count(*) from t2\")\n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 480,
      "line_range": [
        480
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "481     secondary_cur.execute(\"select count(*) from t2\")\n482     assert secondary_cur.fetchone() == (0,)\n483 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 482,
      "line_range": [
        482
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "496     if shutdown:\n497         assert secondary_cur.fetchone() == (0,)\n498     else:\n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 497,
      "line_range": [
        497
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "498     else:\n499         assert secondary_cur.fetchone() == (50,)\n500     secondary_cur.execute(\"select * from t1\")\n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 499,
      "line_range": [
        499
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "500     secondary_cur.execute(\"select * from t1\")\n501     assert secondary_cur.fetchall() == [(1,)]\n502     secondary_cur.execute(\"select * from t2\")\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 501,
      "line_range": [
        501
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "502     secondary_cur.execute(\"select * from t2\")\n503     assert secondary_cur.fetchall() == [(2,), (3,)]\n504 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 503,
      "line_range": [
        503
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "559     secondary_cur.execute(\"select count(*) from t\")\n560     assert secondary_cur.fetchone() == (0,)\n561 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 560,
      "line_range": [
        560
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "571     secondary_cur.execute(\"select count(*) from t\")\n572     assert secondary_cur.fetchone() == (100000,)\n573 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 572,
      "line_range": [
        572
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "577     secondary_cur.execute(\"select count(*) from t\")\n578     assert secondary_cur.fetchone() == (101000,)\n579 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 578,
      "line_range": [
        578
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "634     secondary_cur.execute(\"select count(*) from t\")\n635     assert secondary_cur.fetchone() == (1,)\n636 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 635,
      "line_range": [
        635
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "646     secondary_cur.execute(\"select count(*) from t\")\n647     assert secondary_cur.fetchone() == (100001,)\n648 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 647,
      "line_range": [
        647
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "652     secondary_cur.execute(\"select count(*) from t\")\n653     assert secondary_cur.fetchone() == (200001,)\n654 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 653,
      "line_range": [
        653
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "693         secondary_cur.execute(\"select count(*) from t\")\n694         assert secondary_cur.fetchone() == (n_restarts,)\n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_replica_start.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 694,
      "line_range": [
        694
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "40 \n41         assert res == [(1,)], \"select should not succeed\"\n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_role_grants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 41,
      "line_range": [
        41
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "32         remote_storage = neon_env_builder.pageserver_remote_storage\n33         assert remote_storage, \"remote storage not configured\"\n34         enable_remote_storage_versioning(remote_storage)\n",
      "col_offset": 8,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 33,
      "line_range": [
        33
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "57     # Default tenant and the one we created\n58     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 1\n59 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 58,
      "line_range": [
        58
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "80 \n81     assert (\n82         ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 1\n83     ), \"tenant removed before we deletion was issued\"\n84     ps_http.tenant_delete(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 81,
      "line_range": [
        81,
        82,
        83
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "85     ps_http.deletion_queue_flush(execute=True)\n86     assert (\n87         ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 0\n88     ), \"tenant removed before we deletion was issued\"\n89     env.storage_controller.attach_hook_drop(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 86,
      "line_range": [
        86,
        87,
        88
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91     tenant_path = env.pageserver.tenant_dir(tenant_id)\n92     assert not tenant_path.exists()\n93 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "121         with env.endpoints.create_start(timeline, tenant_id=tenant_id) as endpoint:\n122             endpoint.safe_psql(f\"SELECT * FROM created_{timeline};\")\n123             last_flush_lsn = Lsn(endpoint.safe_psql(\"SELECT pg_current_wal_flush_lsn()\")[0][0])\n",
      "col_offset": 33,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 122,
      "line_range": [
        122
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "125             # There might be some activity that advances the lsn so we can't use a strict equality check\n126             assert last_flush_lsn >= expected_last_flush_lsn, \"last_flush_lsn too old\"\n127 \n",
      "col_offset": 12,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 126,
      "line_range": [
        126
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "127 \n128     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 1\n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_s3_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 128,
      "line_range": [
        128
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "81     expect_initdb_size = 20 * 1024 * 1024\n82     assert physical_initdb_total > expect_initdb_size\n83     assert all(s < expect_initdb_size // 2 for s in sizes.values())\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "82     assert physical_initdb_total > expect_initdb_size\n83     assert all(s < expect_initdb_size // 2 for s in sizes.values())\n84 \n",
      "col_offset": 4,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 83,
      "line_range": [
        83
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "100     # Our sizes increased when we wrote data\n101     assert sum(sizes_after.values()) > sum(sizes_before.values())\n102     # That increase is present on all shards\n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 101,
      "line_range": [
        101
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "102     # That increase is present on all shards\n103     assert all(sizes_after[ps.id] > sizes_before[ps.id] for ps in env.pageservers)\n104 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 103,
      "line_range": [
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "112         )\n113         assert timelines == {env.initial_timeline, timeline_b}\n114 \n",
      "col_offset": 8,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 113,
      "line_range": [
        113
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "133     healthy, _ = env.storage_scrubber.scan_metadata()\n134     assert healthy\n135 \n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 134,
      "line_range": [
        134
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "162     # but check it in case we change the default in future\n163     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 0)) is not None\n164 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 163,
      "line_range": [
        163
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "173     # Check we got the shard IDs we expected\n174     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 2)) is not None\n175     assert env.storage_controller.inspect(TenantShardId(tenant_id, 1, 2)) is not None\n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 174,
      "line_range": [
        174
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "174     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 2)) is not None\n175     assert env.storage_controller.inspect(TenantShardId(tenant_id, 1, 2)) is not None\n176 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 175,
      "line_range": [
        175
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "225     # but check it in case we change the default in future\n226     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 0)) is not None\n227 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 226,
      "line_range": [
        226
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "247     # Check we got the shard IDs we expected\n248     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 2)) is not None\n249     assert env.storage_controller.inspect(TenantShardId(tenant_id, 1, 2)) is not None\n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 248,
      "line_range": [
        248
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "248     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 2)) is not None\n249     assert env.storage_controller.inspect(TenantShardId(tenant_id, 1, 2)) is not None\n250 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 249,
      "line_range": [
        249
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "265         # Physical size should shrink because some layers have been dropped\n266         assert detail_after[\"current_physical_size\"] < detail_before[\"current_physical_size\"]\n267 \n",
      "col_offset": 8,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 266,
      "line_range": [
        266
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "319         else:\n320             assert failpoint is None  # We shouldn't reach success path if a failpoint was set\n321 \n",
      "col_offset": 12,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 320,
      "line_range": [
        320
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "324             # Physical size should shrink because layers are smaller\n325             assert detail_after[\"current_physical_size\"] < detail_before[\"current_physical_size\"]\n326 \n",
      "col_offset": 12,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 325,
      "line_range": [
        325
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "334         raw_page_count = tally.not_disposable_count + tally.disposable_count\n335         assert tally.not_disposable_count > (\n336             raw_page_count // 2\n337         ), \"compaction doesn't rewrite layers that are >=50pct local\"\n338 \n",
      "col_offset": 8,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 335,
      "line_range": [
        335,
        336,
        337
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "361 \n362         assert measured_size == reported_size\n363 \n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 362,
      "line_range": [
        362
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "400     # but check it in case we change the default in future\n401     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 0)) is not None\n402 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 401,
      "line_range": [
        401
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "432         list = http_client.timeline_and_offloaded_list(tenant_id)\n433         assert timeline_id_set_for(list.offloaded) == expected_offloaded_set\n434         assert timeline_id_set_for(list.timelines) == expected_timeline_set\n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 433,
      "line_range": [
        433
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "433         assert timeline_id_set_for(list.offloaded) == expected_offloaded_set\n434         assert timeline_id_set_for(list.timelines) == expected_timeline_set\n435 \n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 434,
      "line_range": [
        434
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "448     # Check we got the shard IDs we expected\n449     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 2)) is not None\n450     assert env.storage_controller.inspect(TenantShardId(tenant_id, 1, 2)) is not None\n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 449,
      "line_range": [
        449
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "449     assert env.storage_controller.inspect(TenantShardId(tenant_id, 0, 2)) is not None\n450     assert env.storage_controller.inspect(TenantShardId(tenant_id, 1, 2)) is not None\n451 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 450,
      "line_range": [
        450
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "461         list = ps.http_client().timeline_and_offloaded_list(shard)\n462         assert timeline_id_set_for(list.offloaded) == expected_offloaded_set\n463         assert timeline_id_set_for(list.timelines) == expected_timeline_set\n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 462,
      "line_range": [
        462
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "462         assert timeline_id_set_for(list.offloaded) == expected_offloaded_set\n463         assert timeline_id_set_for(list.timelines) == expected_timeline_set\n464 \n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 463,
      "line_range": [
        463
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "478         list = ps.http_client().timeline_and_offloaded_list(shard)\n479         assert timeline_id_set_for(list.offloaded) == expected_offloaded_set\n480         assert timeline_id_set_for(list.timelines) == expected_timeline_set\n",
      "col_offset": 8,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 479,
      "line_range": [
        479
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "479         assert timeline_id_set_for(list.offloaded) == expected_offloaded_set\n480         assert timeline_id_set_for(list.timelines) == expected_timeline_set\n481 \n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 480,
      "line_range": [
        480
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "498         list = ps.http_client().timeline_and_offloaded_list(shard)\n499         assert timeline_id_set_for(list.offloaded) == set()\n500         assert timeline_id_set_for(list.timelines) == {\n",
      "col_offset": 8,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 499,
      "line_range": [
        499
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "499         assert timeline_id_set_for(list.offloaded) == set()\n500         assert timeline_id_set_for(list.timelines) == {\n501             timeline_id_main,\n502             timeline_id_archived,\n503             timeline_id_offloaded,\n504         }\n505 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 500,
      "line_range": [
        500,
        501,
        502,
        503,
        504
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "573         # Not everything received was committed\n574         assert (\n575             metrics[\"pageserver_wal_ingest_records_received_total\"]\n576             > metrics[\"pageserver_wal_ingest_records_committed_total\"]\n577         )\n578 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 574,
      "line_range": [
        574,
        575,
        576,
        577
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "579         # Something was committed\n580         assert metrics[\"pageserver_wal_ingest_records_committed_total\"] > 0\n581 \n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 580,
      "line_range": [
        580
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "582         # Counts are self consistent\n583         assert (\n584             metrics[\"pageserver_wal_ingest_records_received_total\"]\n585             == metrics[\"pageserver_wal_ingest_records_committed_total\"]\n586             + metrics[\"pageserver_wal_ingest_records_filtered_total\"]\n587         )\n588 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 583,
      "line_range": [
        583,
        584,
        585,
        586,
        587
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "592 \n593     assert len(pre_split_pageserver_ids) == 4\n594 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 593,
      "line_range": [
        593
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "604     # Before split, old shards exist\n605     assert shards_on_disk(old_shard_ids)\n606 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 605,
      "line_range": [
        605
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "607     # Before split, we have done one reconcile for each shard\n608     assert (\n609         env.storage_controller.get_metric_value(\n610             \"storage_controller_reconcile_complete_total\", filter={\"status\": \"ok\"}\n611         )\n612         == shard_count\n613     )\n614 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 608,
      "line_range": [
        608,
        609,
        610,
        611,
        612,
        613
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "623     # We should have split into 8 shards, on the same 4 pageservers we started on.\n624     assert len(post_split_pageserver_ids) == split_shard_count\n625     assert len(set(post_split_pageserver_ids)) == shard_count\n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 624,
      "line_range": [
        624
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "624     assert len(post_split_pageserver_ids) == split_shard_count\n625     assert len(set(post_split_pageserver_ids)) == shard_count\n626     assert set(post_split_pageserver_ids) == set(pre_split_pageserver_ids)\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 625,
      "line_range": [
        625
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "625     assert len(set(post_split_pageserver_ids)) == shard_count\n626     assert set(post_split_pageserver_ids) == set(pre_split_pageserver_ids)\n627 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 626,
      "line_range": [
        626
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "628     # The old parent shards should no longer exist on disk\n629     assert not shards_on_disk(old_shard_ids)\n630 \n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 629,
      "line_range": [
        629
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "661     )\n662     assert reconcile_ok == expect_reconciles\n663 \n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 662,
      "line_range": [
        662
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "671     )\n672     assert cancelled_reconciles is not None and int(cancelled_reconciles) == 0\n673     assert errored_reconciles is not None and int(errored_reconciles) == 0\n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 672,
      "line_range": [
        672
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "672     assert cancelled_reconciles is not None and int(cancelled_reconciles) == 0\n673     assert errored_reconciles is not None and int(errored_reconciles) == 0\n674 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 673,
      "line_range": [
        673
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "676     # before happening\n677     assert env.storage_controller.log_contains(\".*Skipping.*because secondary isn't ready.*\")\n678 \n",
      "col_offset": 4,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 677,
      "line_range": [
        677
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "701             for k, v in non_default_tenant_config.items():\n702                 assert config.effective_config[k] == v\n703 \n",
      "col_offset": 16,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 702,
      "line_range": [
        702
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "705             # (https://github.com/neondatabase/neon/issues/8189)\n706             assert (\n707                 config.effective_config[\"heatmap_period\"]\n708                 and config.effective_config[\"heatmap_period\"] != \"0s\"\n709             )\n710 \n",
      "col_offset": 12,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 706,
      "line_range": [
        706,
        707,
        708,
        709
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "712     (total, attached) = get_node_shard_counts(env, tenant_ids=[tenant_id])\n713     assert sum(attached.values()) == split_shard_count\n714     assert sum(total.values()) == split_shard_count * 2\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 713,
      "line_range": [
        713
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "713     assert sum(attached.values()) == split_shard_count\n714     assert sum(total.values()) == split_shard_count * 2\n715     check_effective_tenant_config()\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 714,
      "line_range": [
        714
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "720     log.info(f\"total: {total}\")\n721     assert total == {\n722         1: 1,\n723         2: 1,\n724         3: 1,\n725         4: 1,\n726         5: 1,\n727         6: 1,\n728         7: 1,\n729         8: 1,\n730         9: 1,\n731         10: 1,\n732         11: 1,\n733         12: 1,\n734         13: 1,\n735         14: 1,\n736         15: 1,\n737         16: 1,\n738     }\n739 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 721,
      "line_range": [
        721,
        722,
        723,
        724,
        725,
        726,
        727,
        728,
        729,
        730,
        731,
        732,
        733,
        734,
        735,
        736,
        737,
        738
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "745         log.info(\"Pre-split pageserver {ps_id} should still hold an attached location\")\n746         assert ps_id in attached\n747 \n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 746,
      "line_range": [
        746
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "756     (total, attached) = get_node_shard_counts(env, tenant_ids=[tenant_id])\n757     assert sum(attached.values()) == split_shard_count\n758     assert sum(total.values()) == split_shard_count * 2\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 757,
      "line_range": [
        757
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "757     assert sum(attached.values()) == split_shard_count\n758     assert sum(total.values()) == split_shard_count * 2\n759     check_effective_tenant_config()\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 758,
      "line_range": [
        758
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "793 \n794     assert len(notifications) == 1\n795     expect: dict[str, Union[list[dict[str, int]], str, None, int]] = {\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 794,
      "line_range": [
        794
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "799     }\n800     assert notifications[0] == expect\n801 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 800,
      "line_range": [
        800
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "809     # and in the notifications to compute\n810     assert len(notifications) == 2\n811     expect_after: dict[str, Union[list[dict[str, int]], str, None, int]] = {\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 810,
      "line_range": [
        810
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "819     log.info(f\"Got notification: {notifications[1]}\")\n820     assert notifications[1] == expect_after\n821 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 820,
      "line_range": [
        820
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "825     )\n826     assert shard_0_loc[\"shard_stripe_size\"] == new_stripe_size\n827     shard_1_loc = (\n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 826,
      "line_range": [
        826
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "829     )\n830     assert shard_1_loc[\"shard_stripe_size\"] == new_stripe_size\n831 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 830,
      "line_range": [
        830
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "837     )\n838     assert shard_0_loc[\"shard_stripe_size\"] == new_stripe_size\n839     shard_1_loc = (\n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 838,
      "line_range": [
        838
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "841     )\n842     assert shard_1_loc[\"shard_stripe_size\"] == new_stripe_size\n843 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 842,
      "line_range": [
        842
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "848     def assert_restart_notification():\n849         assert len(notifications) == 3\n850         assert notifications[2] == expect_after\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 849,
      "line_range": [
        849
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "849         assert len(notifications) == 3\n850         assert notifications[2] == expect_after\n851 \n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 850,
      "line_range": [
        850
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "948             if layer.kind == \"Delta\":\n949                 assert layer.lsn_end is not None\n950                 lsn_size = Lsn(layer.lsn_end) - Lsn(layer.lsn_start)\n",
      "col_offset": 16,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 949,
      "line_range": [
        949
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "967         # old limit was 0.25 but pg14 is right at the limit with 7/28\n968         assert float(small_layer_count) / float(ok_layer_count) < 0.3\n969 \n",
      "col_offset": 8,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 968,
      "line_range": [
        968
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "970     # Each shard may emit up to one huge layer, because initdb ingest doesn't respect checkpoint_distance.\n971     assert huge_layer_count <= shard_count\n972 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 971,
      "line_range": [
        971
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1040             log.info(f\"{tenant_shard_id} (ps {pageserver.id}) detail: {timeline_detail}\")\n1041             assert Lsn(timeline_detail[\"disk_consistent_lsn\"]) >= expect_lsn\n1042 \n",
      "col_offset": 12,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1041,
      "line_range": [
        1041
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1052             log.info(f\"{tenant_shard_id} (ps {pageserver.id}) detail: {timeline_detail}\")\n1053             assert Lsn(timeline_detail[\"remote_consistent_lsn\"]) >= expect_lsn\n1054 \n",
      "col_offset": 12,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1053,
      "line_range": [
        1053
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1252         # We can't give a sensible response if our failures have different expectations\n1253         assert len(expect) == 1\n1254 \n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1253,
      "line_range": [
        1253
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1336     # Make sure the node we're failing has a shard on it, otherwise the test isn't testing anything\n1337     assert (\n1338         failure.pageserver_id is None\n1339         or len(\n1340             env.get_pageserver(failure.pageserver_id)\n1341             .http_client()\n1342             .tenant_list_locations()[\"tenant_shards\"]\n1343         )\n1344         > 0\n1345     )\n1346 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1337,
      "line_range": [
        1337,
        1338,
        1339,
        1340,
        1341,
        1342,
        1343,
        1344,
        1345
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1370                 log.info(f\"Shard {tenant_shard_id} seen on node {ps.id} in mode {loc[1]['mode']}\")\n1371                 assert tenant_shard_id.shard_count == initial_shard_count\n1372                 if loc[1][\"mode\"] == \"Secondary\":\n",
      "col_offset": 16,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1371,
      "line_range": [
        1371
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1379             # scheduled on the offline node, so expect one fewer secondary in total\n1380             assert secondary_count == initial_shard_count - 1\n1381         else:\n",
      "col_offset": 12,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1380,
      "line_range": [
        1380
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1381         else:\n1382             assert secondary_count == initial_shard_count\n1383 \n",
      "col_offset": 12,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1382,
      "line_range": [
        1382
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1383 \n1384         assert attached_count == initial_shard_count\n1385 \n",
      "col_offset": 8,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1384,
      "line_range": [
        1384
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1396                 log.info(f\"Shard {tenant_shard_id} seen on node {ps.id} in mode {loc[1]['mode']}\")\n1397                 assert tenant_shard_id.shard_count == split_shard_count\n1398                 if loc[1][\"mode\"] == \"Secondary\":\n",
      "col_offset": 16,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1397,
      "line_range": [
        1397
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1401                     attached_count += 1\n1402         assert attached_count == split_shard_count\n1403         assert secondary_count == split_shard_count\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1402,
      "line_range": [
        1402
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1402         assert attached_count == split_shard_count\n1403         assert secondary_count == split_shard_count\n1404 \n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1403,
      "line_range": [
        1403
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1604         diff = max_lsn - min_lsn\n1605         assert diff < 2 * 1024 * 1024, f\"LSN diff={diff}, expected diff < 2MB due to backpressure\"\n1606 \n",
      "col_offset": 8,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1605,
      "line_range": [
        1605
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1629             ep.safe_psql(f\"CREATE UNLOGGED TABLE {table_name} (id integer, value varchar(64));\")\n1630             ep.safe_psql(f\"INSERT INTO {table_name} VALUES (1, 'foo')\")\n1631             result = ep.safe_psql(f\"SELECT * from {table_name};\")\n",
      "col_offset": 27,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 1630,
      "line_range": [
        1630
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "1630             ep.safe_psql(f\"INSERT INTO {table_name} VALUES (1, 'foo')\")\n1631             result = ep.safe_psql(f\"SELECT * from {table_name};\")\n1632             assert result == [(1, \"foo\")]\n",
      "col_offset": 36,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 1631,
      "line_range": [
        1631
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "1631             result = ep.safe_psql(f\"SELECT * from {table_name};\")\n1632             assert result == [(1, \"foo\")]\n1633             ep.safe_psql(f\"CREATE INDEX ON {table_name} USING btree (value);\")\n",
      "col_offset": 12,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1632,
      "line_range": [
        1632
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1639             # Check that table works: we can select and insert\n1640             result = ep.safe_psql(f\"SELECT * from {table_name};\")\n1641             assert result == []\n",
      "col_offset": 36,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 1640,
      "line_range": [
        1640
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "1640             result = ep.safe_psql(f\"SELECT * from {table_name};\")\n1641             assert result == []\n1642             ep.safe_psql(f\"INSERT INTO {table_name} VALUES (2, 'bar');\")\n",
      "col_offset": 12,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1641,
      "line_range": [
        1641
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1641             assert result == []\n1642             ep.safe_psql(f\"INSERT INTO {table_name} VALUES (2, 'bar');\")\n1643             result = ep.safe_psql(f\"SELECT * from {table_name};\")\n",
      "col_offset": 27,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 1642,
      "line_range": [
        1642
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "1642             ep.safe_psql(f\"INSERT INTO {table_name} VALUES (2, 'bar');\")\n1643             result = ep.safe_psql(f\"SELECT * from {table_name};\")\n1644             assert result == [(2, \"bar\")]\n",
      "col_offset": 36,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 1643,
      "line_range": [
        1643
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "1643             result = ep.safe_psql(f\"SELECT * from {table_name};\")\n1644             assert result == [(2, \"bar\")]\n1645 \n",
      "col_offset": 12,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1644,
      "line_range": [
        1644
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1679     top_1 = env.pageserver.http_client().top_tenants(\"max_logical_size\", 1, 8, 0)\n1680     assert len(top_1[\"shards\"]) == 1\n1681     assert top_1[\"shards\"][0][\"id\"] == str(tenants[-1][0])\n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1680,
      "line_range": [
        1680
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1680     assert len(top_1[\"shards\"]) == 1\n1681     assert top_1[\"shards\"][0][\"id\"] == str(tenants[-1][0])\n1682     assert top_1[\"shards\"][0][\"max_logical_size\"] == tenants[-1][2]\n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1681,
      "line_range": [
        1681
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1681     assert top_1[\"shards\"][0][\"id\"] == str(tenants[-1][0])\n1682     assert top_1[\"shards\"][0][\"max_logical_size\"] == tenants[-1][2]\n1683 \n",
      "col_offset": 4,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1682,
      "line_range": [
        1682
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1687     )\n1688     assert len(top[\"shards\"]) == n_tenants - 4\n1689     assert set(i[\"id\"] for i in top[\"shards\"]) == set(str(i[0]) for i in tenants[4:])\n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1688,
      "line_range": [
        1688
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1688     assert len(top[\"shards\"]) == n_tenants - 4\n1689     assert set(i[\"id\"] for i in top[\"shards\"]) == set(str(i[0]) for i in tenants[4:])\n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sharding.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1689,
      "line_range": [
        1689
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3 import socket\n4 import subprocess\n5 from pathlib import Path\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sni_router.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 4,
      "line_range": [
        4
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "18 def generate_tls_cert(cn, certout, keyout):\n19     subprocess.run(\n20         [\n21             \"openssl\",\n22             \"req\",\n23             \"-new\",\n24             \"-x509\",\n25             \"-days\",\n26             \"365\",\n27             \"-nodes\",\n28             \"-out\",\n29             certout,\n30             \"-keyout\",\n31             keyout,\n32             \"-subj\",\n33             f\"/CN={cn}\",\n34         ]\n35     )\n36 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sni_router.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Starting a process with a partial executable path",
      "line_number": 19,
      "line_range": [
        19,
        20,
        21,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        34,
        35
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b607_start_process_with_partial_path.html",
      "test_id": "B607",
      "test_name": "start_process_with_partial_path"
    },
    {
      "code": "18 def generate_tls_cert(cn, certout, keyout):\n19     subprocess.run(\n20         [\n21             \"openssl\",\n22             \"req\",\n23             \"-new\",\n24             \"-x509\",\n25             \"-days\",\n26             \"365\",\n27             \"-nodes\",\n28             \"-out\",\n29             certout,\n30             \"-keyout\",\n31             keyout,\n32             \"-subj\",\n33             f\"/CN={cn}\",\n34         ]\n35     )\n36 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sni_router.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 19,
      "line_range": [
        19,
        20,
        21,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        34,
        35
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "61     def start(self) -> PgSniRouter:\n62         assert self._popen is None\n63         args = [\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sni_router.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "73 \n74         self._popen = subprocess.Popen(args, stderr=router_log)\n75         self._wait_until_ready()\n",
      "col_offset": 22,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sni_router.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "subprocess call - check for execution of untrusted input.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b603_subprocess_without_shell_equals_true.html",
      "test_id": "B603",
      "test_name": "subprocess_without_shell_equals_true"
    },
    {
      "code": "146         )\n147         assert out[0][0] == 1\n",
      "col_offset": 8,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_sni_router.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 147,
      "line_range": [
        147
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "90     nodes = env.storage_controller.node_list()\n91     assert len(nodes) == 2\n92     assert set(n[\"id\"] for n in nodes) == {env.pageservers[0].id, env.pageservers[1].id}\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 91,
      "line_range": [
        91
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91     assert len(nodes) == 2\n92     assert set(n[\"id\"] for n in nodes) == {env.pageservers[0].id, env.pageservers[1].id}\n93 \n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "96     nodes = env.storage_controller.node_list()\n97     assert len(nodes) == 3\n98     assert set(n[\"id\"] for n in nodes) == {ps.id for ps in env.pageservers}\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 97,
      "line_range": [
        97
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "97     assert len(nodes) == 3\n98     assert set(n[\"id\"] for n in nodes) == {ps.id for ps in env.pageservers}\n99 \n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 98,
      "line_range": [
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "110     # Validate high level metrics\n111     assert (\n112         env.storage_controller.get_metric_value(\"storage_controller_tenant_shards\")\n113         == len(tenant_ids) * shards_per_tenant\n114     )\n115     assert env.storage_controller.get_metric_value(\"storage_controller_pageserver_nodes\") == len(\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 111,
      "line_range": [
        111,
        112,
        113,
        114
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "114     )\n115     assert env.storage_controller.get_metric_value(\"storage_controller_pageserver_nodes\") == len(\n116         env.storage_controller.node_list()\n117     )\n118 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 115,
      "line_range": [
        115,
        116,
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "126         # so expect equal number on all pageservers\n127         assert count == tenant_shard_count / len(\n128             env.pageservers\n129         ), f\"Node {node_id} has bad count {count}\"\n130 \n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 127,
      "line_range": [
        127,
        128,
        129
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "137     timelines = env.storage_controller.pageserver_api().timeline_list(timeline_crud_tenant)\n138     assert len(timelines) == 2\n139     assert timeline_id in set(TimelineId(t[\"timeline_id\"]) for t in timelines)\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 138,
      "line_range": [
        138
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "138     assert len(timelines) == 2\n139     assert timeline_id in set(TimelineId(t[\"timeline_id\"]) for t in timelines)\n140     #    virtual_ps_http.timeline_delete(tenant_id=timeline_crud_tenant, timeline_id=timeline_id)\n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 139,
      "line_range": [
        139
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "144     timelines = env.storage_controller.pageserver_api().timeline_list(timeline_crud_tenant)\n145     assert len(timelines) == 1\n146     assert timeline_id not in set(TimelineId(t[\"timeline_id\"]) for t in timelines)\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 145,
      "line_range": [
        145
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "145     assert len(timelines) == 1\n146     assert timeline_id not in set(TimelineId(t[\"timeline_id\"]) for t in timelines)\n147 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 146,
      "line_range": [
        146
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "152         counts = get_node_shard_counts(env, tenant_ids)\n153         assert counts[node_id] == 0\n154 \n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 153,
      "line_range": [
        153
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "163     time.sleep(1)\n164     assert get_node_shard_counts(env, tenant_ids)[env.pageservers[0].id] == 0\n165 \n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 164,
      "line_range": [
        164
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "170     after_restart = env.pageservers[1].http_client().tenant_list_locations()\n171     assert len(after_restart) == len(before_restart)\n172 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 171,
      "line_range": [
        171
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "177         del tenant[\"generation\"]\n178     assert before_restart == after_restart\n179 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 178,
      "line_range": [
        178
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "196     # Nothing should have been scheduled on the node in Draining\n197     assert counts[env.pageservers[1].id] == 0\n198     assert counts[env.pageservers[0].id] == tenant_shard_count // 2\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 197,
      "line_range": [
        197
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "197     assert counts[env.pageservers[1].id] == 0\n198     assert counts[env.pageservers[0].id] == tenant_shard_count // 2\n199     assert counts[env.pageservers[2].id] == tenant_shard_count // 2\n",
      "col_offset": 4,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 198,
      "line_range": [
        198
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "198     assert counts[env.pageservers[0].id] == tenant_shard_count // 2\n199     assert counts[env.pageservers[2].id] == tenant_shard_count // 2\n200 \n",
      "col_offset": 4,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 199,
      "line_range": [
        199
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "211     nodes = env.storage_controller.node_list()\n212     assert len(nodes) == 2\n213 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 212,
      "line_range": [
        212
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "220     def is_ready():\n221         assert env.storage_controller.ready() is True\n222 \n",
      "col_offset": 8,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 221,
      "line_range": [
        221
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "226     nodes = env.storage_controller.node_list()\n227     assert len(nodes) == 2\n228 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 227,
      "line_range": [
        227
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "250     timelines = client.timeline_list(tenant_id=env.initial_tenant)\n251     assert len(timelines) == 1\n252 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 251,
      "line_range": [
        251
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "253     status = client.tenant_status(env.initial_tenant)\n254     assert TenantId(status[\"id\"]) == env.initial_tenant\n255     assert set(TimelineId(t) for t in status[\"timelines\"]) == {\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 254,
      "line_range": [
        254
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "254     assert TenantId(status[\"id\"]) == env.initial_tenant\n255     assert set(TimelineId(t) for t in status[\"timelines\"]) == {\n256         env.initial_timeline,\n257     }\n258     assert status[\"state\"][\"slug\"] == \"Active\"\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 255,
      "line_range": [
        255,
        256,
        257
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "257     }\n258     assert status[\"state\"][\"slug\"] == \"Active\"\n259 \n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 258,
      "line_range": [
        258
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "260     (synthetic_size, size_inputs) = client.tenant_size_and_modelinputs(env.initial_tenant)\n261     assert synthetic_size > 0\n262     assert \"segments\" in size_inputs\n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 261,
      "line_range": [
        261
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "261     assert synthetic_size > 0\n262     assert \"segments\" in size_inputs\n263 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 262,
      "line_range": [
        262
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "283     # Tenant A should still be attached\n284     assert tenant_a not in observed\n285 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 284,
      "line_range": [
        284
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "286     # Tenant B should remain detached\n287     assert tenant_b in observed\n288 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 287,
      "line_range": [
        287
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "294     observed = set(TenantId(tenant[\"id\"]) for tenant in env.pageserver.http_client().tenant_list())\n295     assert tenant_a not in observed\n296     assert tenant_b in observed\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 295,
      "line_range": [
        295
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "295     assert tenant_a not in observed\n296     assert tenant_b in observed\n297 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 296,
      "line_range": [
        296
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "351     )\n352     assert len(r[\"shards\"]) == 1\n353 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 352,
      "line_range": [
        352
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "384     )\n385     assert len(r[\"shards\"]) == 1\n386 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 385,
      "line_range": [
        385
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "392         # it had a secondary location, otherwise there was no point warming it up\n393         assert dest_ps_id == warm_up_ps\n394 \n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 393,
      "line_range": [
        393
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "395         # It should have been given a new secondary location as well\n396         assert len(describe[\"node_secondary\"]) == 1\n397         assert describe[\"node_secondary\"][0] != warm_up_ps\n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 396,
      "line_range": [
        396
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "396         assert len(describe[\"node_secondary\"]) == 1\n397         assert describe[\"node_secondary\"][0] != warm_up_ps\n398 \n",
      "col_offset": 8,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 397,
      "line_range": [
        397
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "422     )\n423     assert len(r[\"shards\"]) == 1\n424 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 423,
      "line_range": [
        423
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "427     origin_tenants = origin_ps.http_client().tenant_list()\n428     assert len(origin_tenants) == 0\n429     dest_tenants = dest_ps.http_client().tenant_list()\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 428,
      "line_range": [
        428
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "429     dest_tenants = dest_ps.http_client().tenant_list()\n430     assert len(dest_tenants) == 1\n431     assert TenantId(dest_tenants[0][\"id\"]) == tenant_id\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 430,
      "line_range": [
        430
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "430     assert len(dest_tenants) == 1\n431     assert TenantId(dest_tenants[0][\"id\"]) == tenant_id\n432 \n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 431,
      "line_range": [
        431
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "435     # was properly carried over during onboarding.\n436     assert dest_tenants[0][\"generation\"] == generation + 1\n437 \n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 436,
      "line_range": [
        436
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "451     # The generation has moved on since we onboarded\n452     assert generation != dest_tenant_before_conf_change[\"generation\"]\n453 \n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 452,
      "line_range": [
        452
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "463     )\n464     assert len(r[\"shards\"]) == 1\n465     dest_tenant_after_conf_change = dest_ps.http_client().tenant_status(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 464,
      "line_range": [
        464
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "465     dest_tenant_after_conf_change = dest_ps.http_client().tenant_status(tenant_id)\n466     assert (\n467         dest_tenant_after_conf_change[\"generation\"] == dest_tenant_before_conf_change[\"generation\"]\n468     )\n469     dest_tenant_conf_after = dest_ps.http_client().tenant_config(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 466,
      "line_range": [
        466,
        467,
        468
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "472     del dest_tenant_conf_after.tenant_specific_overrides[\"heatmap_period\"]\n473     assert dest_tenant_conf_after.tenant_specific_overrides == modified_tenant_conf\n474 \n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 473,
      "line_range": [
        473
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "509     # Initial notification from tenant creation\n510     assert len(notifications) == 1\n511     expect: dict[str, Union[list[dict[str, int]], str, None, int]] = {\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 510,
      "line_range": [
        510
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "515     }\n516     assert notifications[0] == expect\n517 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 516,
      "line_range": [
        516
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "521         counts = get_node_shard_counts(env, [env.initial_tenant])\n522         assert counts[node_id] == 0\n523 \n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 522,
      "line_range": [
        522
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "534     def received_migration_notification():\n535         assert len(notifications) == 2\n536         assert notifications[1] == expect\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 535,
      "line_range": [
        535
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "535         assert len(notifications) == 2\n536         assert notifications[1] == expect\n537 \n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 536,
      "line_range": [
        536
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "544     def received_restart_notification():\n545         assert len(notifications) == 3\n546         assert notifications[2] == expect\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 545,
      "line_range": [
        545
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "545         assert len(notifications) == 3\n546         assert notifications[2] == expect\n547 \n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 546,
      "line_range": [
        546
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "561     def received_split_notification():\n562         assert len(notifications) == 4\n563         assert notifications[3] == expect\n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 562,
      "line_range": [
        562
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "562         assert len(notifications) == 4\n563         assert notifications[3] == expect\n564 \n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 563,
      "line_range": [
        563
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "581     env.storage_controller.allowed_errors.append(\".*Reconcile error.*tenant busy.*\")\n582     assert notifications[-1] is not None\n583     assert notifications[-1][\"tenant_id\"] == str(degraded_tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 582,
      "line_range": [
        582
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "582     assert notifications[-1] is not None\n583     assert notifications[-1][\"tenant_id\"] == str(degraded_tenant_id)\n584 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 583,
      "line_range": [
        583
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "624     # Initial notification from tenant creation\n625     assert len(notifications) == 1\n626     expect: dict[str, Union[list[dict[str, int]], str, None, int]] = {\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 625,
      "line_range": [
        625
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "630     }\n631     assert notifications[0] == expect\n632 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 631,
      "line_range": [
        631
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "655         contains_r = env.storage_controller.log_contains(NOTIFY_BLOCKED_LOG)\n656         assert contains_r is not None  # Appease mypy\n657         (_, log_cursor) = contains_r\n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 656,
      "line_range": [
        656
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "657         (_, log_cursor) = contains_r\n658         assert migrate_fut.running()\n659 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 658,
      "line_range": [
        658
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "682         wait_until(10, 0.25, logged_stuck_again)\n683         assert migrate_fut.running()\n684 \n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 683,
      "line_range": [
        683
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "696             # thing is that it finishes, rather than getting stuck in the compute notify loop.\n697             assert \"Reconcile error\" in str(e)\n698 \n",
      "col_offset": 12,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 697,
      "line_range": [
        697
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "706             # the internal flag set for \"retry compute notification later\"\n707             assert \"Control plane tenant busy\" in str(e)\n708 \n",
      "col_offset": 12,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 707,
      "line_range": [
        707
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "710         loc = origin_pageserver.http_client().tenant_get_location(shard_0_id)\n711         assert loc[\"mode\"] == \"AttachedSingle\"\n712 \n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 711,
      "line_range": [
        711
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "718             # Compute hook is still blocked: reconciler will configure PS but not fully succeed\n719             assert \"Control plane tenant busy\" in str(e)\n720 \n",
      "col_offset": 12,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 719,
      "line_range": [
        719
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "778         log.info(f\"Waiting for {ps_id}, have {latest}\")\n779         assert latest is not None\n780         assert latest[\"shards\"] is not None\n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 779,
      "line_range": [
        779
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "779         assert latest is not None\n780         assert latest[\"shards\"] is not None\n781         assert latest[\"shards\"][0][\"node_id\"] == ps_id\n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 780,
      "line_range": [
        780
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "780         assert latest[\"shards\"] is not None\n781         assert latest[\"shards\"][0][\"node_id\"] == ps_id\n782 \n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 781,
      "line_range": [
        781
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "800     # Although the migration API failed, the tenant should still have moved to the right pageserver\n801     assert len(pageserver_b.http_client().tenant_list()) == 1\n802 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 801,
      "line_range": [
        801
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "863     )\n864     assert len(response.json()) == 3\n865 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 864,
      "line_range": [
        864
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "870     # Two nodes, in a dict of node_id->node\n871     assert len(response.json()[\"nodes\"]) == 2\n872     assert sum(v[\"shard_count\"] for v in response.json()[\"nodes\"].values()) == 3\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 871,
      "line_range": [
        871
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "871     assert len(response.json()[\"nodes\"]) == 2\n872     assert sum(v[\"shard_count\"] for v in response.json()[\"nodes\"].values()) == 3\n873     assert all(v[\"may_schedule\"] for v in response.json()[\"nodes\"].values())\n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 872,
      "line_range": [
        872
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "872     assert sum(v[\"shard_count\"] for v in response.json()[\"nodes\"].values()) == 3\n873     assert all(v[\"may_schedule\"] for v in response.json()[\"nodes\"].values())\n874 \n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 873,
      "line_range": [
        873
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "879     )\n880     assert len(env.storage_controller.node_list()) == 1\n881 \n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 880,
      "line_range": [
        880
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "893     )\n894     assert len(response.json()) == 1\n895 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 894,
      "line_range": [
        894
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "915         remote_storage = neon_env_builder.pageserver_remote_storage\n916         assert remote_storage, \"remote storage not configured\"\n917         enable_remote_storage_versioning(remote_storage)\n",
      "col_offset": 8,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 916,
      "line_range": [
        916
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "961     # Simulate a \"disaster\": delete some random files from remote storage for one of the shards\n962     assert env.pageserver_remote_storage\n963     shard_id_for_list = \"0002\"\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 962,
      "line_range": [
        962
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "967     ).get(\"Contents\", [])\n968     assert len(objects) > 1\n969     log.info(f\"Found {len(objects)} objects in remote storage\")\n",
      "col_offset": 4,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 968,
      "line_range": [
        968
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1093     readback_controller = http.tenant_config(tenant_id)\n1094     assert readback_controller.effective_config[\"pitr_interval\"] == new_value\n1095     assert readback_controller.tenant_specific_overrides[\"pitr_interval\"] == new_value\n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1094,
      "line_range": [
        1094
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1094     assert readback_controller.effective_config[\"pitr_interval\"] == new_value\n1095     assert readback_controller.tenant_specific_overrides[\"pitr_interval\"] == new_value\n1096 \n",
      "col_offset": 4,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1095,
      "line_range": [
        1095
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1098     readback_ps = env.pageservers[0].http_client().tenant_config(tenant_id)\n1099     assert readback_ps.effective_config[\"pitr_interval\"] == new_value\n1100     assert readback_ps.tenant_specific_overrides[\"pitr_interval\"] == new_value\n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1099,
      "line_range": [
        1099
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1099     assert readback_ps.effective_config[\"pitr_interval\"] == new_value\n1100     assert readback_ps.tenant_specific_overrides[\"pitr_interval\"] == new_value\n1101 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1100,
      "line_range": [
        1100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1105     readback_controller = http.tenant_config(tenant_id)\n1106     assert readback_controller.effective_config[\"pitr_interval\"] is None\n1107     assert readback_controller.tenant_specific_overrides[\"pitr_interval\"] is None\n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1106,
      "line_range": [
        1106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1106     assert readback_controller.effective_config[\"pitr_interval\"] is None\n1107     assert readback_controller.tenant_specific_overrides[\"pitr_interval\"] is None\n1108     readback_ps = env.pageservers[0].http_client().tenant_config(tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1107,
      "line_range": [
        1107
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1108     readback_ps = env.pageservers[0].http_client().tenant_config(tenant_id)\n1109     assert readback_ps.effective_config[\"pitr_interval\"] == default_value\n1110     assert \"pitr_interval\" not in readback_ps.tenant_specific_overrides\n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1109,
      "line_range": [
        1109
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1109     assert readback_ps.effective_config[\"pitr_interval\"] == default_value\n1110     assert \"pitr_interval\" not in readback_ps.tenant_specific_overrides\n1111 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1110,
      "line_range": [
        1110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1147         pageserver = env.get_tenant_pageserver(shard_id)\n1148         assert pageserver.tenant_dir(shard_id).exists()\n1149 \n",
      "col_offset": 8,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1148,
      "line_range": [
        1148
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1174         for shard_id in shard_ids:\n1175             assert not pageserver.tenant_dir(shard_id).exists()\n1176 \n",
      "col_offset": 12,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1175,
      "line_range": [
        1175
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1333     nodes = env.storage_controller.node_list()\n1334     assert len(nodes) == 2\n1335     assert all([n[\"availability\"] == \"Active\" for n in nodes])\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1334,
      "line_range": [
        1334
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1334     assert len(nodes) == 2\n1335     assert all([n[\"availability\"] == \"Active\" for n in nodes])\n1336 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1335,
      "line_range": [
        1335
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1357         # Check that all the tenants have been attached\n1358         assert sum(len(ts) for ts in node_to_tenants.values()) == len(tenant_ids)\n1359         # Check that each node got one tenant\n",
      "col_offset": 8,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1358,
      "line_range": [
        1358
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1359         # Check that each node got one tenant\n1360         assert all(len(ts) == 1 for ts in node_to_tenants.values())\n1361 \n",
      "col_offset": 8,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1360,
      "line_range": [
        1360
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1381             if node[\"id\"] in offline_node_ids:\n1382                 assert node[\"availability\"] == \"Offline\"\n1383 \n",
      "col_offset": 16,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1382,
      "line_range": [
        1382
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1388 \n1389     assert detected_after >= failure.must_detect_after\n1390 \n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1389,
      "line_range": [
        1389
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1403 \n1404         assert observed_tenants == set(tenant_ids)\n1405 \n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1404,
      "line_range": [
        1404
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1415             if node[\"id\"] in online_node_ids:\n1416                 assert node[\"availability\"] == \"Active\"\n1417 \n",
      "col_offset": 16,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1416,
      "line_range": [
        1416
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1464         log.info(f\"locations: {locations}\")\n1465         assert len(locations) == 2\n1466         assert all(loc[1][\"mode\"] == \"AttachedSingle\" for loc in locations)\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1465,
      "line_range": [
        1465
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1465         assert len(locations) == 2\n1466         assert all(loc[1][\"mode\"] == \"AttachedSingle\" for loc in locations)\n1467 \n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1466,
      "line_range": [
        1466
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1482     locations = victim_ps.http_client().tenant_list_locations()[\"tenant_shards\"]\n1483     assert len(locations) == 2\n1484     assert all(loc[1][\"mode\"] == \"Secondary\" for loc in locations)\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1483,
      "line_range": [
        1483
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1483     assert len(locations) == 2\n1484     assert all(loc[1][\"mode\"] == \"Secondary\" for loc in locations)\n1485 \n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1484,
      "line_range": [
        1484
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1490     )\n1491     assert reconciles_after_restart == reconciles_before_restart\n1492 \n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1491,
      "line_range": [
        1491
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1545         e = reconcile_errors()\n1546         assert e > n\n1547         return e\n",
      "col_offset": 8,
      "end_col_offset": 20,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1546,
      "line_range": [
        1546
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1565     env.storage_controller.reconcile_all()\n1566     assert reconcile_errors() == errs\n1567 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1566,
      "line_range": [
        1566
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1578         o = reconcile_ok()\n1579         assert o > n\n1580         return o\n",
      "col_offset": 8,
      "end_col_offset": 20,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1579,
      "line_range": [
        1579
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1585     # And indeed the tenant should be attached\n1586     assert len(env.pageserver.http_client().tenant_list_locations()[\"tenant_shards\"]) == 1\n1587 \n",
      "col_offset": 4,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1586,
      "line_range": [
        1586
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1619 \n1620         assert stdout is not None\n1621         return [line.strip() for line in stdout.split(\"\\n\") if line.strip()]\n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1620,
      "line_range": [
        1620
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1625     # Table header, footer, and one line of data\n1626     assert len(node_lines) == 5\n1627     assert \"localhost\" in node_lines[3]\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1626,
      "line_range": [
        1626
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1626     assert len(node_lines) == 5\n1627     assert \"localhost\" in node_lines[3]\n1628 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1627,
      "line_range": [
        1627
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1630     storcon_cli([\"node-configure\", \"--node-id\", \"1\", \"--scheduling\", \"pause\"])\n1631     assert \"Pause\" in storcon_cli([\"nodes\"])[3]\n1632 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1631,
      "line_range": [
        1631
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1641     storcon_cli([\"node-configure\", \"--node-id\", \"1\", \"--availability\", \"offline\"])\n1642     assert \"Offline\" in storcon_cli([\"nodes\"])[3]\n1643 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1642,
      "line_range": [
        1642
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1645     tenant_lines = storcon_cli([\"tenants\"])\n1646     assert len(tenant_lines) == 5\n1647     assert str(env.initial_tenant) in tenant_lines[3]\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1646,
      "line_range": [
        1646
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1646     assert len(tenant_lines) == 5\n1647     assert str(env.initial_tenant) in tenant_lines[3]\n1648 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1647,
      "line_range": [
        1647
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1655     tenant_lines = storcon_cli([\"tenant-describe\", \"--tenant-id\", str(env.initial_tenant)])\n1656     assert len(tenant_lines) == 3 + shard_count * 2\n1657     assert str(env.initial_tenant) in tenant_lines[3]\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1656,
      "line_range": [
        1656
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1656     assert len(tenant_lines) == 3 + shard_count * 2\n1657     assert str(env.initial_tenant) in tenant_lines[3]\n1658 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1657,
      "line_range": [
        1657
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1660     storcon_cli([\"tenant-policy\", \"--tenant-id\", str(env.initial_tenant), \"--scheduling\", \"stop\"])\n1661     assert \"Stop\" in storcon_cli([\"tenants\"])[3]\n1662 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1661,
      "line_range": [
        1661
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1666     )\n1667     assert \"Secondary\" in storcon_cli([\"tenants\"])[3]\n1668 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1667,
      "line_range": [
        1667
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1815     literal_shard_count = 1 if shard_count is None else shard_count\n1816     assert len(describe[\"shards\"]) == literal_shard_count\n1817 \n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1816,
      "line_range": [
        1816
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1818     nodes = env.storage_controller.nodes()\n1819     assert len(nodes) == 2\n1820     describe1 = env.storage_controller.node_shards(nodes[0][\"id\"])\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1819,
      "line_range": [
        1819
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1821     describe2 = env.storage_controller.node_shards(nodes[1][\"id\"])\n1822     assert len(describe1[\"shards\"]) + len(describe2[\"shards\"]) == literal_shard_count\n1823 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1822,
      "line_range": [
        1822
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1860     nodes = env.storage_controller.node_list()\n1861     assert len(nodes) == 2\n1862 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1861,
      "line_range": [
        1861
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1864         # Assert that all nodes have some attached shards\n1865         assert len(shard_counts) == len(env.pageservers)\n1866 \n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1865,
      "line_range": [
        1865
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1870         flake_factor = 5 / 100\n1871         assert max_shard_count - min_shard_count <= int(total_shards * flake_factor)\n1872 \n",
      "col_offset": 8,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1871,
      "line_range": [
        1871
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1890         # Assert that we've drained the node\n1891         assert shard_counts[ps.id] == 0\n1892         # Assert that those shards actually went somewhere\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1891,
      "line_range": [
        1891
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1892         # Assert that those shards actually went somewhere\n1893         assert sum(shard_counts.values()) == total_shards\n1894 \n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1893,
      "line_range": [
        1893
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1945     locations = env.storage_controller.locate(tid)\n1946     assert len(locations) == 1\n1947     primary: int = locations[0][\"node_id\"]\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1946,
      "line_range": [
        1946
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1948     not_primary = [ps.id for ps in env.pageservers if ps.id != primary]\n1949     assert len(not_primary) == 1\n1950     secondary = not_primary[0]\n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1949,
      "line_range": [
        1949
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1992     locations = env.storage_controller.locate(tid)\n1993     assert len(locations) == 1\n1994     assert locations[0][\"node_id\"] == primary\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1993,
      "line_range": [
        1993
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1993     assert len(locations) == 1\n1994     assert locations[0][\"node_id\"] == primary\n1995 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1994,
      "line_range": [
        1994
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2029     locations = env.storage_controller.locate(tid)\n2030     assert len(locations) == 1\n2031     assert locations[0][\"node_id\"] == secondary\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2030,
      "line_range": [
        2030
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2030     assert len(locations) == 1\n2031     assert locations[0][\"node_id\"] == secondary\n2032 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2031,
      "line_range": [
        2031
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2053     nodes = env.storage_controller.node_list()\n2054     assert len(nodes) == 2\n2055 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2054,
      "line_range": [
        2054
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2128             log.info(f\"Shards on nodes other than on victim: {elsewhere}\")\n2129             assert elsewhere == tenant_count * shard_count_per_tenant\n2130 \n",
      "col_offset": 12,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2129,
      "line_range": [
        2129
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2141             log.info(f\"Shards on node {victim.id}: {count}\")\n2142             assert count == 0\n2143 \n",
      "col_offset": 12,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2142,
      "line_range": [
        2142
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2146     # The node should be gone from the list API\n2147     assert victim.id not in [n[\"id\"] for n in env.storage_controller.node_list()]\n2148 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2147,
      "line_range": [
        2147
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2152         for shard in describe[\"shards\"]:\n2153             assert shard[\"node_attached\"] != victim.id\n2154             assert victim.id not in shard[\"node_secondary\"]\n",
      "col_offset": 12,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2153,
      "line_range": [
        2153
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2153             assert shard[\"node_attached\"] != victim.id\n2154             assert victim.id not in shard[\"node_secondary\"]\n2155 \n",
      "col_offset": 12,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2154,
      "line_range": [
        2154
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2169     env.storage_controller.start()\n2170     assert victim.id not in [n[\"id\"] for n in env.storage_controller.node_list()]\n2171     env.storage_controller.reconcile_all()  # FIXME: workaround for optimizations happening on startup, see FIXME above.\n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2170,
      "line_range": [
        2170
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2247     # Metadata health table also updated as tenant shards are created.\n2248     assert env.storage_controller.metadata_health_is_healthy()\n2249 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2248,
      "line_range": [
        2248
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2256     log.info(f\"After Phase 1: {unhealthy=}, {outdated=}\")\n2257     assert len(unhealthy) == len(tenant_b_shard_ids)\n2258     for t in tenant_b_shard_ids:\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2257,
      "line_range": [
        2257
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2258     for t in tenant_b_shard_ids:\n2259         assert str(t) in unhealthy\n2260     assert len(outdated) == 0\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2259,
      "line_range": [
        2259
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2259         assert str(t) in unhealthy\n2260     assert len(outdated) == 0\n2261 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2260,
      "line_range": [
        2260
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2266     log.info(f\"After Phase 2: {unhealthy=}, {outdated=}\")\n2267     assert len(unhealthy) == 0\n2268     assert len(outdated) == 0\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2267,
      "line_range": [
        2267
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2267     assert len(unhealthy) == 0\n2268     assert len(outdated) == 0\n2269 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2268,
      "line_range": [
        2268
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2274     log.info(f\"After Phase 3: {unhealthy=}, {outdated=}\")\n2275     assert len(unhealthy) == len(tenant_a_shard_ids)\n2276     for t in tenant_a_shard_ids:\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2275,
      "line_range": [
        2275
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2276     for t in tenant_a_shard_ids:\n2277         assert str(t) in unhealthy\n2278     assert len(outdated) == 0\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2277,
      "line_range": [
        2277
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2277         assert str(t) in unhealthy\n2278     assert len(outdated) == 0\n2279 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2278,
      "line_range": [
        2278
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2283     # A's unhealthy metadata health status should be deleted as well.\n2284     assert env.storage_controller.metadata_health_is_healthy()\n2285 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2284,
      "line_range": [
        2284
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2289     )\n2290     assert len(unhealthy) == 0\n2291     for t in tenant_b_shard_ids + tenant_c_shard_ids:\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2290,
      "line_range": [
        2290
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2291     for t in tenant_b_shard_ids + tenant_c_shard_ids:\n2292         assert str(t) in outdated\n2293 \n",
      "col_offset": 8,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2292,
      "line_range": [
        2292
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2326     node_id = str(env.pageserver.id)\n2327     assert tsid in observed_state\n2328     assert node_id in observed_state[tsid][\"locations\"]\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2327,
      "line_range": [
        2327
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2327     assert tsid in observed_state\n2328     assert node_id in observed_state[tsid][\"locations\"]\n2329     assert \"conf\" in observed_state[tsid][\"locations\"][node_id]\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2328,
      "line_range": [
        2328
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2328     assert node_id in observed_state[tsid][\"locations\"]\n2329     assert \"conf\" in observed_state[tsid][\"locations\"][node_id]\n2330     assert \"tenant_conf\" in observed_state[tsid][\"locations\"][node_id][\"conf\"]\n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2329,
      "line_range": [
        2329
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2329     assert \"conf\" in observed_state[tsid][\"locations\"][node_id]\n2330     assert \"tenant_conf\" in observed_state[tsid][\"locations\"][node_id][\"conf\"]\n2331 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2330,
      "line_range": [
        2330
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2332     tenant_conf = observed_state[tsid][\"locations\"][node_id][\"conf\"][\"tenant_conf\"]\n2333     assert \"compaction_threshold\" in tenant_conf\n2334     assert tenant_conf[\"compaction_threshold\"] == 5\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2333,
      "line_range": [
        2333
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2333     assert \"compaction_threshold\" in tenant_conf\n2334     assert tenant_conf[\"compaction_threshold\"] == 5\n2335 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2334,
      "line_range": [
        2334
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2337     ps_tenant_conf = env.pageserver.http_client().tenant_config(tid)\n2338     assert \"compaction_threshold\" in ps_tenant_conf.effective_config\n2339     assert ps_tenant_conf.effective_config[\"compaction_threshold\"] == 5\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2338,
      "line_range": [
        2338
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2338     assert \"compaction_threshold\" in ps_tenant_conf.effective_config\n2339     assert ps_tenant_conf.effective_config[\"compaction_threshold\"] == 5\n2340 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2339,
      "line_range": [
        2339
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2348     observed_state_again = env.storage_controller.step_down()\n2349     assert observed_state == observed_state_again\n2350 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2349,
      "line_range": [
        2349
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2350 \n2351     assert (\n2352         env.storage_controller.get_metric_value(\n2353             \"storage_controller_leadership_status\", filter={\"status\": \"leader\"}\n2354         )\n2355         == 0\n2356     )\n2357 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2351,
      "line_range": [
        2351,
        2352,
        2353,
        2354,
        2355,
        2356
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2357 \n2358     assert (\n2359         env.storage_controller.get_metric_value(\n2360             \"storage_controller_leadership_status\", filter={\"status\": \"stepped_down\"}\n2361         )\n2362         == 1\n2363     )\n2364 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2358,
      "line_range": [
        2358,
        2359,
        2360,
        2361,
        2362,
        2363
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2364 \n2365     assert (\n2366         env.storage_controller.get_metric_value(\n2367             \"storage_controller_leadership_status\", filter={\"status\": \"candidate\"}\n2368         )\n2369         == 0\n2370     )\n2371 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2365,
      "line_range": [
        2365,
        2366,
        2367,
        2368,
        2369,
        2370
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2438 \n2439     assert (\n2440         env.storage_controller.get_leadership_status() == StorageControllerLeadershipStatus.LEADER\n2441     )\n2442     leader = env.storage_controller.get_leader()\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2439,
      "line_range": [
        2439,
        2440,
        2441
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2442     leader = env.storage_controller.get_leader()\n2443     assert leader[\"address\"] == f\"http://127.0.0.1:{storage_controller_1_port}/\"\n2444 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2443,
      "line_range": [
        2443
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2467         def previous_stepped_down():\n2468             assert (\n2469                 env.storage_controller.get_leadership_status()\n2470                 == StorageControllerLeadershipStatus.STEPPED_DOWN\n2471             )\n2472 \n",
      "col_offset": 12,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2468,
      "line_range": [
        2468,
        2469,
        2470,
        2471
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2477     def new_becomes_leader():\n2478         assert (\n2479             env.storage_controller.get_leadership_status()\n2480             == StorageControllerLeadershipStatus.LEADER\n2481         )\n2482 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2478,
      "line_range": [
        2478,
        2479,
        2480,
        2481
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2484     leader = env.storage_controller.get_leader()\n2485     assert leader[\"address\"] == f\"http://127.0.0.1:{storage_controller_2_port}/\"\n2486 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2485,
      "line_range": [
        2485
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2496         status = env.storage_controller.node_status(env.pageservers[0].id)\n2497         assert status[\"scheduling\"] == \"Pause\"\n2498 \n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2497,
      "line_range": [
        2497
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2522         details = env.storage_controller.node_status(attached.id)\n2523         assert details[\"scheduling\"] == \"Draining\"\n2524 \n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2523,
      "line_range": [
        2523
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2590         def has_hit_failpoint():\n2591             assert any(\n2592                 ps.log_contains(f\"at failpoint {failpoint}\") is not None for ps in env.pageservers\n2593             )\n2594 \n",
      "col_offset": 12,
      "end_col_offset": 13,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2591,
      "line_range": [
        2591,
        2592,
        2593
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2675             def has_hit_compaction_failpoint():\n2676                 assert origin_pageserver.log_contains(f\"at failpoint {compaction_failpoint}\")\n2677 \n",
      "col_offset": 16,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2676,
      "line_range": [
        2676
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2690             def has_hit_migration_failpoint():\n2691                 assert env.storage_controller.log_contains(f\"at failpoint {migration_failpoint}\")\n2692 \n",
      "col_offset": 16,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2691,
      "line_range": [
        2691
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2724         log.info(f\"scrubbed, healthy={healthy}\")\n2725         assert healthy\n2726     except:\n",
      "col_offset": 8,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2725,
      "line_range": [
        2725
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2789     def long_migration_metric_published():\n2790         assert (\n2791             env.storage_controller.get_metric_value(\n2792                 \"storage_controller_reconcile_long_running_total\",\n2793                 filter={\"tenant_id\": str(tenant_id), \"shard_number\": \"0\"},\n2794             )\n2795             == 1\n2796         )\n2797 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2790,
      "line_range": [
        2790,
        2791,
        2792,
        2793,
        2794,
        2795,
        2796
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2798     def assert_long_migration_metric_not_published():\n2799         assert (\n2800             env.storage_controller.get_metric_value(\n2801                 \"storage_controller_reconcile_long_running_total\",\n2802                 filter={\"tenant_id\": str(tenant_id), \"shard_number\": \"0\"},\n2803             )\n2804             is None\n2805         )\n2806 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2799,
      "line_range": [
        2799,
        2800,
        2801,
        2802,
        2803,
        2804,
        2805
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2817                 log.info(expr)\n2818                 assert env.storage_controller.log_contains(expr)\n2819 \n",
      "col_offset": 16,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2818,
      "line_range": [
        2818
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2831                 # We expect request to land on the destination\n2832                 assert tenant_info[\"generation\"] == 2\n2833             elif migration_failpoint == MigrationFailpoints.PRE_GENERATION_INC:\n",
      "col_offset": 16,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2832,
      "line_range": [
        2832
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2834                 # We expect request to land on the origin\n2835                 assert tenant_info[\"generation\"] == 1\n2836 \n",
      "col_offset": 16,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2835,
      "line_range": [
        2835
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2859 \n2860     assert target.get_safekeeper(fake_id) is None\n2861 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2860,
      "line_range": [
        2860
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2877     inserted = target.get_safekeeper(fake_id)\n2878     assert inserted is not None\n2879     assert eq_safekeeper_records(body, inserted)\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2878,
      "line_range": [
        2878
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2878     assert inserted is not None\n2879     assert eq_safekeeper_records(body, inserted)\n2880 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2879,
      "line_range": [
        2879
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2884         different_pk[\"id\"] = 4\n2885         assert different_pk[\"id\"] != body[\"id\"]\n2886         target.on_safekeeper_deploy(fake_id, different_pk)\n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2885,
      "line_range": [
        2885
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2886         target.on_safekeeper_deploy(fake_id, different_pk)\n2887     assert exc.value.status_code == 400\n2888 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2887,
      "line_range": [
        2887
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2889     inserted_again = target.get_safekeeper(fake_id)\n2890     assert inserted_again is not None\n2891     assert eq_safekeeper_records(inserted, inserted_again)\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2890,
      "line_range": [
        2890
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2890     assert inserted_again is not None\n2891     assert eq_safekeeper_records(inserted, inserted_again)\n2892 \n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2891,
      "line_range": [
        2891
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2893     # the most common case, version goes up:\n2894     assert isinstance(body[\"version\"], int)\n2895     body[\"version\"] += 1\n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2894,
      "line_range": [
        2894
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2897     inserted_now = target.get_safekeeper(fake_id)\n2898     assert inserted_now is not None\n2899 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2898,
      "line_range": [
        2898
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2899 \n2900     assert eq_safekeeper_records(body, inserted_now)\n2901 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2900,
      "line_range": [
        2900
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2932         shards = env.storage_controller.tenant_describe(tid)[\"shards\"]\n2933         assert len(shards) == 1\n2934         attached_to = shards[0][\"node_attached\"]\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2933,
      "line_range": [
        2933
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2936 \n2937         assert shards[0][\"preferred_az_id\"] == expected_az\n2938 \n",
      "col_offset": 8,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2937,
      "line_range": [
        2937
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2942 \n2943     assert set(updated) == set([TenantShardId(tid, 0, 0) for tid in tids])\n2944 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2943,
      "line_range": [
        2943
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2946         shards = env.storage_controller.tenant_describe(tid)[\"shards\"]\n2947         assert len(shards) == 1\n2948         assert shards[0][\"preferred_az_id\"] == \"foo\"\n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2947,
      "line_range": [
        2947
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2947         assert len(shards) == 1\n2948         assert shards[0][\"preferred_az_id\"] == \"foo\"\n2949 \n",
      "col_offset": 8,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2948,
      "line_range": [
        2948
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2961     shards = env.storage_controller.tenant_describe(tids[0])[\"shards\"]\n2962     assert len(shards) == 2\n2963     for shard in shards:\n",
      "col_offset": 4,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2962,
      "line_range": [
        2962
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2965         expected_az = env.get_pageserver(attached_to).az_id\n2966         assert shard[\"preferred_az_id\"] == expected_az\n2967 \n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2966,
      "line_range": [
        2966
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2993 \n2994     assert locations[\"observed\"] == locations[\"intent\"]\n2995     assert locations[\"observed\"][\"attached\"] is not None\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2994,
      "line_range": [
        2994
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2994     assert locations[\"observed\"] == locations[\"intent\"]\n2995     assert locations[\"observed\"][\"attached\"] is not None\n2996     assert len(locations[\"observed\"][\"secondary\"]) > 0\n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2995,
      "line_range": [
        2995
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2995     assert locations[\"observed\"][\"attached\"] is not None\n2996     assert len(locations[\"observed\"][\"secondary\"]) > 0\n2997 \n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2996,
      "line_range": [
        2996
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3013                 log.info(expr)\n3014                 assert env.storage_controller.log_contains(expr)\n3015 \n",
      "col_offset": 16,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3014,
      "line_range": [
        3014
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3028                 env.get_pageserver(attached_location).http_client().timeline_list(tenant_id)\n3029             assert exc.value.status_code == 404\n3030 \n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3029,
      "line_range": [
        3029
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3032             client = env.get_pageserver(secondary_location).http_client()\n3033             assert timeline_id not in {\n3034                 TimelineId(b[\"timeline_id\"]) for b in client.timeline_list(tenant_id)\n3035             }, f\"deleted timeline found on {secondary_location}\"\n3036 \n",
      "col_offset": 12,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3033,
      "line_range": [
        3033,
        3034,
        3035
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3062 \n3063     assert locations[\"observed\"] == locations[\"intent\"]\n3064     assert locations[\"observed\"][\"attached\"] is not None\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3063,
      "line_range": [
        3063
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3063     assert locations[\"observed\"] == locations[\"intent\"]\n3064     assert locations[\"observed\"][\"attached\"] is not None\n3065     assert len(locations[\"observed\"][\"secondary\"]) > 0\n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3064,
      "line_range": [
        3064
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3064     assert locations[\"observed\"][\"attached\"] is not None\n3065     assert len(locations[\"observed\"][\"secondary\"]) > 0\n3066 \n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3065,
      "line_range": [
        3065
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3082                 log.info(expr)\n3083                 assert env.storage_controller.log_contains(expr)\n3084 \n",
      "col_offset": 16,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3083,
      "line_range": [
        3083
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3094                 client = env.get_pageserver(attached_location).http_client()\n3095                 assert timeline_id in {\n3096                     TimelineId(b[\"timeline_id\"]) for b in client.timeline_list(tenant_id)\n3097                 }, f\"new timeline not found on {attached_location}\"\n3098 \n",
      "col_offset": 16,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3095,
      "line_range": [
        3095,
        3096,
        3097
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3100                     env.get_pageserver(secondary_location).http_client().timeline_list(tenant_id)\n3101                 assert exc.value.status_code == 404\n3102 \n",
      "col_offset": 16,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3101,
      "line_range": [
        3101
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3106                     client = env.get_pageserver(node_id).http_client()\n3107                     assert timeline_id in {\n3108                         TimelineId(b[\"timeline_id\"]) for b in client.timeline_list(tenant_id)\n3109                     }, f\"new timeline not found on {node_id}\"\n3110 \n",
      "col_offset": 20,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3107,
      "line_range": [
        3107,
        3108,
        3109
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3114                 client = env.get_pageserver(secondary_location).http_client()\n3115                 assert timeline_id in {\n3116                     TimelineId(b[\"timeline_id\"]) for b in client.timeline_list(tenant_id)\n3117                 }, f\"new timeline not found on {attached_location}\"\n3118 \n",
      "col_offset": 16,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3115,
      "line_range": [
        3115,
        3116,
        3117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3120                     env.get_pageserver(attached_location).http_client().timeline_list(tenant_id)\n3121                 assert exc.value.status_code == 404\n3122 \n",
      "col_offset": 16,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3121,
      "line_range": [
        3121
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "3129                 env.get_pageserver(attached_location).http_client().timeline_list(tenant_id)\n3130             assert exc.value.status_code == 404\n3131     except:\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_controller.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 3130,
      "line_range": [
        3130
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "76 \n77     assert len(os.listdir(output_path)) > 0\n78 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 77,
      "line_range": [
        77
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "90     # Replace remote storage contents with the snapshot we downloaded\n91     assert isinstance(env.pageserver_remote_storage, S3Storage)\n92 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 91,
      "line_range": [
        91
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104         deleted += 1\n105     assert deleted > 0\n106 \n",
      "col_offset": 4,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 105,
      "line_range": [
        105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "164     gc_summary = env.storage_scrubber.pageserver_physical_gc(min_age_secs=3600)\n165     assert gc_summary[\"remote_storage_errors\"] == 0\n166     assert gc_summary[\"indices_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 165,
      "line_range": [
        165
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "165     assert gc_summary[\"remote_storage_errors\"] == 0\n166     assert gc_summary[\"indices_deleted\"] == 0\n167 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 166,
      "line_range": [
        166
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "171     )\n172     assert gc_summary[\"remote_storage_errors\"] == 0\n173     assert gc_summary[\"indices_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 172,
      "line_range": [
        172
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "172     assert gc_summary[\"remote_storage_errors\"] == 0\n173     assert gc_summary[\"indices_deleted\"] == 0\n174 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 173,
      "line_range": [
        173
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "176     gc_summary = env.storage_scrubber.pageserver_physical_gc(min_age_secs=1)\n177     assert gc_summary[\"remote_storage_errors\"] == 0\n178     assert gc_summary[\"indices_deleted\"] == (expect_indices_per_shard - 2) * shard_count\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 177,
      "line_range": [
        177
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "177     assert gc_summary[\"remote_storage_errors\"] == 0\n178     assert gc_summary[\"indices_deleted\"] == (expect_indices_per_shard - 2) * shard_count\n179 \n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 178,
      "line_range": [
        178
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "233     new_shard_count = 4\n234     assert shard_count is None or new_shard_count > shard_count\n235     shards = env.storage_controller.tenant_shard_split(tenant_id, shard_count=new_shard_count)\n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 234,
      "line_range": [
        234
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "261     gc_summary = env.storage_scrubber.pageserver_physical_gc(min_age_secs=1, mode=\"full\")\n262     assert gc_summary[\"remote_storage_errors\"] == 0\n263     assert gc_summary[\"indices_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 262,
      "line_range": [
        262
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "262     assert gc_summary[\"remote_storage_errors\"] == 0\n263     assert gc_summary[\"indices_deleted\"] == 0\n264     assert gc_summary[\"ancestor_layers_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 263,
      "line_range": [
        263
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "263     assert gc_summary[\"indices_deleted\"] == 0\n264     assert gc_summary[\"ancestor_layers_deleted\"] == 0\n265 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 264,
      "line_range": [
        264
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "280     gc_summary = env.storage_scrubber.pageserver_physical_gc(min_age_secs=3600, mode=\"full\")\n281     assert gc_summary[\"remote_storage_errors\"] == 0\n282     assert gc_summary[\"indices_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 281,
      "line_range": [
        281
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "281     assert gc_summary[\"remote_storage_errors\"] == 0\n282     assert gc_summary[\"indices_deleted\"] == 0\n283     assert gc_summary[\"ancestor_layers_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 282,
      "line_range": [
        282
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "282     assert gc_summary[\"indices_deleted\"] == 0\n283     assert gc_summary[\"ancestor_layers_deleted\"] == 0\n284 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 283,
      "line_range": [
        283
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "286     gc_summary = env.storage_scrubber.pageserver_physical_gc(min_age_secs=1, mode=\"full\")\n287     assert gc_summary[\"remote_storage_errors\"] == 0\n288     assert gc_summary[\"indices_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 287,
      "line_range": [
        287
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "287     assert gc_summary[\"remote_storage_errors\"] == 0\n288     assert gc_summary[\"indices_deleted\"] == 0\n289     assert gc_summary[\"ancestor_layers_deleted\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 288,
      "line_range": [
        288
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "288     assert gc_summary[\"indices_deleted\"] == 0\n289     assert gc_summary[\"ancestor_layers_deleted\"] > 0\n290 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 289,
      "line_range": [
        289
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "363     gc_summary = env.storage_scrubber.pageserver_physical_gc(min_age_secs=0, mode=\"full\")\n364     assert gc_summary[\"remote_storage_errors\"] == 0\n365     assert gc_summary[\"indices_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 364,
      "line_range": [
        364
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "364     assert gc_summary[\"remote_storage_errors\"] == 0\n365     assert gc_summary[\"indices_deleted\"] == 0\n366     assert gc_summary[\"ancestor_layers_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 365,
      "line_range": [
        365
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "365     assert gc_summary[\"indices_deleted\"] == 0\n366     assert gc_summary[\"ancestor_layers_deleted\"] == 0\n367 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 366,
      "line_range": [
        366
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "372     gc_summary = env.storage_scrubber.pageserver_physical_gc(min_age_secs=0, mode=\"full\")\n373     assert gc_summary[\"remote_storage_errors\"] == 0\n374     assert gc_summary[\"indices_deleted\"] == 0\n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 373,
      "line_range": [
        373
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "373     assert gc_summary[\"remote_storage_errors\"] == 0\n374     assert gc_summary[\"indices_deleted\"] == 0\n375     assert gc_summary[\"ancestor_layers_deleted\"] > 0\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 374,
      "line_range": [
        374
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "374     assert gc_summary[\"indices_deleted\"] == 0\n375     assert gc_summary[\"ancestor_layers_deleted\"] > 0\n376 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 375,
      "line_range": [
        375
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "453         # Check that the other child shards weren't created\n454         assert env.get_tenant_pageserver(TenantShardId(tenant_id, 1, 4)) is None\n455         assert env.get_tenant_pageserver(TenantShardId(tenant_id, 3, 4)) is None\n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 454,
      "line_range": [
        454
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "454         assert env.get_tenant_pageserver(TenantShardId(tenant_id, 1, 4)) is None\n455         assert env.get_tenant_pageserver(TenantShardId(tenant_id, 3, 4)) is None\n456 \n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 455,
      "line_range": [
        455
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "462         log.info(f\"Ran physical GC partway through split: {gc_output}\")\n463         assert gc_output[\"ancestor_layers_deleted\"] == 0\n464         assert gc_output[\"remote_storage_errors\"] == 0\n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 463,
      "line_range": [
        463
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "463         assert gc_output[\"ancestor_layers_deleted\"] == 0\n464         assert gc_output[\"remote_storage_errors\"] == 0\n465         assert gc_output[\"controller_api_errors\"] == 0\n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 464,
      "line_range": [
        464
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "464         assert gc_output[\"remote_storage_errors\"] == 0\n465         assert gc_output[\"controller_api_errors\"] == 0\n466 \n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 465,
      "line_range": [
        465
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "489         log.info(f\"Ran physical GC after split completed: {gc_output}\")\n490         assert gc_output[\"ancestor_layers_deleted\"] > 0\n491         assert gc_output[\"remote_storage_errors\"] == 0\n",
      "col_offset": 8,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 490,
      "line_range": [
        490
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "490         assert gc_output[\"ancestor_layers_deleted\"] > 0\n491         assert gc_output[\"remote_storage_errors\"] == 0\n492         assert gc_output[\"controller_api_errors\"] == 0\n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 491,
      "line_range": [
        491
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "491         assert gc_output[\"remote_storage_errors\"] == 0\n492         assert gc_output[\"controller_api_errors\"] == 0\n493 \n",
      "col_offset": 8,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 492,
      "line_range": [
        492
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "526 \n527     assert isinstance(env.pageserver_remote_storage, S3Storage)\n528     timeline_path = env.pageserver_remote_storage.timeline_path(\n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 527,
      "line_range": [
        527
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "538     index_keys = list(filter(lambda s: s.startswith(f\"{timeline_path}/index_part\"), keys))\n539     assert len(index_keys) > 0\n540 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 539,
      "line_range": [
        539
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "545 \n546     assert len(index.layer_metadata) > 0\n547     it = iter(index.layer_metadata.items())\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 546,
      "line_range": [
        546
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "549     healthy, scan_summary = env.storage_scrubber.scan_metadata(post_to_storage_controller=True)\n550     assert healthy\n551 \n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 550,
      "line_range": [
        550
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "551 \n552     assert env.storage_controller.metadata_health_is_healthy()\n553 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 552,
      "line_range": [
        552
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "565     log.info(f\"{pprint.pformat(scan_summary)}\")\n566     assert len(scan_summary[\"with_warnings\"]) > 0\n567 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 566,
      "line_range": [
        566
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "567 \n568     assert env.storage_controller.metadata_health_is_healthy()\n569 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 568,
      "line_range": [
        568
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "572     log.info(f\"{pprint.pformat(scan_summary)}\")\n573     assert len(scan_summary[\"with_warnings\"]) > 0\n574 \n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 573,
      "line_range": [
        573
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "575     unhealthy = env.storage_controller.metadata_health_list_unhealthy()[\"unhealthy_tenant_shards\"]\n576     assert len(unhealthy) == 1 and unhealthy[0] == str(tenant_shard_id)\n577 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_storage_scrubber.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 576,
      "line_range": [
        576
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "27         res = scur.fetchall()\n28         assert res[0][0] == n_records\n29 \n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_subscriber_restart.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 28,
      "line_range": [
        28
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55         thread.join()\n56         pcur.execute(f\"INSERT into t values ({n_records}, 0)\")\n57         n_records += 1\n",
      "col_offset": 23,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_subscriber_restart.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "27             cur.execute(f\"savepoint sp{j}\")\n28             cur.execute(f\"insert into t1 values ({i}, {j})\")\n29         cur.execute(\"commit\")\n",
      "col_offset": 26,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_subxacts.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 28,
      "line_range": [
        28
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "51     except Exception as e:\n52         assert invalid_conf_key in str(e)\n53     else:\n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 52,
      "line_range": [
        52
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "69     default_tenant_config = http_client.tenant_config(tenant_id=env.initial_tenant)\n70     assert (\n71         not default_tenant_config.tenant_specific_overrides\n72     ), \"Should have no specific settings yet\"\n73     effective_config = default_tenant_config.effective_config\n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 70,
      "line_range": [
        70,
        71,
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "73     effective_config = default_tenant_config.effective_config\n74     assert effective_config[\"checkpoint_distance\"] == 10000\n75     assert effective_config[\"compaction_target_size\"] == 1048576\n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 74,
      "line_range": [
        74
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "74     assert effective_config[\"checkpoint_distance\"] == 10000\n75     assert effective_config[\"compaction_target_size\"] == 1048576\n76     assert effective_config[\"compaction_period\"] == \"20s\"\n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 75,
      "line_range": [
        75
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75     assert effective_config[\"compaction_target_size\"] == 1048576\n76     assert effective_config[\"compaction_period\"] == \"20s\"\n77     assert effective_config[\"compaction_threshold\"] == 10\n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "76     assert effective_config[\"compaction_period\"] == \"20s\"\n77     assert effective_config[\"compaction_threshold\"] == 10\n78     assert effective_config[\"gc_horizon\"] == 67108864\n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 77,
      "line_range": [
        77
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77     assert effective_config[\"compaction_threshold\"] == 10\n78     assert effective_config[\"gc_horizon\"] == 67108864\n79     assert effective_config[\"gc_period\"] == \"1h\"\n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "78     assert effective_config[\"gc_horizon\"] == 67108864\n79     assert effective_config[\"gc_period\"] == \"1h\"\n80     assert effective_config[\"image_creation_threshold\"] == 3\n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 79,
      "line_range": [
        79
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "79     assert effective_config[\"gc_period\"] == \"1h\"\n80     assert effective_config[\"image_creation_threshold\"] == 3\n81     assert effective_config[\"pitr_interval\"] == \"7days\"\n",
      "col_offset": 4,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 80,
      "line_range": [
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "80     assert effective_config[\"image_creation_threshold\"] == 3\n81     assert effective_config[\"pitr_interval\"] == \"7days\"\n82     assert effective_config[\"evictions_low_residence_duration_metric_threshold\"] == \"2days\"\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 81,
      "line_range": [
        81
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "81     assert effective_config[\"pitr_interval\"] == \"7days\"\n82     assert effective_config[\"evictions_low_residence_duration_metric_threshold\"] == \"2days\"\n83     assert effective_config[\"eviction_policy\"] == {\n",
      "col_offset": 4,
      "end_col_offset": 91,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "82     assert effective_config[\"evictions_low_residence_duration_metric_threshold\"] == \"2days\"\n83     assert effective_config[\"eviction_policy\"] == {\n84         \"kind\": \"LayerAccessThreshold\",\n85         \"period\": \"20s\",\n86         \"threshold\": \"23h\",\n87     }\n88 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 83,
      "line_range": [
        83,
        84,
        85,
        86,
        87
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "91     new_specific_config = new_tenant_config.tenant_specific_overrides\n92     assert new_specific_config[\"checkpoint_distance\"] == 20000\n93     assert new_specific_config[\"gc_period\"] == \"30s\"\n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 92,
      "line_range": [
        92
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "92     assert new_specific_config[\"checkpoint_distance\"] == 20000\n93     assert new_specific_config[\"gc_period\"] == \"30s\"\n94     assert len(new_specific_config) == len(\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "93     assert new_specific_config[\"gc_period\"] == \"30s\"\n94     assert len(new_specific_config) == len(\n95         new_conf\n96     ), f\"No more specific properties were expected, but got: {new_specific_config}\"\n97     new_effective_config = new_tenant_config.effective_config\n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94,
        95,
        96
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "97     new_effective_config = new_tenant_config.effective_config\n98     assert (\n99         new_effective_config[\"checkpoint_distance\"] == 20000\n100     ), \"Specific 'checkpoint_distance' config should override the default value\"\n101     assert (\n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 98,
      "line_range": [
        98,
        99,
        100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "100     ), \"Specific 'checkpoint_distance' config should override the default value\"\n101     assert (\n102         new_effective_config[\"gc_period\"] == \"30s\"\n103     ), \"Specific 'gc_period' config should override the default value\"\n104     assert (\n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 101,
      "line_range": [
        101,
        102,
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "103     ), \"Specific 'gc_period' config should override the default value\"\n104     assert (\n105         new_effective_config[\"evictions_low_residence_duration_metric_threshold\"] == \"42s\"\n106     ), \"Should override default value\"\n107     assert new_effective_config[\"eviction_policy\"] == {\n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 104,
      "line_range": [
        104,
        105,
        106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "106     ), \"Should override default value\"\n107     assert new_effective_config[\"eviction_policy\"] == {\n108         \"kind\": \"NoEviction\"\n109     }, \"Specific 'eviction_policy' config should override the default value\"\n110     assert new_effective_config[\"compaction_target_size\"] == 1048576\n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 107,
      "line_range": [
        107,
        108,
        109
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "109     }, \"Specific 'eviction_policy' config should override the default value\"\n110     assert new_effective_config[\"compaction_target_size\"] == 1048576\n111     assert new_effective_config[\"compaction_period\"] == \"20s\"\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 110,
      "line_range": [
        110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "110     assert new_effective_config[\"compaction_target_size\"] == 1048576\n111     assert new_effective_config[\"compaction_period\"] == \"20s\"\n112     assert new_effective_config[\"compaction_threshold\"] == 10\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 111,
      "line_range": [
        111
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "111     assert new_effective_config[\"compaction_period\"] == \"20s\"\n112     assert new_effective_config[\"compaction_threshold\"] == 10\n113     assert new_effective_config[\"gc_horizon\"] == 67108864\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 112,
      "line_range": [
        112
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "112     assert new_effective_config[\"compaction_threshold\"] == 10\n113     assert new_effective_config[\"gc_horizon\"] == 67108864\n114     assert new_effective_config[\"image_creation_threshold\"] == 3\n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 113,
      "line_range": [
        113
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "113     assert new_effective_config[\"gc_horizon\"] == 67108864\n114     assert new_effective_config[\"image_creation_threshold\"] == 3\n115     assert new_effective_config[\"pitr_interval\"] == \"7days\"\n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 114,
      "line_range": [
        114
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "114     assert new_effective_config[\"image_creation_threshold\"] == 3\n115     assert new_effective_config[\"pitr_interval\"] == \"7days\"\n116 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 115,
      "line_range": [
        115
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132     updated_specific_config = updated_tenant_config.tenant_specific_overrides\n133     assert updated_specific_config[\"checkpoint_distance\"] == 15000\n134     assert updated_specific_config[\"gc_period\"] == \"1m 20s\"\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "133     assert updated_specific_config[\"checkpoint_distance\"] == 15000\n134     assert updated_specific_config[\"gc_period\"] == \"1m 20s\"\n135     assert updated_specific_config[\"compaction_period\"] == \"1m 20s\"\n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 134,
      "line_range": [
        134
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "134     assert updated_specific_config[\"gc_period\"] == \"1m 20s\"\n135     assert updated_specific_config[\"compaction_period\"] == \"1m 20s\"\n136     assert len(updated_specific_config) == len(\n",
      "col_offset": 4,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 135,
      "line_range": [
        135
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "135     assert updated_specific_config[\"compaction_period\"] == \"1m 20s\"\n136     assert len(updated_specific_config) == len(\n137         conf_update\n138     ), f\"No more specific properties were expected, but got: {updated_specific_config}\"\n139     updated_effective_config = updated_tenant_config.effective_config\n",
      "col_offset": 4,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 136,
      "line_range": [
        136,
        137,
        138
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "139     updated_effective_config = updated_tenant_config.effective_config\n140     assert (\n141         updated_effective_config[\"checkpoint_distance\"] == 15000\n142     ), \"Specific 'checkpoint_distance' config should override the default value\"\n143     assert (\n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 140,
      "line_range": [
        140,
        141,
        142
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "142     ), \"Specific 'checkpoint_distance' config should override the default value\"\n143     assert (\n144         updated_effective_config[\"gc_period\"] == \"1m 20s\"\n145     ), \"Specific 'gc_period' config should override the default value\"\n146     assert (\n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 143,
      "line_range": [
        143,
        144,
        145
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "145     ), \"Specific 'gc_period' config should override the default value\"\n146     assert (\n147         updated_effective_config[\"compaction_period\"] == \"1m 20s\"\n148     ), \"Specific 'compaction_period' config should override the default value\"\n149     assert (\n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 146,
      "line_range": [
        146,
        147,
        148
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "148     ), \"Specific 'compaction_period' config should override the default value\"\n149     assert (\n150         updated_effective_config[\"evictions_low_residence_duration_metric_threshold\"] == \"23h\"\n151     ), \"Should override default value\"\n152     assert updated_effective_config[\"eviction_policy\"] == {\n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 149,
      "line_range": [
        149,
        150,
        151
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "151     ), \"Should override default value\"\n152     assert updated_effective_config[\"eviction_policy\"] == {\n153         \"kind\": \"LayerAccessThreshold\",\n154         \"period\": \"1m 20s\",\n155         \"threshold\": \"1day 18h\",\n156     }, \"Specific 'eviction_policy' config should override the default value\"\n157     assert updated_effective_config[\"compaction_target_size\"] == 1048576\n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 152,
      "line_range": [
        152,
        153,
        154,
        155,
        156
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "156     }, \"Specific 'eviction_policy' config should override the default value\"\n157     assert updated_effective_config[\"compaction_target_size\"] == 1048576\n158     assert updated_effective_config[\"compaction_threshold\"] == 10\n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 157,
      "line_range": [
        157
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "157     assert updated_effective_config[\"compaction_target_size\"] == 1048576\n158     assert updated_effective_config[\"compaction_threshold\"] == 10\n159     assert updated_effective_config[\"gc_horizon\"] == 67108864\n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 158,
      "line_range": [
        158
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "158     assert updated_effective_config[\"compaction_threshold\"] == 10\n159     assert updated_effective_config[\"gc_horizon\"] == 67108864\n160     assert updated_effective_config[\"image_creation_threshold\"] == 2\n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 159,
      "line_range": [
        159
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "159     assert updated_effective_config[\"gc_horizon\"] == 67108864\n160     assert updated_effective_config[\"image_creation_threshold\"] == 2\n161     assert updated_effective_config[\"pitr_interval\"] == \"7days\"\n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 160,
      "line_range": [
        160
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "160     assert updated_effective_config[\"image_creation_threshold\"] == 2\n161     assert updated_effective_config[\"pitr_interval\"] == \"7days\"\n162     assert updated_effective_config[\"max_lsn_wal_lag\"] == 13000000\n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 161,
      "line_range": [
        161
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "161     assert updated_effective_config[\"pitr_interval\"] == \"7days\"\n162     assert updated_effective_config[\"max_lsn_wal_lag\"] == 13000000\n163 \n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 162,
      "line_range": [
        162
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "168     restarted_tenant_config = http_client.tenant_config(tenant_id=tenant)\n169     assert (\n170         restarted_tenant_config == updated_tenant_config\n171     ), \"Updated config should not change after the restart\"\n172 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 169,
      "line_range": [
        169,
        170,
        171
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "180     final_specific_config = final_tenant_config.tenant_specific_overrides\n181     assert final_specific_config[\"pitr_interval\"] == \"1m\"\n182     assert len(final_specific_config) == len(\n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 181,
      "line_range": [
        181
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "181     assert final_specific_config[\"pitr_interval\"] == \"1m\"\n182     assert len(final_specific_config) == len(\n183         final_conf\n184     ), f\"No more specific properties were expected, but got: {final_specific_config}\"\n185     final_effective_config = final_tenant_config.effective_config\n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 182,
      "line_range": [
        182,
        183,
        184
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "185     final_effective_config = final_tenant_config.effective_config\n186     assert (\n187         final_effective_config[\"pitr_interval\"] == \"1m\"\n188     ), \"Specific 'pitr_interval' config should override the default value\"\n189     assert final_effective_config[\"checkpoint_distance\"] == 10000\n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 186,
      "line_range": [
        186,
        187,
        188
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "188     ), \"Specific 'pitr_interval' config should override the default value\"\n189     assert final_effective_config[\"checkpoint_distance\"] == 10000\n190     assert final_effective_config[\"compaction_target_size\"] == 1048576\n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 189,
      "line_range": [
        189
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "189     assert final_effective_config[\"checkpoint_distance\"] == 10000\n190     assert final_effective_config[\"compaction_target_size\"] == 1048576\n191     assert final_effective_config[\"compaction_period\"] == \"20s\"\n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 190,
      "line_range": [
        190
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "190     assert final_effective_config[\"compaction_target_size\"] == 1048576\n191     assert final_effective_config[\"compaction_period\"] == \"20s\"\n192     assert final_effective_config[\"compaction_threshold\"] == 10\n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 191,
      "line_range": [
        191
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "191     assert final_effective_config[\"compaction_period\"] == \"20s\"\n192     assert final_effective_config[\"compaction_threshold\"] == 10\n193     assert final_effective_config[\"gc_horizon\"] == 67108864\n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "192     assert final_effective_config[\"compaction_threshold\"] == 10\n193     assert final_effective_config[\"gc_horizon\"] == 67108864\n194     assert final_effective_config[\"gc_period\"] == \"1h\"\n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 193,
      "line_range": [
        193
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "193     assert final_effective_config[\"gc_horizon\"] == 67108864\n194     assert final_effective_config[\"gc_period\"] == \"1h\"\n195     assert final_effective_config[\"image_creation_threshold\"] == 3\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 194,
      "line_range": [
        194
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "194     assert final_effective_config[\"gc_period\"] == \"1h\"\n195     assert final_effective_config[\"image_creation_threshold\"] == 3\n196     assert final_effective_config[\"evictions_low_residence_duration_metric_threshold\"] == \"2days\"\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 195,
      "line_range": [
        195
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "195     assert final_effective_config[\"image_creation_threshold\"] == 3\n196     assert final_effective_config[\"evictions_low_residence_duration_metric_threshold\"] == \"2days\"\n197     assert final_effective_config[\"eviction_policy\"] == {\n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 196,
      "line_range": [
        196
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "196     assert final_effective_config[\"evictions_low_residence_duration_metric_threshold\"] == \"2days\"\n197     assert final_effective_config[\"eviction_policy\"] == {\n198         \"kind\": \"LayerAccessThreshold\",\n199         \"period\": \"20s\",\n200         \"threshold\": \"23h\",\n201     }\n202     assert final_effective_config[\"max_lsn_wal_lag\"] == 1024 * 1024 * 1024\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 197,
      "line_range": [
        197,
        198,
        199,
        200,
        201
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "201     }\n202     assert final_effective_config[\"max_lsn_wal_lag\"] == 1024 * 1024 * 1024\n203 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 202,
      "line_range": [
        202
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "208     restarted_final_tenant_config = http_client.tenant_config(tenant_id=tenant)\n209     assert (\n210         restarted_final_tenant_config == final_tenant_config\n211     ), \"Updated config should not change after the restart\"\n212 \n",
      "col_offset": 4,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 209,
      "line_range": [
        209,
        210,
        211
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "217     env = neon_env_builder.init_start()\n218     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n219 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 218,
      "line_range": [
        218
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "227     last_record_lsn = Lsn(detail[\"last_record_lsn\"])\n228     assert last_record_lsn.lsn_int != 0, \"initdb must have executed\"\n229 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 228,
      "line_range": [
        228
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "233 \n234     assert not config_path.exists(), \"detach did not remove config file\"\n235 \n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 234,
      "line_range": [
        234
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "249     # we just care about being able to create the file\n250     assert len(contents_first) > len(contents_later)\n251 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 250,
      "line_range": [
        250
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "263     )\n264     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n265 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 264,
      "line_range": [
        264
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "290     metric = get_metric()\n291     assert int(metric.value) == 0, \"metric is present with default value\"\n292 \n",
      "col_offset": 4,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 291,
      "line_range": [
        291
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "292 \n293     assert default_value == \"1day\"\n294 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 293,
      "line_range": [
        293
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "298     metric = get_metric()\n299     assert int(metric.value) > 0, \"metric is updated\"\n300 \n",
      "col_offset": 4,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 299,
      "line_range": [
        299
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "304     updated_metric = get_metric()\n305     assert int(updated_metric.value) == int(\n306         metric.value\n307     ), \"metric is unchanged when setting same value\"\n308 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 305,
      "line_range": [
        305,
        306,
        307
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "310     metric = get_metric()\n311     assert int(metric.labels[\"low_threshold_secs\"]) == 2 * 24 * 60 * 60\n312     assert int(metric.value) == 0\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 311,
      "line_range": [
        311
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "311     assert int(metric.labels[\"low_threshold_secs\"]) == 2 * 24 * 60 * 60\n312     assert int(metric.value) == 0\n313 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 312,
      "line_range": [
        312
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "317     metric = get_metric()\n318     assert int(metric.labels[\"low_threshold_secs\"]) == 2 * 24 * 60 * 60\n319     assert int(metric.value) > 0\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 318,
      "line_range": [
        318
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "318     assert int(metric.labels[\"low_threshold_secs\"]) == 2 * 24 * 60 * 60\n319     assert int(metric.value) > 0\n320 \n",
      "col_offset": 4,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 319,
      "line_range": [
        319
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "322     metric = get_metric()\n323     assert int(metric.labels[\"low_threshold_secs\"]) == 2 * 60 * 60\n324     assert int(metric.value) == 0, \"value resets if label changes\"\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 323,
      "line_range": [
        323
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "323     assert int(metric.labels[\"low_threshold_secs\"]) == 2 * 60 * 60\n324     assert int(metric.value) == 0, \"value resets if label changes\"\n325 \n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 324,
      "line_range": [
        324
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "329     metric = get_metric()\n330     assert int(metric.labels[\"low_threshold_secs\"]) == 2 * 60 * 60\n331     assert int(metric.value) > 0, \"set a non-zero value for next step\"\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 330,
      "line_range": [
        330
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "330     assert int(metric.labels[\"low_threshold_secs\"]) == 2 * 60 * 60\n331     assert int(metric.value) > 0, \"set a non-zero value for next step\"\n332 \n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 331,
      "line_range": [
        331
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "334     metric = get_metric()\n335     assert int(metric.labels[\"low_threshold_secs\"]) == 24 * 60 * 60, \"label resets to default\"\n336     assert int(metric.value) == 0, \"value resets to default\"\n",
      "col_offset": 4,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 335,
      "line_range": [
        335
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "335     assert int(metric.labels[\"low_threshold_secs\"]) == 24 * 60 * 60, \"label resets to default\"\n336     assert int(metric.value) == 0, \"value resets to default\"\n",
      "col_offset": 4,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_conf.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 336,
      "line_range": [
        336
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "41                 # error during delete_objects()\n42                 assert (\n43                     \"simulated failure of remote operation\" in e.message\n44                     or \"failed to delete\" in e.message\n45                 )\n46             else:\n",
      "col_offset": 16,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 42,
      "line_range": [
        42,
        43,
        44,
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89     # Default tenant and the one we created\n90     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 2\n91 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "114 \n115     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 2\n116     error_tolerant_delete(ps_http, tenant_id)\n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 115,
      "line_range": [
        115
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "116     error_tolerant_delete(ps_http, tenant_id)\n117     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 1\n118 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 117,
      "line_range": [
        117
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "119     tenant_path = env.pageserver.tenant_dir(tenant_id)\n120     assert not tenant_path.exists()\n121 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 120,
      "line_range": [
        120
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132     # Deletion updates the tenant count: the one default tenant remains\n133     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 1\n134     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"inprogress\"}) == 0\n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "133     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 1\n134     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"inprogress\"}) == 0\n135 \n",
      "col_offset": 4,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 134,
      "line_range": [
        134
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "170     def has_hit_failpoint():\n171         assert env.pageserver.log_contains(f\"at failpoint {failpoint}\") is not None\n172 \n",
      "col_offset": 8,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 171,
      "line_range": [
        171
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "173     def deletion_has_started_waiting_for_timelines():\n174         assert env.pageserver.log_contains(\"Waiting for timelines...\") is not None\n175 \n",
      "col_offset": 8,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 174,
      "line_range": [
        174
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "179         except PageserverApiException as e:\n180             assert e.status_code == 404\n181         else:\n",
      "col_offset": 12,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 180,
      "line_range": [
        180
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "316     env.pageserver.assert_log_contains(CANCELLED_ERROR)\n317     assert not env.pageserver.log_contains(\n318         \".*ERROR.*delete_tenant.*Timelines directory is not empty after all timelines deletion\"\n319     )\n320 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 317,
      "line_range": [
        317,
        318,
        319
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "321     # Zero tenants remain (we deleted the default tenant)\n322     assert ps_http.get_metric_value(\"pageserver_tenant_manager_slots\", {\"mode\": \"attached\"}) == 0\n323 \n",
      "col_offset": 4,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 322,
      "line_range": [
        322
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "352     healthy, _ = env.storage_scrubber.scan_metadata()\n353     assert healthy\n354 \n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 353,
      "line_range": [
        353
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "362     cloud_admin_url = f\"http://{make_httpserver.host}:{make_httpserver.port}/\"\n363     cloud_admin_token = \"\"\n364 \n",
      "col_offset": 24,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: ''",
      "line_number": 363,
      "line_range": [
        363
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "391     )\n392     assert healthy\n393 \n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 392,
      "line_range": [
        392
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "399     healthy, _ = env.storage_scrubber.scan_metadata()\n400     assert healthy\n401 \n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 400,
      "line_range": [
        400
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "406     )\n407     assert healthy\n408 \n",
      "col_offset": 4,
      "end_col_offset": 18,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 407,
      "line_range": [
        407
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "449     dirs = list(env.pageserver.tenant_dir(None).glob(f\"{tenant_id}*\"))\n450     assert dirs == [], f\"found tenant directories: {dirs}\"\n451 \n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 450,
      "line_range": [
        450
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "458     dirs = list(env.pageserver.tenant_dir(None).glob(f\"{env.initial_tenant}*\"))\n459     assert dirs != [], \"missing initial tenant directory\"\n460 \n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 459,
      "line_range": [
        459
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "129 \n130     assert pageserver_last_record_lsn_before_detach == pageserver_last_record_lsn\n131 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 130,
      "line_range": [
        130
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "133         with endpoint.cursor() as cur:\n134             assert query_scalar(cur, \"SELECT count(*) FROM t\") == 100000\n135 \n",
      "col_offset": 12,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 134,
      "line_range": [
        134
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "136         # Check that we had to retry the downloads\n137         assert env.pageserver.log_contains(\".*list identifiers.*failed, will retry.*\")\n138         assert env.pageserver.log_contains(\".*download.*failed, will retry.*\")\n",
      "col_offset": 8,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 137,
      "line_range": [
        137
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "137         assert env.pageserver.log_contains(\".*list identifiers.*failed, will retry.*\")\n138         assert env.pageserver.log_contains(\".*download.*failed, will retry.*\")\n139 \n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 138,
      "line_range": [
        138
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "200             updates_started += 1\n201             id = random.randrange(1, num_rows)\n202 \n",
      "col_offset": 17,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 201,
      "line_range": [
        201
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "205                 try:\n206                     await pg_conn.fetchrow(f\"UPDATE t SET counter = counter + 1 WHERE id = {id}\")\n207                     updates_finished += 1\n",
      "col_offset": 45,
      "end_col_offset": 91,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 206,
      "line_range": [
        206
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "244 \n245         assert updates_finished == updates_to_perform\n246 \n",
      "col_offset": 8,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 245,
      "line_range": [
        245
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "269     # Verify table contents\n270     assert query_scalar(cur, \"SELECT count(*) FROM t\") == num_rows\n271     assert query_scalar(cur, \"SELECT sum(counter) FROM t\") == updates_to_perform\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 270,
      "line_range": [
        270
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "270     assert query_scalar(cur, \"SELECT count(*) FROM t\") == num_rows\n271     assert query_scalar(cur, \"SELECT sum(counter) FROM t\") == updates_to_perform\n272 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 271,
      "line_range": [
        271
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "283     # assert tenant exists on disk\n284     assert env.pageserver.tenant_dir(tenant_id).exists()\n285 \n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 284,
      "line_range": [
        284
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "326     gc_thread.join(timeout=10)\n327     assert not gc_thread.is_alive()\n328     log.info(\"gc thread returned\")\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 327,
      "line_range": [
        327
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "330     # check that nothing is left on disk for deleted tenant\n331     assert not env.pageserver.tenant_dir(tenant_id).exists()\n332 \n",
      "col_offset": 4,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 331,
      "line_range": [
        331
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "423     data_id = 1\n424     data_secret = \"very secret secret\"\n425     insert_test_data(pageserver_http, tenant_id, timeline_id, data_id, data_secret, endpoint)\n",
      "col_offset": 18,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'very secret secret'",
      "line_number": 424,
      "line_range": [
        424
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "440     tenants_after_detach = [tenant[\"id\"] for tenant in pageserver_http.tenant_list()]\n441     assert tenant_id not in tenants_after_detach, \"Detached tenant should be missing\"\n442     assert len(tenants_after_detach) + 1 == len(\n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 441,
      "line_range": [
        441
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "441     assert tenant_id not in tenants_after_detach, \"Detached tenant should be missing\"\n442     assert len(tenants_after_detach) + 1 == len(\n443         tenants_before_detach\n444     ), \"Only ignored tenant should be missing\"\n445 \n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 442,
      "line_range": [
        442,
        443,
        444
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "465         cur.execute(\n466             f\"\"\"\n467             CREATE TABLE test(id int primary key, secret text);\n468             INSERT INTO test VALUES ({data_id}, '{data}');\n469         \"\"\"\n470         )\n",
      "col_offset": 16,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 466,
      "line_range": [
        466,
        467,
        468,
        469
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "485     with endpoint.cursor() as cur:\n486         assert (\n487             query_scalar(cur, f\"SELECT secret FROM test WHERE id = {data_id};\") == data\n488         ), \"Should have timeline data back\"\n489 \n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 486,
      "line_range": [
        486,
        487,
        488
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "486         assert (\n487             query_scalar(cur, f\"SELECT secret FROM test WHERE id = {data_id};\") == data\n488         ), \"Should have timeline data back\"\n",
      "col_offset": 32,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 487,
      "line_range": [
        487
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "503             return int(samples[0].value)\n504         assert len(samples) == 0\n505         return None\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 504,
      "line_range": [
        504
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "517         )\n518         assert only_int(active) == 0 and only_int(broken) == 1 and only_int(broken_set) == 1\n519 \n",
      "col_offset": 8,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 518,
      "line_range": [
        518
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "529         )\n530         assert only_int(broken) == 0 and len(broken_set) == 0\n531 \n",
      "col_offset": 8,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 530,
      "line_range": [
        530
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "541         )\n542         assert only_int(active) == 1 and len(broken_set) == 0\n543 \n",
      "col_offset": 8,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 542,
      "line_range": [
        542
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "34 def assert_abs_margin_ratio(a: float, b: float, margin_ratio: float):\n35     assert abs(a - b) / a < margin_ratio, abs(a - b) / a\n36 \n",
      "col_offset": 4,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 35,
      "line_range": [
        35
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "67                     # the result, so sometimes selected value is larger by one than we expect\n68                     assert cur.fetchone()[0] - inserted_ctr <= 1\n69                     log.info(\"successfully recovered %s\", inserted_ctr)\n",
      "col_offset": 20,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 68,
      "line_range": [
        68
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104             cur.execute(\"SELECT sum(key) FROM t\")\n105             assert cur.fetchone() == (expected_sum,)\n106         current_lsn = Lsn(query_scalar(cur, \"SELECT pg_current_wal_flush_lsn()\"))\n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 105,
      "line_range": [
        105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "160     files_before_detach = os.listdir(timeline_to_detach_local_path)\n161     assert (\n162         len(files_before_detach) >= 1\n163     ), f\"Regular timeline {timeline_to_detach_local_path} should have at least one layer file, but got {files_before_detach}\"\n164 \n",
      "col_offset": 4,
      "end_col_offset": 125,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 161,
      "line_range": [
        161,
        162,
        163
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "171         cur.execute(\"SELECT sum(key) FROM t\")\n172         assert cur.fetchone() == (sum_before_migration,)\n173         # check that we can write new data\n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 172,
      "line_range": [
        172
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "175         cur.execute(\"SELECT sum(key) FROM t\")\n176         assert cur.fetchone() == (sum_before_migration + 1500500,)\n177 \n",
      "col_offset": 8,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 176,
      "line_range": [
        176
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "177 \n178     assert not os.path.exists(\n179         old_local_path\n180     ), f\"After detach, local timeline dir {old_local_path} should be removed\"\n181 \n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 178,
      "line_range": [
        178,
        179,
        180
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "213 \n214     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n215 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 214,
      "line_range": [
        214
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "374     if with_load == \"with_load\":\n375         assert load_ok_event.wait(3)\n376         log.info(\"stopping load thread\")\n",
      "col_offset": 8,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 375,
      "line_range": [
        375
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "454         cur.execute(\"SELECT * FROM test_reattach\")\n455         assert cur.fetchall() == [(\"before pause\",), (\"after pause\",)]\n456 \n",
      "col_offset": 8,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 455,
      "line_range": [
        455
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "460     )\n461     assert time.time() - before_attach_time > 5\n462 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 461,
      "line_range": [
        461
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "595     with child_endpoint.cursor(dbname=\"neondb\") as cur:\n596         assert query_scalar(cur, \"SELECT count(*) FROM test_migrate_one\") == 200\n597 \n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 596,
      "line_range": [
        596
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "601     )\n602     assert time.time() - before_attach_time > 5\n603 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_relocation.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 602,
      "line_range": [
        602
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "35     # we should never have zero, because there should be the initdb \"changes\"\n36     assert initial_size > 0, \"initial implementation returns ~initdb tenant_size\"\n37 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 36,
      "line_range": [
        36
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "46         row = cur.fetchone()\n47         assert row is not None\n48         assert row[0] == 1\n",
      "col_offset": 8,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "47         assert row is not None\n48         assert row[0] == 1\n49 \n",
      "col_offset": 8,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 48,
      "line_range": [
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55 \n56     assert size >= initial_size and size - initial_size < 1024\n57 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "87 \n88     assert size_after_branching > initial_size\n89 \n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 88,
      "line_range": [
        88
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "119     # https://github.com/neondatabase/neon/issues/2962\n120     assert size_after_branching == initial_size\n121 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 120,
      "line_range": [
        120
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "132         size_after_branching = http_client.tenant_size(tenant_id)\n133         assert size_after_branching == initial_size\n134 \n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 133,
      "line_range": [
        133
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "134 \n135     assert last_branch is not None\n136 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 135,
      "line_range": [
        135
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "144     size_after_writes = http_client.tenant_size(tenant_id)\n145     assert size_after_writes > initial_size\n146 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 145,
      "line_range": [
        145
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "173 \n174     assert flushed_lsn.lsn_int - gc_horizon > initdb_lsn.lsn_int\n175 \n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 174,
      "line_range": [
        174
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "184 \n185     assert size_before_branching < size_after\n186 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 185,
      "line_range": [
        185
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "219 \n220     assert flushed_lsn.lsn_int - gc_horizon > initdb_lsn.lsn_int\n221 \n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 220,
      "line_range": [
        220
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "230 \n231     assert size_before_branching < size_after\n232 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 231,
      "line_range": [
        231
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "265                 cur.execute(\n266                     f\"CREATE TABLE t0 AS SELECT i::bigint n FROM generate_series(0, {amount}) s(i)\"\n267                 )\n",
      "col_offset": 22,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 266,
      "line_range": [
        266
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "270             if latest_size is not None:\n271                 assert size_now > latest_size\n272             else:\n",
      "col_offset": 16,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 271,
      "line_range": [
        271
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "272             else:\n273                 assert size_now > initial_size\n274 \n",
      "col_offset": 16,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 273,
      "line_range": [
        273
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "338         size_debug_file.write(size_debug)\n339         assert size > 0\n340         log.info(f\"size: {size} at lsn {current_lsn}\")\n",
      "col_offset": 8,
      "end_col_offset": 23,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 339,
      "line_range": [
        339
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "366                 cur.execute(\n367                     f\"INSERT INTO t0(i) SELECT i FROM generate_series({batch_size} * %s, ({batch_size} * (%s + 1)) - 1) s(i)\",\n368                     (i, i),\n",
      "col_offset": 22,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 367,
      "line_range": [
        367
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "377             prev_size = collected_responses[-1][2]\n378             assert size > prev_size\n379 \n",
      "col_offset": 12,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 378,
      "line_range": [
        378
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "384                 cur.execute(\n385                     f\"UPDATE t0 SET i = -i WHERE i IN (SELECT i FROM t0 WHERE i > 0 LIMIT {batch_size})\"\n386                 )\n",
      "col_offset": 22,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 385,
      "line_range": [
        385
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "396             prev_size = collected_responses[-1][2]\n397             assert size > prev_size\n398 \n",
      "col_offset": 12,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 397,
      "line_range": [
        397
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "402             with endpoint.cursor() as cur:\n403                 cur.execute(f\"DELETE FROM t0 WHERE i IN (SELECT i FROM t0 LIMIT {batch_size})\")\n404                 deleted = cur.rowcount\n",
      "col_offset": 30,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 403,
      "line_range": [
        403
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "413             prev_size = collected_responses[-1][2]\n414             assert size > prev_size\n415 \n",
      "col_offset": 12,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 414,
      "line_range": [
        414
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "430         )\n431         assert size >= prev_size\n432         prev_size = size\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 431,
      "line_range": [
        431
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "442         )\n443         assert size < size_before_drop\n444 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 443,
      "line_range": [
        443
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "467 \n468     assert size_after == prev, \"size after restarting pageserver should not have changed\"\n469 \n",
      "col_offset": 4,
      "end_col_offset": 89,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 468,
      "line_range": [
        468
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "485 \n486     assert size_a == pytest.approx(size_b, abs=threshold)\n487 \n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 486,
      "line_range": [
        486
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "522         cur.execute(\n523             f\"CREATE TABLE t0 AS SELECT i::bigint n FROM generate_series(0, {batch_size}) s(i)\"\n524         )\n",
      "col_offset": 14,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 523,
      "line_range": [
        523
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "527     size_at_branch = http_client.tenant_size(tenant_id)\n528     assert size_at_branch > 0\n529 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 528,
      "line_range": [
        528
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "540         cur.execute(\n541             f\"CREATE TABLE t1 AS SELECT i::bigint n FROM generate_series(0, {batch_size}) s(i)\"\n542         )\n",
      "col_offset": 14,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 541,
      "line_range": [
        541
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "545     size_after_growing_first_branch = http_client.tenant_size(tenant_id)\n546     assert size_after_growing_first_branch > size_after_first_branch\n547 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 546,
      "line_range": [
        546
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "549         cur.execute(\n550             f\"CREATE TABLE t1 AS SELECT i::bigint n FROM generate_series(0, 2*{batch_size}) s(i)\"\n551         )\n",
      "col_offset": 14,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 550,
      "line_range": [
        550
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "554     size_after_continuing_on_main = http_client.tenant_size(tenant_id)\n555     assert size_after_continuing_on_main > size_after_growing_first_branch\n556 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 555,
      "line_range": [
        555
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "566         cur.execute(\n567             f\"CREATE TABLE t2 AS SELECT i::bigint n FROM generate_series(0, 3*{batch_size}) s(i)\"\n568         )\n",
      "col_offset": 14,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 567,
      "line_range": [
        567
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "571     size_after_growing_second_branch = http_client.tenant_size(tenant_id)\n572     assert size_after_growing_second_branch > size_after_second_branch\n573 \n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 572,
      "line_range": [
        572
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "580     size_after_thinning_branch = http_client.tenant_size(tenant_id)\n581     assert (\n582         size_after_thinning_branch > size_after_growing_second_branch\n583     ), \"tenant_size should grow with dropped tables and full vacuum\"\n584 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 581,
      "line_range": [
        581,
        582,
        583
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "606     size_after_deleting_first = http_client.tenant_size(tenant_id)\n607     assert size_after_deleting_first < size_after_thinning_branch\n608 \n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 607,
      "line_range": [
        607
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "610     size_after_deleting_second = http_client.tenant_size(tenant_id)\n611     assert size_after_deleting_second < size_after_deleting_first\n612 \n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 611,
      "line_range": [
        611
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "612 \n613     assert size_after_deleting_second < size_after_continuing_on_main\n614     assert size_after_deleting_second > size_after_first_branch\n",
      "col_offset": 4,
      "end_col_offset": 69,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 613,
      "line_range": [
        613
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "613     assert size_after_deleting_second < size_after_continuing_on_main\n614     assert size_after_deleting_second > size_after_first_branch\n615 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 614,
      "line_range": [
        614
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "734 \n735         assert size_lease == pytest.approx(size_branch, abs=threshold)\n736 \n",
      "col_offset": 8,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 735,
      "line_range": [
        735
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "14 def get_only_element(l):  # noqa: E741\n15     assert len(l) == 1\n16     return l[0]\n",
      "col_offset": 4,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_tasks.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 15,
      "line_range": [
        15
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "60     task_starts = client.get_metric_value(\"pageserver_tenant_task_events_total\", {\"event\": \"start\"})\n61     assert task_starts is not None\n62     assert int(task_starts) > 0\n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_tasks.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 61,
      "line_range": [
        61
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "61     assert task_starts is not None\n62     assert int(task_starts) > 0\n63     client.tenant_detach(tenant)\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_tasks.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "76         log.info(f\"started {tasks_started}, ended {tasks_ended}, panicked {tasks_panicked}\")\n77         assert tasks_started == tasks_ended\n78         assert tasks_panicked is None or int(tasks_panicked) == 0\n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_tasks.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 77,
      "line_range": [
        77
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77         assert tasks_started == tasks_ended\n78         assert tasks_panicked is None or int(tasks_panicked) == 0\n79 \n",
      "col_offset": 8,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenant_tasks.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "66     )\n67     assert initial_tenants == new_tenants, \"should not create new tenants\"\n68 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 67,
      "line_range": [
        67
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "99                 cur.execute(\"SELECT sum(key) FROM t\")\n100                 assert cur.fetchone() == (5000050000,)\n101 \n",
      "col_offset": 16,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 100,
      "line_range": [
        100
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "122                 cur.execute(\"SELECT sum(key) FROM t\")\n123                 assert cur.fetchone() == (5000050000,)\n124 \n",
      "col_offset": 16,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 123,
      "line_range": [
        123
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "168 \n169         assert ps_lsn <= max(sk_lsns)\n170         assert ps_lsn > Lsn(0)\n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 169,
      "line_range": [
        169
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "169         assert ps_lsn <= max(sk_lsns)\n170         assert ps_lsn > Lsn(0)\n171 \n",
      "col_offset": 8,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 170,
      "line_range": [
        170
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "205         # We expect some bytes to be read/written, to make sure metrics are working\n206         assert total_bytes > 0\n207 \n",
      "col_offset": 8,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 206,
      "line_range": [
        206
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "210         # Test that every safekeeper has read some bytes\n211         assert any(\n212             map(\n213                 lambda x: x.value > 0,\n214                 sk_m.query_all(\"safekeeper_pg_io_bytes_total\", {\"dir\": \"read\"}),\n215             )\n216         ), f\"{sk_m.name} has not read bytes\"\n217 \n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 211,
      "line_range": [
        211,
        212,
        213,
        214,
        215,
        216
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "218         # Test that every safekeeper has written some bytes\n219         assert any(\n220             map(\n221                 lambda x: x.value > 0,\n222                 sk_m.query_all(\"safekeeper_pg_io_bytes_total\", {\"dir\": \"write\"}),\n223             )\n224         ), f\"{sk_m.name} has not written bytes\"\n225 \n",
      "col_offset": 8,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 219,
      "line_range": [
        219,
        220,
        221,
        222,
        223,
        224
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "231         ps_samples = ps_metrics.query_all(metric, {})\n232         assert len(ps_samples) > 0, f\"expected at least one sample for {metric}\"\n233         for sample in ps_samples:\n",
      "col_offset": 8,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 232,
      "line_range": [
        232
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "244         value = ps_metrics.query_all(metric, filter={\"operation\": \"layer flush\"})\n245         assert value\n246 \n",
      "col_offset": 8,
      "end_col_offset": 20,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 245,
      "line_range": [
        245
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "274                 cur.execute(\"SELECT sum(key) FROM t\")\n275                 assert cur.fetchone() == (5000050000,)\n276         endpoint.stop()\n",
      "col_offset": 16,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 275,
      "line_range": [
        275
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "290         expected = set(PAGESERVER_PER_TENANT_METRICS)\n291         assert pre_detach_samples == expected\n292 \n",
      "col_offset": 8,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 291,
      "line_range": [
        291
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "295         post_detach_samples = set([x.name for x in get_ps_metric_samples_for_tenant(tenant)])\n296         assert post_detach_samples == set()\n297 \n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 296,
      "line_range": [
        296
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "315     )\n316     assert (\n317         files_in_timelines_dir == 0\n318     ), f\"Tenant {tenant_with_empty_timelines} should have an empty timelines/ directory\"\n319 \n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 316,
      "line_range": [
        316,
        317,
        318
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "329         tenants = client.tenant_list()\n330         assert len(tenants) == 1\n331         assert all(t[\"state\"][\"slug\"] != \"Attaching\" for t in tenants)\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 330,
      "line_range": [
        330
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "330         assert len(tenants) == 1\n331         assert all(t[\"state\"][\"slug\"] != \"Attaching\" for t in tenants)\n332 \n",
      "col_offset": 8,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 331,
      "line_range": [
        331
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "337     [loaded_tenant] = [t for t in tenants if t[\"id\"] == str(tenant_with_empty_timelines)]\n338     assert (\n339         loaded_tenant[\"state\"][\"slug\"] == \"Active\"\n340     ), \"Tenant {tenant_with_empty_timelines} with empty timelines dir should be active and ready for timeline creation\"\n341 \n",
      "col_offset": 4,
      "end_col_offset": 119,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 338,
      "line_range": [
        338,
        339,
        340
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "342     loaded_tenant_status = client.tenant_status(tenant_with_empty_timelines)\n343     assert (\n344         loaded_tenant_status[\"state\"][\"slug\"] == \"Active\"\n345     ), f\"Tenant {tenant_with_empty_timelines} without timelines dir should be active\"\n346 \n",
      "col_offset": 4,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 343,
      "line_range": [
        343,
        344,
        345
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "359 \n360     assert (\n361         tenant_active_count == 1\n362     ), f\"Tenant {tenant_with_empty_timelines} should have metric as active\"\n363 \n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 360,
      "line_range": [
        360,
        361,
        362
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "465     def only_int(samples: list[Sample]) -> int:\n466         assert len(samples) == 1\n467         return int(samples[0].value)\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 466,
      "line_range": [
        466
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "472 \n473     assert directory_entries_count > COUNT_AT_LEAST_EXPECTED\n474 \n",
      "col_offset": 4,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 473,
      "line_range": [
        473
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "477     counts = timeline_detail[\"directory_entries_counts\"]\n478     assert counts\n479     log.info(f\"directory counts: {counts}\")\n",
      "col_offset": 4,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 478,
      "line_range": [
        478
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "479     log.info(f\"directory counts: {counts}\")\n480     assert counts[2] > COUNT_AT_LEAST_EXPECTED\n481 \n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 480,
      "line_range": [
        480
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "43         await pg_conn.execute(\n44             f\"INSERT INTO t SELECT {i}*1000 + g, 'payload' from generate_series(1,1000) g\"\n45         )\n",
      "col_offset": 14,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 44,
      "line_range": [
        44
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "49         res = await pg_conn.fetchval(\"SELECT count(*) FROM t\")\n50         assert res == i * 1000\n51 \n",
      "col_offset": 8,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 50,
      "line_range": [
        50
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "105     data_id = 1\n106     data_secret = \"very secret secret\"\n107 \n",
      "col_offset": 18,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 259,
        "link": "https://cwe.mitre.org/data/definitions/259.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Possible hardcoded password: 'very secret secret'",
      "line_number": 106,
      "line_range": [
        106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b105_hardcoded_password_string.html",
      "test_id": "B105",
      "test_name": "hardcoded_password_string"
    },
    {
      "code": "131             cur.execute(\n132                 f\"\"\"\n133                 CREATE TABLE t{checkpoint_number}(id int primary key, secret text);\n134                 INSERT INTO t{checkpoint_number} VALUES ({data_id}, '{data_secret}|{checkpoint_number}');\n135             \"\"\"\n136             )\n",
      "col_offset": 20,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 132,
      "line_range": [
        132,
        133,
        134,
        135
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "171             break\n172     assert local_layer_deleted, f\"Found no local layer files to delete in directory {timeline_dir}\"\n173 \n",
      "col_offset": 4,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 172,
      "line_range": [
        172
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "187     restored_timelines = client.timeline_list(tenant_id)\n188     assert (\n189         len(restored_timelines) == 1\n190     ), f\"Tenant {tenant_id} should have its timeline reattached after its layer is downloaded from the remote storage\"\n191     restored_timeline = restored_timelines[0]\n",
      "col_offset": 4,
      "end_col_offset": 118,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 188,
      "line_range": [
        188,
        189,
        190
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "191     restored_timeline = restored_timelines[0]\n192     assert (\n193         restored_timeline[\"timeline_id\"] == str(timeline_id)\n194     ), f\"Tenant {tenant_id} should have its old timeline {timeline_id} restored from the remote storage\"\n195 \n",
      "col_offset": 4,
      "end_col_offset": 104,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192,
        193,
        194
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "196     # Check that we had to retry the downloads\n197     assert env.pageserver.log_contains(\".*download .* succeeded after 1 retries.*\")\n198 \n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 197,
      "line_range": [
        197
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "208 \n209     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n210 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 209,
      "line_range": [
        209
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "241             break\n242     assert (\n243         local_layer_truncated is not None\n244     ), f\"Found no local layer files to delete in directory {timeline_dir}\"\n245 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 242,
      "line_range": [
        242,
        243,
        244
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "249     index_part = env.pageserver_remote_storage.index_content(tenant_id, timeline_id)\n250     assert (\n251         index_part[\"layer_metadata\"][parse_layer_file_name(path.name).to_str()][\"file_size\"]\n252         == expected_size\n253     )\n254 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 250,
      "line_range": [
        250,
        251,
        252,
        253
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "266     restored_timelines = client.timeline_list(tenant_id)\n267     assert (\n268         len(restored_timelines) == 1\n269     ), f\"Tenant {tenant_id} should have its timeline reattached after its layer is downloaded from the remote storage\"\n270     retored_timeline = restored_timelines[0]\n",
      "col_offset": 4,
      "end_col_offset": 118,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 267,
      "line_range": [
        267,
        268,
        269
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "270     retored_timeline = restored_timelines[0]\n271     assert (\n272         retored_timeline[\"timeline_id\"] == str(timeline_id)\n273     ), f\"Tenant {tenant_id} should have its old timeline {timeline_id} restored from the remote storage\"\n274 \n",
      "col_offset": 4,
      "end_col_offset": 104,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 271,
      "line_range": [
        271,
        272,
        273
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "278 \n279     assert os.stat(path).st_size == expected_size, \"truncated layer should had been re-downloaded\"\n280 \n",
      "col_offset": 4,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 279,
      "line_range": [
        279
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "287     # extra http request has been made in between so assume it's enough delay\n288     assert (\n289         os.stat(remote_layer_path).st_size == expected_size\n290     ), \"truncated file should not had been uploaded around re-download\"\n291 \n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 288,
      "line_range": [
        288,
        289,
        290
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "305     # lines of python to do this.\n306     assert (\n307         os.stat(remote_layer_path).st_size == expected_size\n308     ), \"truncated file should not had been uploaded after next checkpoint\"\n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_tenants_with_remote_storage.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 306,
      "line_range": [
        306,
        307,
        308
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "52     vps_http = env.storage_controller.pageserver_api()\n53     assert vps_http.tenant_config(tenant_id).effective_config[\"eviction_policy\"] is None\n54 \n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_threshold_based_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 53,
      "line_range": [
        53
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "66     )\n67     assert vps_http.tenant_config(tenant_id).effective_config[\"eviction_policy\"] == {\n68         \"kind\": \"LayerAccessThreshold\",\n69         \"threshold\": f\"{eviction_threshold}s\",\n70         \"period\": f\"{eviction_period}s\",\n71     }\n72 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_threshold_based_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 67,
      "line_range": [
        67,
        68,
        69,
        70,
        71
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75 \n76     assert vps_http.tenant_config(tenant_id).effective_config[\"eviction_policy\"] == {\n77         \"kind\": \"LayerAccessThreshold\",\n78         \"threshold\": f\"{eviction_threshold}s\",\n79         \"period\": f\"{eviction_period}s\",\n80     }\n81 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_threshold_based_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76,
        77,
        78,
        79,
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "173     # instead of what we do here, i.e., stable _for at least_ X*threshold toward the end of the observation window\n174     assert (\n175         stable_for > consider_stable_when_no_change_for_seconds\n176     ), \"layer residencies did not become stable within the observation window\"\n177 \n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_threshold_based_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 174,
      "line_range": [
        174,
        175,
        176
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "178     post = map_info_changes[-1][1].by_local_and_remote()\n179     assert len(post.remote_layers) > 0, \"some layers should be evicted once it's stabilized\"\n180     assert len(post.local_layers) > 0, \"the imitate accesses should keep some layers resident\"\n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_threshold_based_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 179,
      "line_range": [
        179
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "179     assert len(post.remote_layers) > 0, \"some layers should be evicted once it's stabilized\"\n180     assert len(post.local_layers) > 0, \"the imitate accesses should keep some layers resident\"\n181 \n",
      "col_offset": 4,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_threshold_based_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 180,
      "line_range": [
        180
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "181 \n182     assert (\n183         env.pageserver.log_contains(metrics_refused_log_line) is not None\n184     ), \"ensure the metrics collection worker ran\"\n",
      "col_offset": 4,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_threshold_based_eviction.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 182,
      "line_range": [
        182,
        183,
        184
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "36 \n37     assert exc.value.status_code == 404\n38 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 37,
      "line_range": [
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "50 \n51     assert exc.value.status_code == 404\n52 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 51,
      "line_range": [
        51
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "71 \n72     assert exc.value.status_code == 412\n73 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 72,
      "line_range": [
        72
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77     )\n78     assert leaf_detail[\"is_archived\"] is False\n79 \n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89     )\n90     assert leaf_detail[\"is_archived\"] is True\n91 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "165     )\n166     assert leaf_detail[\"is_archived\"] is True\n167 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 166,
      "line_range": [
        166
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "191             ps_http.timeline_offload(tenant_id=tenant_id, timeline_id=parent_timeline_id)\n192         assert timeline_offloaded_logged(parent_timeline_id)\n193 \n",
      "col_offset": 8,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "196             ps_http.timeline_offload(tenant_id=tenant_id, timeline_id=leaf_timeline_id)\n197         assert timeline_offloaded_logged(leaf_timeline_id)\n198 \n",
      "col_offset": 8,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 197,
      "line_range": [
        197
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "215     )\n216     assert leaf_detail[\"is_archived\"] is False\n217 \n",
      "col_offset": 4,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 216,
      "line_range": [
        216
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "221         sum_again = endpoint.safe_psql(\"SELECT sum(key) from foo where key > 50\")\n222         assert sum == sum_again\n223 \n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 222,
      "line_range": [
        222
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "223 \n224     assert not timeline_offloaded_logged(initial_timeline_id)\n225 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 224,
      "line_range": [
        224
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "278     )\n279     assert leaf_detail[\"is_archived\"] is True\n280 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 279,
      "line_range": [
        279
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "289         ps_http.timeline_offload(tenant_id=tenant_id, timeline_id=child_timeline_id)\n290         assert timeline_offloaded_api(child_timeline_id)\n291 \n",
      "col_offset": 8,
      "end_col_offset": 56,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 290,
      "line_range": [
        290
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "293 \n294     assert timeline_offloaded_api(child_timeline_id)\n295     assert not timeline_offloaded_api(root_timeline_id)\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 294,
      "line_range": [
        294
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "294     assert timeline_offloaded_api(child_timeline_id)\n295     assert not timeline_offloaded_api(root_timeline_id)\n296 \n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 295,
      "line_range": [
        295
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "305 \n306     assert timeline_offloaded_api(child_timeline_id)\n307     assert not timeline_offloaded_api(root_timeline_id)\n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 306,
      "line_range": [
        306
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "306     assert timeline_offloaded_api(child_timeline_id)\n307     assert not timeline_offloaded_api(root_timeline_id)\n308 \n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 307,
      "line_range": [
        307
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "317     )\n318     assert child_detail[\"is_archived\"] is False\n319 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 318,
      "line_range": [
        318
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "323         sum_again = endpoint.safe_psql(\"SELECT sum(key) from foo where key < 500\")\n324         assert sum == sum_again\n325 \n",
      "col_offset": 8,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 324,
      "line_range": [
        324
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "330 \n331     assert not timeline_offloaded_api(root_timeline_id)\n332 \n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_archive.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 331,
      "line_range": [
        331
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "68 \n69     assert exc.value.status_code == 412\n70 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 69,
      "line_range": [
        69
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "86     ) as exc:\n87         assert timeline_path.exists()\n88 \n",
      "col_offset": 8,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 87,
      "line_range": [
        87
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "90 \n91     assert exc.value.status_code == 412\n92 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 91,
      "line_range": [
        91
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "93     timeline_path = env.pageserver.timeline_dir(env.initial_tenant, leaf_timeline_id)\n94     assert timeline_path.exists()\n95 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 94,
      "line_range": [
        94
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "103 \n104     assert not timeline_path.exists()\n105 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 104,
      "line_range": [
        104
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "111         ps_http.timeline_detail(env.initial_tenant, leaf_timeline_id)\n112     assert exc.value.status_code == 404\n113 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 112,
      "line_range": [
        112
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "253         # failpoint may not be the only error in the stack\n254         assert reason.endswith(f\"failpoint: {failpoint}\"), reason\n255 \n",
      "col_offset": 8,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 254,
      "line_range": [
        254
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "296     # Check local is empty\n297     assert (not timeline_dir.exists()) or len(os.listdir(timeline_dir)) == 0\n298 \n",
      "col_offset": 4,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 297,
      "line_range": [
        297
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "299     # Check no delete mark present\n300     assert not (timeline_dir.parent / f\"{timeline_id}.___deleted\").exists()\n301 \n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 300,
      "line_range": [
        300
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "383     timelines = ps_http.timeline_list(tenant_id=tenant_id)\n384     assert {TimelineId(tl[\"timeline_id\"]) for tl in timelines} == {\n385         main_timeline_id\n386     }, \"the deleted timeline should not have been resurrected\"\n387     assert all([tl[\"state\"] == \"Active\" for tl in timelines])\n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 384,
      "line_range": [
        384,
        385,
        386
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "386     }, \"the deleted timeline should not have been resurrected\"\n387     assert all([tl[\"state\"] == \"Active\" for tl in timelines])\n388 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 387,
      "line_range": [
        387
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "431 \n432     assert timeline_info[\"state\"][\"Broken\"][\"reason\"] == \"failpoint: timeline-delete-before-rm\"\n433 \n",
      "col_offset": 4,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 432,
      "line_range": [
        432
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "433 \n434     assert leaf_timeline_path.exists(), \"the failpoint didn't work\"\n435 \n",
      "col_offset": 4,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 434,
      "line_range": [
        434
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "443 \n444     assert (\n445         not leaf_timeline_path.exists()\n446     ), \"timeline load procedure should have resumed the deletion interrupted by the failpoint\"\n447     timelines = ps_http.timeline_list(env.initial_tenant)\n",
      "col_offset": 4,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 444,
      "line_range": [
        444,
        445,
        446
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "447     timelines = ps_http.timeline_list(env.initial_tenant)\n448     assert {TimelineId(tl[\"timeline_id\"]) for tl in timelines} == {\n449         intermediate_timeline_id,\n450         env.initial_timeline,\n451     }, \"other timelines should not have been affected\"\n452     assert all([tl[\"state\"] == \"Active\" for tl in timelines])\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 448,
      "line_range": [
        448,
        449,
        450,
        451
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "451     }, \"other timelines should not have been affected\"\n452     assert all([tl[\"state\"] == \"Active\" for tl in timelines])\n453 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 452,
      "line_range": [
        452
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "553             ps_http.timeline_delete(env.initial_tenant, child_timeline_id)\n554         assert second_call_err.value.status_code == 409\n555         env.pageserver.allowed_errors.extend(\n",
      "col_offset": 8,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 554,
      "line_range": [
        554
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "565         detail = ps_http.timeline_detail(env.initial_tenant, child_timeline_id)\n566         assert detail[\"state\"] == \"Stopping\"\n567 \n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 566,
      "line_range": [
        566
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "571         result = first_call_result.get()\n572         assert result == \"success\"\n573 \n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 572,
      "line_range": [
        572
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "731 \n732     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n733 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 732,
      "line_range": [
        732
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "767     reason = timeline_info[\"state\"][\"Broken\"][\"reason\"]\n768     assert reason.endswith(f\"failpoint: {failpoint}\"), reason\n769 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 768,
      "line_range": [
        768
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "772     for orphan in orphans:\n773         assert not orphan.exists()\n774         env.pageserver.assert_log_contains(\n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 773,
      "line_range": [
        773
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "777 \n778     assert env.pageserver_remote_storage.index_path(env.initial_tenant, timeline_id).exists()\n779 \n",
      "col_offset": 4,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 778,
      "line_range": [
        778
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "845     # failpoint may not be the only error in the stack\n846     assert reason.endswith(f\"failpoint: {failpoint}\"), reason\n847 \n",
      "col_offset": 4,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 846,
      "line_range": [
        846
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "876     tenant_path = env.pageserver.timeline_dir(tenant_id, timeline_id)\n877     assert not tenant_path.exists()\n878 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_delete.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 877,
      "line_range": [
        877
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "28 def by_end_lsn(info: HistoricLayerInfo) -> Lsn:\n29     assert info.lsn_end is not None\n30     return Lsn(info.lsn_end)\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 29,
      "line_range": [
        29
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "104     # there is also the in-mem layer, but ignore it for now\n105     assert len(deltas) == 2, \"expecting there to be two deltas: initdb and checkpointed\"\n106     later_delta = max(deltas, key=by_end_lsn)\n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 105,
      "line_range": [
        105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "106     later_delta = max(deltas, key=by_end_lsn)\n107     assert later_delta.lsn_end is not None\n108 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 107,
      "line_range": [
        107
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "129         # this case also covers the implicit flush of ancestor as the inmemory hasn't been flushed yet\n130         assert branchpoint == Branchpoint.LAST_RECORD_LSN\n131         branch_at = None\n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 130,
      "line_range": [
        130
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "143     else:\n144         assert branch_at == recorded, \"the test should not use unaligned lsns\"\n145 \n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 144,
      "line_range": [
        144
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "147         with env.endpoints.create_start(name, tenant_id=env.initial_tenant) as ep:\n148             assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n149             # make sure the ep is writable\n",
      "col_offset": 12,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 148,
      "line_range": [
        148
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "169     all_reparented = client.detach_ancestor(env.initial_tenant, timeline_id)\n170     assert all_reparented == set()\n171 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 170,
      "line_range": [
        170
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "176     with env.endpoints.create_start(\"main\", tenant_id=env.initial_tenant) as ep:\n177         assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == 16384\n178 \n",
      "col_offset": 8,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 177,
      "line_range": [
        177
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "179     with env.endpoints.create_start(name, tenant_id=env.initial_tenant) as ep:\n180         assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n181 \n",
      "col_offset": 8,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 180,
      "line_range": [
        180
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "190 \n191     assert len(new_main_truncated) == truncated_layers\n192     # could additionally check that the symmetric difference has layers starting at the same lsn\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 191,
      "line_range": [
        191
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "278     all_reparented = client.detach_ancestor(env.initial_tenant, timeline_id)\n279     assert set(all_reparented) == {reparented, same_branchpoint}\n280 \n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 279,
      "line_range": [
        279
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "291 \n292     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n293 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 292,
      "line_range": [
        292
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "297         if expected_ancestor is None:\n298             assert ancestor_timeline_id is None\n299         else:\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 298,
      "line_range": [
        298
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "299         else:\n300             assert TimelineId(ancestor_timeline_id) == expected_ancestor\n301 \n",
      "col_offset": 12,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 300,
      "line_range": [
        300
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "305         lineage = index_part[\"lineage\"]\n306         assert lineage is not None\n307 \n",
      "col_offset": 8,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 306,
      "line_range": [
        306
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "307 \n308         assert lineage.get(\"reparenting_history_overflown\", \"false\") == \"false\"\n309 \n",
      "col_offset": 8,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 308,
      "line_range": [
        308
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "311             original_ancestor = lineage[\"original_ancestor\"]\n312             assert original_ancestor is not None\n313             assert original_ancestor[0] == str(env.initial_timeline)\n",
      "col_offset": 12,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 312,
      "line_range": [
        312
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "312             assert original_ancestor is not None\n313             assert original_ancestor[0] == str(env.initial_timeline)\n314             assert original_ancestor[1] == str(branchpoint_x)\n",
      "col_offset": 12,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 313,
      "line_range": [
        313
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "313             assert original_ancestor[0] == str(env.initial_timeline)\n314             assert original_ancestor[1] == str(branchpoint_x)\n315 \n",
      "col_offset": 12,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 314,
      "line_range": [
        314
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "319             when_ts = datetime.datetime.fromisoformat(when)\n320             assert when_ts < datetime.datetime.now()\n321             assert len(lineage.get(\"reparenting_history\", [])) == 0\n",
      "col_offset": 12,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 320,
      "line_range": [
        320
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "320             assert when_ts < datetime.datetime.now()\n321             assert len(lineage.get(\"reparenting_history\", [])) == 0\n322         elif expected_ancestor == timeline_id:\n",
      "col_offset": 12,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 321,
      "line_range": [
        321
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "322         elif expected_ancestor == timeline_id:\n323             assert len(lineage.get(\"original_ancestor\", [])) == 0\n324             assert lineage[\"reparenting_history\"] == [str(env.initial_timeline)]\n",
      "col_offset": 12,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 323,
      "line_range": [
        323
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "323             assert len(lineage.get(\"original_ancestor\", [])) == 0\n324             assert lineage[\"reparenting_history\"] == [str(env.initial_timeline)]\n325         else:\n",
      "col_offset": 12,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 324,
      "line_range": [
        324
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "325         else:\n326             assert len(lineage.get(\"original_ancestor\", [])) == 0\n327             assert len(lineage.get(\"reparenting_history\", [])) == 0\n",
      "col_offset": 12,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 326,
      "line_range": [
        326
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "326             assert len(lineage.get(\"original_ancestor\", [])) == 0\n327             assert len(lineage.get(\"reparenting_history\", [])) == 0\n328 \n",
      "col_offset": 12,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 327,
      "line_range": [
        327
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "330         with env.endpoints.create_start(name, tenant_id=env.initial_tenant) as ep:\n331             assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n332             assert ep.safe_psql(f\"SELECT count(*) FROM audit WHERE starts = {starts}\")[0][0] == 1\n",
      "col_offset": 12,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 331,
      "line_range": [
        331
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "331             assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n332             assert ep.safe_psql(f\"SELECT count(*) FROM audit WHERE starts = {starts}\")[0][0] == 1\n333 \n",
      "col_offset": 12,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 332,
      "line_range": [
        332
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "331             assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n332             assert ep.safe_psql(f\"SELECT count(*) FROM audit WHERE starts = {starts}\")[0][0] == 1\n333 \n",
      "col_offset": 34,
      "end_col_offset": 76,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 332,
      "line_range": [
        332
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "354         ep.safe_psql(\n355             f\"INSERT INTO foo SELECT i::bigint, 'more info!! this is a long string' || i FROM generate_series(0, {n - 1}) g(i);\"\n356         )\n",
      "col_offset": 14,
      "end_col_offset": 113,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 355,
      "line_range": [
        355
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "372     ep = env.endpoints.create_start(\"new main\", tenant_id=env.initial_tenant)\n373     assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n374 \n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 373,
      "line_range": [
        373
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "404         reparented = client.detach_ancestor(env.initial_tenant, timeline_id)\n405         assert len(reparented) == 0\n406 \n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 405,
      "line_range": [
        405
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "410         extra_rows = completion.result()\n411         assert extra_rows > 0, \"some rows should had been written\"\n412         rows += extra_rows\n",
      "col_offset": 8,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 411,
      "line_range": [
        411
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "413 \n414     assert client.timeline_detail(env.initial_tenant, timeline_id)[\"ancestor_timeline_id\"] is None\n415 \n",
      "col_offset": 4,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 414,
      "line_range": [
        414
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "416     ep.clear_shared_buffers()\n417     assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n418     assert ep.safe_psql(\"SELECT SUM(LENGTH(aux)) FROM foo\")[0][0] != 0\n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 417,
      "line_range": [
        417
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "417     assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n418     assert ep.safe_psql(\"SELECT SUM(LENGTH(aux)) FROM foo\")[0][0] != 0\n419     ep.stop()\n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 418,
      "line_range": [
        418
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "422     with env.endpoints.create_start(\"new main\", tenant_id=env.initial_tenant) as ep:\n423         assert ep.safe_psql(\"SELECT count(*) FROM foo;\")[0][0] == rows\n424 \n",
      "col_offset": 8,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 423,
      "line_range": [
        423
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "472 \n473         assert len(delta_layers(env.initial_timeline)) == 2\n474 \n",
      "col_offset": 8,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 473,
      "line_range": [
        473
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "489             ep.safe_psql(\n490                 f\"insert into integers (i) select i from generate_series({num}, {num + 100}) as s(i)\"\n491             )\n",
      "col_offset": 18,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 490,
      "line_range": [
        490
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "494 \n495         assert len(delta_layers(branch_timeline_id)) == 1\n496 \n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 495,
      "line_range": [
        495
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "504         for suffix in range(0, 4):\n505             ep.safe_psql(f\"create table other_table_{suffix} as select * from integers\")\n506             wait_for_last_flush_lsn(env, ep, env.initial_tenant, branch_timeline_id)\n",
      "col_offset": 27,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 505,
      "line_range": [
        505
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "509 \n510         assert last_suffix is not None\n511 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 510,
      "line_range": [
        510
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "511 \n512         assert len(delta_layers(branch_timeline_id)) == 5\n513 \n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 512,
      "line_range": [
        512
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "520         # one more layer\n521         ep.safe_psql(f\"create table other_table_{last_suffix + 1} as select * from integers\")\n522         wait_for_last_flush_lsn(env, ep, env.initial_tenant, branch_timeline_id)\n",
      "col_offset": 23,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 521,
      "line_range": [
        521
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "527 \n528     assert len([filter(lambda x: x.l0, delta_layers(branch_timeline_id))]) == 1\n529 \n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 528,
      "line_range": [
        528
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "548         reparented = client.detach_ancestor(env.initial_tenant, timeline_id)\n549         assert reparented == set(), \"we have no earlier branches at any level\"\n550 \n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 549,
      "line_range": [
        549
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "551     post_detach_l0s = list(filter(lambda x: x.l0, delta_layers(branch_timeline_id)))\n552     assert len(post_detach_l0s) == 5, \"should had inherited 4 L0s, have 5 in total\"\n553 \n",
      "col_offset": 4,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 552,
      "line_range": [
        552
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "567     post_compact_l0s = list(filter(lambda x: x.l0, delta_layers(branch_timeline_id)))\n568     assert len(post_compact_l0s) == 1, \"only the consecutive inherited L0s should be compacted\"\n569 \n",
      "col_offset": 4,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 568,
      "line_range": [
        568
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "610     first_reparenting_response = client.detach_ancestor(env.initial_tenant, first_branch)\n611     assert set(first_reparenting_response) == {reparented1, reparented2}\n612 \n",
      "col_offset": 4,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 611,
      "line_range": [
        611
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "618         # once completed, we can retry this how many times\n619         assert (\n620             client.detach_ancestor(env.initial_tenant, first_branch) == first_reparenting_response\n621         )\n622 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 619,
      "line_range": [
        619,
        620,
        621
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "626         client.detach_ancestor(env.initial_tenant, first_branch)\n627     assert e.value.status_code == 404\n628 \n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 627,
      "line_range": [
        627
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "656         client.detach_ancestor(env.initial_tenant, env.initial_timeline)\n657     assert info.value.status_code == 409\n658 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 657,
      "line_range": [
        657
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "665         client.detach_ancestor(env.initial_tenant, second_branch)\n666     assert info.value.status_code == 400\n667 \n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 666,
      "line_range": [
        666
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "695     utilized_pageservers = {x[\"node_id\"] for x in shards}\n696     assert len(utilized_pageservers) > 1, \"all shards got placed on single pageserver?\"\n697 \n",
      "col_offset": 4,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 696,
      "line_range": [
        696
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "712 \n713         assert Lsn(detail[\"last_record_lsn\"]) >= lsn\n714         assert Lsn(detail[\"initdb_lsn\"]) < lsn\n",
      "col_offset": 8,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 713,
      "line_range": [
        713
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "713         assert Lsn(detail[\"last_record_lsn\"]) >= lsn\n714         assert Lsn(detail[\"initdb_lsn\"]) < lsn\n715         assert TimelineId(detail[\"ancestor_timeline_id\"]) == env.initial_timeline\n",
      "col_offset": 8,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 714,
      "line_range": [
        714
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "714         assert Lsn(detail[\"initdb_lsn\"]) < lsn\n715         assert TimelineId(detail[\"ancestor_timeline_id\"]) == env.initial_timeline\n716 \n",
      "col_offset": 8,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 715,
      "line_range": [
        715
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "730     restarted.allowed_errors.append(\".*: Cancelled request finished with an error: ShuttingDown\")\n731     assert restarted.id != stuck.id\n732     restarted_http = restarted.http_client()\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 731,
      "line_range": [
        731
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "787         except PageserverApiException as info:\n788             assert info.status_code == 503\n789             time.sleep(2)\n",
      "col_offset": 12,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 788,
      "line_range": [
        788
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "792 \n793     assert reparented == set(), \"too many retries (None) or unexpected reparentings\"\n794 \n",
      "col_offset": 4,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 793,
      "line_range": [
        793
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "804         )\n805         assert detail.get(\"ancestor_timeline_id\") is None\n806 \n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 805,
      "line_range": [
        805
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "808         count = int(ep.safe_psql(\"select count(*) from foo\")[0][0])\n809         assert count == 10000\n810 \n",
      "col_offset": 8,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 809,
      "line_range": [
        809
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "856 \n857     assert len(set(info[\"node_id\"] for info in shards)) == shard_count\n858 \n",
      "col_offset": 4,
      "end_col_offset": 70,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 857,
      "line_range": [
        857
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "901         except PageserverApiException as e:\n902             assert e.status_code == 404\n903             return True\n",
      "col_offset": 12,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 902,
      "line_range": [
        902
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "919 \n920             assert wait_until(10, 1.0, is_deleted), f\"unimplemented mode {mode}\"\n921 \n",
      "col_offset": 12,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 920,
      "line_range": [
        920
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "925             log.info(f\"TODO: match this error: {exc.value}\")\n926             assert exc.value.status_code == 503\n927         finally:\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 926,
      "line_range": [
        926
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "972     shards = env.storage_controller.locate(env.initial_tenant)\n973     assert len(set(x[\"node_id\"] for x in shards)) == shard_count\n974 \n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 973,
      "line_range": [
        973
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1033         log.info(detail)\n1034         assert detail.get(\"ancestor_lsn\") is None\n1035 \n",
      "col_offset": 8,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1034,
      "line_range": [
        1034
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1036     def first_branch_gone():\n1037         assert first_branch is not None\n1038         try:\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1037,
      "line_range": [
        1037
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1043             log.info(f\"error {e}\")\n1044             assert e.status_code == 404\n1045         else:\n",
      "col_offset": 12,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1044,
      "line_range": [
        1044
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1058             if mode == \"delete_reparentable_timeline\":\n1059                 assert first_branch is not None\n1060                 env.storage_controller.pageserver_api().timeline_delete(\n",
      "col_offset": 16,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1059,
      "line_range": [
        1059
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1100             if mode == \"delete_reparentable_timeline\":\n1101                 assert (\n1102                     retried is None\n1103                 ), \"detaching should had converged after both nodes saw the deletion\"\n1104             elif mode == \"create_reparentable_timeline\":\n",
      "col_offset": 16,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1101,
      "line_range": [
        1101,
        1102,
        1103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1104             elif mode == \"create_reparentable_timeline\":\n1105                 assert retried is not None, \"detaching should not have converged\"\n1106                 _, offset = retried\n",
      "col_offset": 16,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1105,
      "line_range": [
        1105
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1111     if mode == \"create_reparentable_timeline\":\n1112         assert first_branch is not None\n1113         # now we have mixed ancestry\n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1112,
      "line_range": [
        1112
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1113         # now we have mixed ancestry\n1114         assert (\n1115             TimelineId(\n1116                 stuck_http.timeline_detail(shards[0][\"shard_id\"], first_branch)[\n1117                     \"ancestor_timeline_id\"\n1118                 ]\n1119             )\n1120             == env.initial_timeline\n1121         )\n1122         assert (\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1114,
      "line_range": [
        1114,
        1115,
        1116,
        1117,
        1118,
        1119,
        1120,
        1121
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1121         )\n1122         assert (\n1123             TimelineId(\n1124                 victim_http.timeline_detail(shards[-1][\"shard_id\"], first_branch)[\n1125                     \"ancestor_timeline_id\"\n1126                 ]\n1127             )\n1128             == detached_branch\n1129         )\n1130 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1122,
      "line_range": [
        1122,
        1123,
        1124,
        1125,
        1126,
        1127,
        1128,
        1129
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1140 \n1141         assert not_found is None\n1142         assert (\n",
      "col_offset": 8,
      "end_col_offset": 32,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1141,
      "line_range": [
        1141
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1141         assert not_found is None\n1142         assert (\n1143             stuck_http.timeline_detail(shards[0][\"shard_id\"], first_branch)[\"ancestor_timeline_id\"]\n1144             is None\n1145         )\n1146         assert (\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1142,
      "line_range": [
        1142,
        1143,
        1144,
        1145
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1145         )\n1146         assert (\n1147             victim_http.timeline_detail(shards[-1][\"shard_id\"], first_branch)[\n1148                 \"ancestor_timeline_id\"\n1149             ]\n1150             is None\n1151         )\n1152 \n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1146,
      "line_range": [
        1146,
        1147,
        1148,
        1149,
        1150,
        1151
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1167     shards = env.storage_controller.locate(env.initial_tenant)\n1168     assert len(set(x[\"node_id\"] for x in shards)) == shard_count\n1169 \n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1168,
      "line_range": [
        1168
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1202         log.info(detail)\n1203         assert detail.get(\"ancestor_lsn\") is None\n1204 \n",
      "col_offset": 8,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1203,
      "line_range": [
        1203
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1220                 fut.result()\n1221             assert exc.value.status_code == 500\n1222 \n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1221,
      "line_range": [
        1221
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1290             ep.safe_psql(\n1291                 f\"create table foo_{counter} as select i::bigint from generate_series(1, 10000) t(i)\"\n1292             )\n",
      "col_offset": 18,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 1291,
      "line_range": [
        1291
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "1303     detached = timelines.pop()\n1304     assert len(timelines) == 4\n1305 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1304,
      "line_range": [
        1304
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1319             http.detach_ancestor(env.initial_tenant, detached)\n1320         assert exc.value.status_code == 503\n1321 \n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1320,
      "line_range": [
        1320
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1324 \n1325     assert (\n1326         http.timeline_detail(env.initial_tenant, detached)[\"ancestor_timeline_id\"] is None\n1327     ), \"first round should had detached 'detached'\"\n1328 \n",
      "col_offset": 4,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1325,
      "line_range": [
        1325,
        1326,
        1327
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1329     reparented, not_reparented = reparenting_progress(timelines)\n1330     assert reparented == 1\n1331 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1330,
      "line_range": [
        1330
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1342     metric = remote_storage_copy_requests()\n1343     assert metric != 0\n1344     # make sure the gc blocking is persistent over a restart\n",
      "col_offset": 4,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1343,
      "line_range": [
        1343
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1348     _, offset = env.pageserver.assert_log_contains(\".*: attach finished, activating\", offset)\n1349     assert env.pageserver.log_contains(\".* gc_loop.*: [0-9] timelines need GC\", offset) is None\n1350     _, offset = env.pageserver.assert_log_contains(\n",
      "col_offset": 4,
      "end_col_offset": 95,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1349,
      "line_range": [
        1349
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1362 \n1363         assert (\n1364             http.timeline_detail(env.initial_tenant, detached)[\"ancestor_timeline_id\"] is None\n1365         ), \"first round should had detached 'detached'\"\n1366 \n",
      "col_offset": 8,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1363,
      "line_range": [
        1363,
        1364,
        1365
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1367         reparented, not_reparented = reparenting_progress(timelines)\n1368         assert reparented == reparented_before + 1\n1369         reparented_before = reparented\n",
      "col_offset": 8,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1368,
      "line_range": [
        1368
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1372         metric = remote_storage_copy_requests()\n1373         assert metric == 0, \"copies happen in the first round\"\n1374 \n",
      "col_offset": 8,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1373,
      "line_range": [
        1373
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1374 \n1375     assert offset is not None\n1376     assert len(not_reparented) == 1\n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1375,
      "line_range": [
        1375
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1375     assert offset is not None\n1376     assert len(not_reparented) == 1\n1377 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1376,
      "line_range": [
        1376
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1385         http.detach_ancestor(env.initial_tenant, detached)\n1386     assert exc.value.status_code == 500\n1387     _, offset = env.pageserver.assert_log_contains(\".*: attach finished, activating\", offset)\n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1386,
      "line_range": [
        1386
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1397     reparented_resp = http.detach_ancestor(env.initial_tenant, detached)\n1398     assert reparented_resp == set(timelines)\n1399     # no need to quiesce_tenants anymore, because completion does that\n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1398,
      "line_range": [
        1398
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1401     reparented, not_reparented = reparenting_progress(timelines)\n1402     assert reparented == len(timelines)\n1403 \n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1402,
      "line_range": [
        1402
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1404     time.sleep(2)\n1405     assert (\n1406         env.pageserver.log_contains(\".*: attach finished, activating\", offset) is None\n1407     ), \"there should be no restart with the final detach_ancestor as it only completed\"\n1408 \n",
      "col_offset": 4,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1405,
      "line_range": [
        1405,
        1406,
        1407
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1412     metric = remote_storage_copy_requests()\n1413     assert metric == 0\n1414 \n",
      "col_offset": 4,
      "end_col_offset": 22,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1413,
      "line_range": [
        1413
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1477                 detach.result()\n1478             assert exc.value.status_code == 404\n1479     finally:\n",
      "col_offset": 12,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_detach_ancestor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1478,
      "line_range": [
        1478
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "50     tenant_after = http.tenant_status(env.initial_tenant)\n51     assert tenant_before != tenant_after\n52     gc_blocking = tenant_after[\"gc_blocking\"]\n",
      "col_offset": 4,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_gc_blocking.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 51,
      "line_range": [
        51
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "52     gc_blocking = tenant_after[\"gc_blocking\"]\n53     assert gc_blocking == \"BlockingReasons { timelines: 1, reasons: EnumSet(Manual) }\"\n54 \n",
      "col_offset": 4,
      "end_col_offset": 86,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_gc_blocking.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 53,
      "line_range": [
        53
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "100     def assert_log_does_not_contain(self, what: str):\n101         assert self.pageserver.log_contains(what) is None\n102 \n",
      "col_offset": 8,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_gc_blocking.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 101,
      "line_range": [
        101
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "61             )\n62             assert res[\"current_logical_size\"] == res[\"current_logical_size_non_incremental\"]\n63             cur.execute(\"TRUNCATE foo\")\n",
      "col_offset": 12,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 62,
      "line_range": [
        62
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "67             )\n68             assert res[\"current_logical_size\"] == res[\"current_logical_size_non_incremental\"]\n69 \n",
      "col_offset": 12,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 68,
      "line_range": [
        68
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "89             )\n90             assert res[\"current_logical_size\"] == res[\"current_logical_size_non_incremental\"]\n91             assert (\n",
      "col_offset": 12,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 90,
      "line_range": [
        90
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "90             assert res[\"current_logical_size\"] == res[\"current_logical_size_non_incremental\"]\n91             assert (\n92                 timeline_details[\"current_logical_size_non_incremental\"]\n93                 == res[\"current_logical_size_non_incremental\"]\n94             ), \"no writes should not change the incremental logical size\"\n95 \n",
      "col_offset": 12,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 91,
      "line_range": [
        91,
        92,
        93,
        94
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "112                     )\n113                     assert (\n114                         res[\"current_logical_size\"] == res[\"current_logical_size_non_incremental\"]\n115                     )\n116 \n",
      "col_offset": 20,
      "end_col_offset": 21,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 113,
      "line_range": [
        113,
        114,
        115
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "121             )\n122             assert res[\"current_logical_size\"] == res[\"current_logical_size_non_incremental\"]\n123 \n",
      "col_offset": 12,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 122,
      "line_range": [
        122
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "194                 )[\"current_logical_size\"]\n195                 assert logical_size > size_limit_mb * 1024 * 1024\n196                 write_rows(2500)\n",
      "col_offset": 16,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 195,
      "line_range": [
        195
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "313     )\n314     assert (\n315         new_res[\"current_logical_size\"] == new_res[\"current_logical_size_non_incremental\"]\n316     ), \"after the WAL is streamed, current_logical_size is expected to be calculated and to be equal its non-incremental value\"\n317 \n",
      "col_offset": 4,
      "end_col_offset": 127,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 314,
      "line_range": [
        314,
        315,
        316
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "352         )\n353         assert details[\"current_logical_size\"] != details[\"current_logical_size_non_incremental\"]\n354 \n",
      "col_offset": 8,
      "end_col_offset": 97,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 353,
      "line_range": [
        353
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "576     timeline_path = env.pageserver.timeline_dir(env.initial_tenant, new_timeline_id)\n577     assert tl_physical_size_metric == get_timeline_dir_size(timeline_path)\n578 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 577,
      "line_range": [
        577
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "607     # the SLRUs that are not included in pg_database_size().\n608     assert math.isclose(tl_logical_size_metric, vanilla_size_sum, abs_tol=2 * 1024 * 1024)\n609 \n",
      "col_offset": 4,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 608,
      "line_range": [
        608
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "613     dbsize_sum = endpoint.safe_psql(\"select sum(pg_database_size(oid)) from pg_database\")[0][0]\n614     assert math.isclose(dbsize_sum, tl_logical_size_metric, abs_tol=2 * 1024 * 1024)\n615 \n",
      "col_offset": 4,
      "end_col_offset": 84,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 614,
      "line_range": [
        614
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "635     for i in range(10):\n636         n_rows = random.randint(100, 1000)\n637 \n",
      "col_offset": 17,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 636,
      "line_range": [
        636
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "643                 \"CREATE TABLE foo (t text)\",\n644                 f\"INSERT INTO foo SELECT 'long string to consume some space' || g FROM generate_series(1, {n_rows}) g\",\n645             ]\n",
      "col_offset": 18,
      "end_col_offset": 106,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 644,
      "line_range": [
        644
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "660     )\n661     assert tenant_current_physical_size == sum(\n662         [tl[\"current_physical_size\"] for tl in client.timeline_list(tenant_id=tenant)]\n663     )\n664     # since we don't do layer eviction, current_physical_size is identical to resident physical size\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 661,
      "line_range": [
        661,
        662,
        663
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "664     # since we don't do layer eviction, current_physical_size is identical to resident physical size\n665     assert timeline_total_resident_physical_size == tenant_current_physical_size\n666 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 665,
      "line_range": [
        665
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "711     # resident phyiscal size is defined as\n712     assert sizes.python_timelinedir_layerfiles_physical == sizes.prometheus_resident_physical\n713     assert sizes.python_timelinedir_layerfiles_physical == sizes.layer_map_file_size_sum\n",
      "col_offset": 4,
      "end_col_offset": 93,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 712,
      "line_range": [
        712
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "712     assert sizes.python_timelinedir_layerfiles_physical == sizes.prometheus_resident_physical\n713     assert sizes.python_timelinedir_layerfiles_physical == sizes.layer_map_file_size_sum\n714 \n",
      "col_offset": 4,
      "end_col_offset": 88,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 713,
      "line_range": [
        713
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "715     # we don't do layer eviction, so, all layers are resident\n716     assert sizes.api_current_physical == sizes.prometheus_resident_physical\n717     assert sizes.prometheus_resident_physical == sizes.prometheus_remote_physical\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 716,
      "line_range": [
        716
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "716     assert sizes.api_current_physical == sizes.prometheus_resident_physical\n717     assert sizes.prometheus_resident_physical == sizes.prometheus_remote_physical\n718     # XXX would be nice to assert layer file physical storage utilization here as well, but we can only do that for LocalFS\n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 717,
      "line_range": [
        717
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "722     def condition():\n723         assert client.get_metric_value(\"pageserver_tenant_startup_complete_total\") == count\n724 \n",
      "col_offset": 8,
      "end_col_offset": 91,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 723,
      "line_range": [
        723
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "768     def at_least_one_active():\n769         assert \"Active\" in set(get_tenant_states().values())\n770 \n",
      "col_offset": 8,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 769,
      "line_range": [
        769
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "780     states = get_tenant_states()\n781     assert len([s for s in states.values() if s == \"Active\"]) == expect_activated\n782     assert len([s for s in states.values() if s == \"Attaching\"]) == n_tenants - expect_activated\n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 781,
      "line_range": [
        781
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "781     assert len([s for s in states.values() if s == \"Active\"]) == expect_activated\n782     assert len([s for s in states.values() if s == \"Attaching\"]) == n_tenants - expect_activated\n783 \n",
      "col_offset": 4,
      "end_col_offset": 96,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 782,
      "line_range": [
        782
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "783 \n784     assert (\n785         pageserver_http.get_metric_value(\"pageserver_tenant_startup_scheduled_total\") == n_tenants\n786     )\n787 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 784,
      "line_range": [
        784,
        785,
        786
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "790     # that reached Active is still stuck in its local size calculation, and has therefore not finished warmup.\n791     assert pageserver_http.get_metric_value(\"pageserver_tenant_startup_complete_total\") == 0\n792 \n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 791,
      "line_range": [
        791
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "809     expect_activated += 1\n810     assert pageserver_http.tenant_status(tenant_id=stuck_tenant_id)[\"state\"][\"slug\"] == \"Active\"\n811     wait_for_tenant_startup_completions(pageserver_http, count=expect_activated - 1)\n",
      "col_offset": 4,
      "end_col_offset": 96,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 810,
      "line_range": [
        810
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "813     # The ones we didn't touch are still in Attaching\n814     assert (\n815         len([s for s in get_tenant_states().values() if s == \"Attaching\"])\n816         == n_tenants - expect_activated\n817     )\n818 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 814,
      "line_range": [
        814,
        815,
        816,
        817
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "824     expect_activated += 1\n825     assert pageserver_http.tenant_status(tenant_id=stuck_tenant_id)[\"state\"][\"slug\"] == \"Active\"\n826     assert (\n",
      "col_offset": 4,
      "end_col_offset": 96,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 825,
      "line_range": [
        825
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "825     assert pageserver_http.tenant_status(tenant_id=stuck_tenant_id)[\"state\"][\"slug\"] == \"Active\"\n826     assert (\n827         len([s for s in get_tenant_states().values() if s == \"Attaching\"])\n828         == n_tenants - expect_activated\n829     )\n830 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 826,
      "line_range": [
        826,
        827,
        828,
        829
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "837     def all_active():\n838         assert all(s == \"Active\" for s in get_tenant_states().values())\n839 \n",
      "col_offset": 8,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 838,
      "line_range": [
        838
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "847 \n848     assert (\n849         pageserver_http.get_metric_value(\"pageserver_tenant_startup_scheduled_total\") == n_tenants\n850     )\n851     wait_for_tenant_startup_completions(pageserver_http, count=n_tenants)\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 848,
      "line_range": [
        848,
        849,
        850
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "885     wait_until(10, 1, all_active)\n886     assert len(get_tenant_states()) == n_tenants - 2\n887 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 886,
      "line_range": [
        886
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "894     if expect_attaching:\n895         assert pageserver_http.tenant_status(delete_tenant_id)[\"state\"][\"slug\"] == \"Attaching\"\n896 \n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 895,
      "line_range": [
        895
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "900         def shutting_down():\n901             assert pageserver.log_contains(\".*Waiting for timelines.*\") is not None\n902 \n",
      "col_offset": 12,
      "end_col_offset": 83,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 901,
      "line_range": [
        901
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "973         details = client.timeline_detail(tenant_id, timeline_id)\n974         assert details[\"current_logical_size_is_accurate\"] is False\n975 \n",
      "col_offset": 8,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 974,
      "line_range": [
        974
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "982     details = client.timeline_detail(tenant_id, timeline_id, force_await_initial_logical_size=True)\n983     assert details[\"current_logical_size_is_accurate\"] is True\n984 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 983,
      "line_range": [
        983
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1031         log.info(f\"{states}\")\n1032         assert len(states[\"Active\"]) == 1\n1033 \n",
      "col_offset": 8,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1032,
      "line_range": [
        1032
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1037         states = get_tenant_states()\n1038         assert len(states[\"Attaching\"]) == 1\n1039 \n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1038,
      "line_range": [
        1038
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1043         resp = client.tenant_status(eager_tenant)\n1044         assert resp[\"state\"][\"slug\"] == \"Active\"\n1045 \n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1044,
      "line_range": [
        1044
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1097         resp = client.tenant_status(env.initial_tenant)\n1098         assert resp[\"state\"][\"slug\"] == \"Active\"\n1099 \n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1098,
      "line_range": [
        1098
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1119         resp = client.tenant_status(lazy_tenant)\n1120         assert resp[\"state\"][\"slug\"] == \"Attaching\"\n1121 \n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1120,
      "line_range": [
        1120
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1130         resp = client.tenant_status(lazy_tenant)\n1131         assert resp[\"state\"][\"slug\"] == \"Active\"\n1132 \n",
      "col_offset": 8,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_timeline_size.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1131,
      "line_range": [
        1131
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "33     cur.execute(\"create table t1(x integer)\")\n34     cur.execute(f\"insert into t1 values (generate_series(1,{n_records}))\")\n35     cur.execute(\"vacuum t1\")\n",
      "col_offset": 18,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_truncate.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 34,
      "line_range": [
        34
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "36     for _ in range(n_iter):\n37         cur.execute(f\"delete from t1 where x>{n_records//2}\")\n38         cur.execute(\"vacuum t1\")\n",
      "col_offset": 22,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_truncate.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 37,
      "line_range": [
        37
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "39         time.sleep(1)  # let pageserver a chance to create image layers\n40         cur.execute(f\"insert into t1 values (generate_series({n_records//2+1}, {n_records}))\")\n41         cur.execute(\"vacuum t1\")\n",
      "col_offset": 22,
      "end_col_offset": 61,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_truncate.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 40,
      "line_range": [
        40
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "45     res = cur.fetchone()\n46     assert res is not None\n47     assert res[0] == n_records\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_truncate.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 46,
      "line_range": [
        46
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "46     assert res is not None\n47     assert res[0] == n_records\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_truncate.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "55     log.info(twophase_files)\n56     assert len(twophase_files) == 4\n57 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_twophase.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 56,
      "line_range": [
        56
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "63     log.info(twophase_files)\n64     assert len(twophase_files) == 2\n65 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_twophase.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 64,
      "line_range": [
        64
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77     log.info(twophase_files2)\n78     assert twophase_files2.sort() == twophase_files.sort()\n79 \n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_twophase.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "88     cur2.execute(\"SELECT * FROM foo\")\n89     assert cur2.fetchall() == [(\"one\",), (\"three\",)]\n90 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_twophase.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 89,
      "line_range": [
        89
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "92     cur.execute(\"SELECT * FROM foo\")\n93     assert cur.fetchall() == [(\"three\",)]\n94 \n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_twophase.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 93,
      "line_range": [
        93
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "45     if env.pg_version <= PgVersion.V14:\n46         assert results == [(43, 2)]\n47     else:\n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_unlogged.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 46,
      "line_range": [
        46
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "47     else:\n48         assert results == [(43, 1)]\n49 \n",
      "col_offset": 8,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_unlogged.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 48,
      "line_range": [
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "79     cur.execute(\"SELECT id FROM vmtest_delete WHERE id = 1\")\n80     assert cur.fetchall() == []\n81     cur.execute(\"SELECT id FROM vmtest_hot_update WHERE id = 1\")\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 80,
      "line_range": [
        80
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "81     cur.execute(\"SELECT id FROM vmtest_hot_update WHERE id = 1\")\n82     assert cur.fetchall() == [(1,)]\n83     cur.execute(\"SELECT id FROM vmtest_cold_update WHERE id = 1\")\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 82,
      "line_range": [
        82
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "83     cur.execute(\"SELECT id FROM vmtest_cold_update WHERE id = 1\")\n84     assert cur.fetchall() == []\n85     cur.execute(\"SELECT id FROM vmtest_cold_update2 WHERE id = 1\")\n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 84,
      "line_range": [
        84
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "85     cur.execute(\"SELECT id FROM vmtest_cold_update2 WHERE id = 1\")\n86     assert cur.fetchall() == []\n87 \n",
      "col_offset": 4,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 86,
      "line_range": [
        86
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "109     cur_new.execute(\"SELECT id FROM vmtest_delete WHERE id = 1\")\n110     assert cur_new.fetchall() == []\n111     cur_new.execute(\"SELECT id FROM vmtest_hot_update WHERE id = 1\")\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 110,
      "line_range": [
        110
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "111     cur_new.execute(\"SELECT id FROM vmtest_hot_update WHERE id = 1\")\n112     assert cur_new.fetchall() == [(1,)]\n113     cur_new.execute(\"SELECT id FROM vmtest_cold_update WHERE id = 1\")\n",
      "col_offset": 4,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 112,
      "line_range": [
        112
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "113     cur_new.execute(\"SELECT id FROM vmtest_cold_update WHERE id = 1\")\n114     assert cur_new.fetchall() == []\n115     cur_new.execute(\"SELECT id FROM vmtest_cold_update2 WHERE id = 1\")\n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 114,
      "line_range": [
        114
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "115     cur_new.execute(\"SELECT id FROM vmtest_cold_update2 WHERE id = 1\")\n116     assert cur_new.fetchall() == []\n117 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 116,
      "line_range": [
        116
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "164     )\n165     assert (\n166         relfrozenxid > xid\n167     ), f\"Inserted rows were not frozen. This can be caused by concurrent activity in the database. (XID {xid}, relfrozenxid {relfrozenxid}\"\n168 \n",
      "col_offset": 4,
      "end_col_offset": 139,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 165,
      "line_range": [
        165,
        166,
        167
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "191 \n192     assert vm_page_at_pageserver == vm_page_in_cache\n193 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "276     curr_xid = int(cur.fetchall()[0][0])\n277     assert curr_xid - locking_xid >= 100000\n278 \n",
      "col_offset": 4,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_vm_bits.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 277,
      "line_range": [
        277
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "8 import signal\n9 import subprocess\n10 import sys\n",
      "col_offset": 0,
      "end_col_offset": 17,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Consider possible security implications associated with the subprocess module.",
      "line_number": 9,
      "line_range": [
        9
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_imports.html#b404-import-subprocess",
      "test_id": "B404",
      "test_name": "blacklist"
    },
    {
      "code": "191                 # Invariant. May be < when transaction is in progress.\n192                 assert (\n193                     commit_lsn <= flush_lsn\n194                 ), f\"timeline_id={timeline_id}, timeline_detail={timeline_detail}, sk_metrics={sk_metrics}\"\n195             # We only call collect_metrics() after a transaction is confirmed by\n",
      "col_offset": 16,
      "end_col_offset": 107,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 192,
      "line_range": [
        192,
        193,
        194
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "197             # has confirmed the transaction. We assume majority consensus here.\n198             assert (\n199                 2 * sum(m.last_record_lsn <= lsn for lsn in m.flush_lsns)\n200                 > neon_env_builder.num_safekeepers\n201             ), f\"timeline_id={timeline_id}, timeline_detail={timeline_detail}, sk_metrics={sk_metrics}\"\n202             assert (\n",
      "col_offset": 12,
      "end_col_offset": 103,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 198,
      "line_range": [
        198,
        199,
        200,
        201
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "201             ), f\"timeline_id={timeline_id}, timeline_detail={timeline_detail}, sk_metrics={sk_metrics}\"\n202             assert (\n203                 2 * sum(m.last_record_lsn <= lsn for lsn in m.commit_lsns)\n204                 > neon_env_builder.num_safekeepers\n205             ), f\"timeline_id={timeline_id}, timeline_detail={timeline_detail}, sk_metrics={sk_metrics}\"\n206             timeline_metrics.append(m)\n",
      "col_offset": 12,
      "end_col_offset": 103,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 202,
      "line_range": [
        202,
        203,
        204,
        205
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "238                 exc_type, exc_value, exc_tb = sys.exc_info()\n239                 assert exc_type\n240                 e = exc_type(exc_value)\n",
      "col_offset": 16,
      "end_col_offset": 31,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 239,
      "line_range": [
        239
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "262         res = endpoint.safe_psql(\"SELECT sum(key) FROM t\")\n263         assert res[0] == (5000050000,)\n264 \n",
      "col_offset": 8,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 263,
      "line_range": [
        263
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "268     middle_lsn = Lsn((int(init_m[0].last_record_lsn) + int(final_m[0].last_record_lsn)) // 2)\n269     assert max(init_m[0].flush_lsns) < middle_lsn < min(final_m[0].flush_lsns)\n270     assert max(init_m[0].commit_lsns) < middle_lsn < min(final_m[0].commit_lsns)\n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 269,
      "line_range": [
        269
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "269     assert max(init_m[0].flush_lsns) < middle_lsn < min(final_m[0].flush_lsns)\n270     assert max(init_m[0].commit_lsns) < middle_lsn < min(final_m[0].commit_lsns)\n271     assert max(init_m[1].flush_lsns) < middle_lsn < min(final_m[1].flush_lsns)\n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 270,
      "line_range": [
        270
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "270     assert max(init_m[0].commit_lsns) < middle_lsn < min(final_m[0].commit_lsns)\n271     assert max(init_m[1].flush_lsns) < middle_lsn < min(final_m[1].flush_lsns)\n272     assert max(init_m[1].commit_lsns) < middle_lsn < min(final_m[1].commit_lsns)\n",
      "col_offset": 4,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 271,
      "line_range": [
        271
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "271     assert max(init_m[1].flush_lsns) < middle_lsn < min(final_m[1].flush_lsns)\n272     assert max(init_m[1].commit_lsns) < middle_lsn < min(final_m[1].commit_lsns)\n273     assert max(init_m[2].flush_lsns) <= min(final_m[2].flush_lsns) < middle_lsn\n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 272,
      "line_range": [
        272
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "272     assert max(init_m[1].commit_lsns) < middle_lsn < min(final_m[1].commit_lsns)\n273     assert max(init_m[2].flush_lsns) <= min(final_m[2].flush_lsns) < middle_lsn\n274     assert max(init_m[2].commit_lsns) <= min(final_m[2].commit_lsns) < middle_lsn\n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 273,
      "line_range": [
        273
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "273     assert max(init_m[2].flush_lsns) <= min(final_m[2].flush_lsns) < middle_lsn\n274     assert max(init_m[2].commit_lsns) <= min(final_m[2].commit_lsns) < middle_lsn\n275 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 274,
      "line_range": [
        274
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "277     http_cli = env.safekeepers[0].http_client()\n278     assert len(http_cli.timeline_list()) == 3\n279 \n",
      "col_offset": 4,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 278,
      "line_range": [
        278
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "304 \n305         if random.random() <= fault_probability:\n306             if failed_node is None:\n",
      "col_offset": 11,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 305,
      "line_range": [
        305
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "306             if failed_node is None:\n307                 failed_node = env.safekeepers[random.randrange(0, n_acceptors)]\n308                 failed_node.stop()\n",
      "col_offset": 46,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 307,
      "line_range": [
        307
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "311                 failed_node = None\n312     assert query_scalar(cur, \"SELECT sum(key) FROM t\") == (n_inserts * (n_inserts + 1)) // 2\n313 \n",
      "col_offset": 4,
      "end_col_offset": 92,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 312,
      "line_range": [
        312
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "368     log.info(f\"statuses after {stat_after_restart}\")\n369     assert all([s.remote_consistent_lsn >= new_rcl for s in stat_after_restart])\n370 \n",
      "col_offset": 4,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 369,
      "line_range": [
        369
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "407     ]\n408     assert all(os.path.exists(p) for p in first_segments)\n409 \n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 408,
      "line_range": [
        408
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "425         ).backup_lsn\n426         assert \"FFFFFFFF/FEFFFFFF\" != old_backup_lsn\n427         for cli in [http_cli_other, http_cli_noauth]:\n",
      "col_offset": 8,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 426,
      "line_range": [
        426
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "431                 )\n432         assert (\n433             old_backup_lsn\n434             == http_cli.timeline_status(tenant_id=tenant_id, timeline_id=timeline_id).backup_lsn\n435         )\n436     http_cli.record_safekeeper_info(tenant_id, timeline_id, {\"backup_lsn\": \"FFFFFFFF/FEFFFFFF\"})\n",
      "col_offset": 8,
      "end_col_offset": 9,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 432,
      "line_range": [
        432,
        433,
        434,
        435
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "436     http_cli.record_safekeeper_info(tenant_id, timeline_id, {\"backup_lsn\": \"FFFFFFFF/FEFFFFFF\"})\n437     assert (\n438         Lsn(\"FFFFFFFF/FEFFFFFF\")\n439         == http_cli.timeline_status(tenant_id=tenant_id, timeline_id=timeline_id).backup_lsn\n440     )\n441 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 437,
      "line_range": [
        437,
        438,
        439,
        440
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "585 \n586             assert query_scalar(cur, \"select sum(key) from t\") == expected_sum\n587 \n",
      "col_offset": 12,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 586,
      "line_range": [
        586
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "705 \n706     assert endpoint.safe_psql(\"select sum(key) from t\")[0][0] == expected_sum\n707 \n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 706,
      "line_range": [
        706
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "847 \n848     assert all(lsn_after_sync == lsn for lsn in lsn_after_append)\n849 \n",
      "col_offset": 4,
      "end_col_offset": 65,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 848,
      "line_range": [
        848
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "897     log.info(f\"debug_dump before reboot {debug_dump_0}\")\n898     assert debug_dump_0[\"timelines_count\"] == 1\n899     assert debug_dump_0[\"timelines\"][0][\"timeline_id\"] == str(timeline_id)\n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 898,
      "line_range": [
        898
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "898     assert debug_dump_0[\"timelines_count\"] == 1\n899     assert debug_dump_0[\"timelines\"][0][\"timeline_id\"] == str(timeline_id)\n900     assert debug_dump_0[\"timelines\"][0][\"wal_last_modified\"] != \"\"\n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 899,
      "line_range": [
        899
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "899     assert debug_dump_0[\"timelines\"][0][\"timeline_id\"] == str(timeline_id)\n900     assert debug_dump_0[\"timelines\"][0][\"wal_last_modified\"] != \"\"\n901 \n",
      "col_offset": 4,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 900,
      "line_range": [
        900
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "906     log.info(f\"debug_dump_non_existend: {debug_dump_non_existent}\")\n907     assert len(debug_dump_non_existent[\"timelines\"]) == 0\n908 \n",
      "col_offset": 4,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 907,
      "line_range": [
        907
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "916     term_after_reboot = tli_status.term\n917     assert term_after_reboot > term\n918 \n",
      "col_offset": 4,
      "end_col_offset": 35,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 917,
      "line_range": [
        917
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "919     # and timeline_start_lsn stays the same\n920     assert tli_status.timeline_start_lsn == timeline_start_lsn\n921 \n",
      "col_offset": 4,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 920,
      "line_range": [
        920
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "924     log.info(f\"debug_dump after reboot {debug_dump_1}\")\n925     assert debug_dump_1[\"timelines_count\"] == 1\n926     assert debug_dump_1[\"timelines\"][0][\"timeline_id\"] == str(timeline_id)\n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 925,
      "line_range": [
        925
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "925     assert debug_dump_1[\"timelines_count\"] == 1\n926     assert debug_dump_1[\"timelines\"][0][\"timeline_id\"] == str(timeline_id)\n927 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 926,
      "line_range": [
        926
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "928     # check that commit_lsn and flush_lsn not decreased\n929     assert (\n930         debug_dump_1[\"timelines\"][0][\"memory\"][\"mem_state\"][\"commit_lsn\"]\n931         >= debug_dump_0[\"timelines\"][0][\"memory\"][\"mem_state\"][\"commit_lsn\"]\n932     )\n933     assert (\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 929,
      "line_range": [
        929,
        930,
        931,
        932
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "932     )\n933     assert (\n934         debug_dump_1[\"timelines\"][0][\"memory\"][\"flush_lsn\"]\n935         >= debug_dump_0[\"timelines\"][0][\"memory\"][\"flush_lsn\"]\n936     )\n937 \n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 933,
      "line_range": [
        933,
        934,
        935,
        936
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "938     # check .config in response\n939     assert debug_dump_1[\"config\"][\"id\"] == env.safekeepers[0].id\n940 \n",
      "col_offset": 4,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 939,
      "line_range": [
        939
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "978             cur.consume_stream(dummy_consumer)\n979         assert \"failed to acquire term 3\" in str(excinfo.value)\n980 \n",
      "col_offset": 8,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 979,
      "line_range": [
        979
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1057     for _i in range(3):\n1058         random_sk = random.choice(env.safekeepers)\n1059         random_sk.stop()\n",
      "col_offset": 20,
      "end_col_offset": 50,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 1058,
      "line_range": [
        1058
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "1062             with conn.cursor() as cur:\n1063                 start = random.randint(1, 100000)\n1064                 end = start + random.randint(1, 10000)\n",
      "col_offset": 24,
      "end_col_offset": 49,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 1063,
      "line_range": [
        1063
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "1063                 start = random.randint(1, 100000)\n1064                 end = start + random.randint(1, 10000)\n1065                 cur.execute(\"insert into t select generate_series(%s,%s)\", (start, end))\n",
      "col_offset": 30,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 1064,
      "line_range": [
        1064
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "1170 def cmp_sk_wal(sks: list[Safekeeper], tenant_id: TenantId, timeline_id: TimelineId):\n1171     assert len(sks) >= 2, \"cmp_sk_wal makes sense with >= 2 safekeepers passed\"\n1172     sk_http_clis = [sk.http_client() for sk in sks]\n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1171,
      "line_range": [
        1171
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1178     for tfl, sk in zip(term_flush_lsns[1:], sks[1:]):\n1179         assert (\n1180             term_flush_lsns[0] == tfl\n1181         ), f\"(last_log_term, flush_lsn) are not equal on sks {sks[0].id} and {sk.id}: {term_flush_lsns[0]} != {tfl}\"\n1182 \n",
      "col_offset": 8,
      "end_col_offset": 116,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1179,
      "line_range": [
        1179,
        1180,
        1181
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1185     for cmp_segs, sk in zip(segs[1:], sks[1:]):\n1186         assert (\n1187             segs[0] == cmp_segs\n1188         ), f\"lists of segments on sks {sks[0].id} and {sk.id} are not identic: {segs[0]} and {cmp_segs}\"\n1189     log.info(f\"comparing segs {segs[0]}\")\n",
      "col_offset": 8,
      "end_col_offset": 104,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1186,
      "line_range": [
        1186,
        1187,
        1188
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1208             with open(stdout_filename, \"w\") as stdout_f:\n1209                 subprocess.run(f\"xxd {f1} > {f1}.hex \", shell=True)\n1210                 subprocess.run(f\"xxd {f2} > {f2}.hex \", shell=True)\n",
      "col_offset": 16,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 1209,
      "line_range": [
        1209
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    },
    {
      "code": "1209                 subprocess.run(f\"xxd {f1} > {f1}.hex \", shell=True)\n1210                 subprocess.run(f\"xxd {f2} > {f2}.hex \", shell=True)\n1211 \n",
      "col_offset": 16,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 1210,
      "line_range": [
        1210
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    },
    {
      "code": "1212                 cmd = f\"diff {f1}.hex {f2}.hex\"\n1213                 subprocess.run([cmd], stdout=stdout_f, shell=True)\n1214 \n",
      "col_offset": 16,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 78,
        "link": "https://cwe.mitre.org/data/definitions/78.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "subprocess call with shell=True identified, security issue.",
      "line_number": 1213,
      "line_range": [
        1213
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true"
    },
    {
      "code": "1214 \n1215             assert (mismatch, not_regular) == (\n1216                 [],\n1217                 [],\n1218             ), f\"WAL segs {f1} and {f2} on sks {sks[0].id} and {sk.id} are not identic\"\n1219 \n",
      "col_offset": 12,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1215,
      "line_range": [
        1215,
        1216,
        1217,
        1218
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1310     # there shouldn't be more than 2 WAL segments (but dir may have archive_status files)\n1311     assert ep.get_pg_wal_size() < 16 * 2.5\n1312 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1311,
      "line_range": [
        1311
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1332     # there shouldn't be more than 2 WAL segments (but dir may have archive_status files)\n1333     assert ep.get_pg_wal_size() < 16 * 2.5\n1334 \n",
      "col_offset": 4,
      "end_col_offset": 42,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1333,
      "line_range": [
        1333
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1384     )\n1385     assert sk2_tli_status.flush_lsn - sk1_tli_status.flush_lsn >= 16 * 1024 * 1024\n1386 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1385,
      "line_range": [
        1385
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1393     )\n1394     assert sk2_tli_status.flush_lsn - sk1_tli_status.flush_lsn >= 16 * 1024 * 1024\n1395 \n",
      "col_offset": 4,
      "end_col_offset": 82,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1394,
      "line_range": [
        1394
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1437     # must be actually higher\n1438     assert commit_lsn > ckpt_lsn, \"safekeeper must have checkpoint record\"\n1439 \n",
      "col_offset": 4,
      "end_col_offset": 74,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1438,
      "line_range": [
        1438
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1461     def init(self) -> SafekeeperEnv:\n1462         assert self.postgres is None, \"postgres is already initialized\"\n1463         assert self.safekeepers is None, \"safekeepers are already initialized\"\n",
      "col_offset": 8,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1462,
      "line_range": [
        1462
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1462         assert self.postgres is None, \"postgres is already initialized\"\n1463         assert self.safekeepers is None, \"safekeepers are already initialized\"\n1464 \n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1463,
      "line_range": [
        1463
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1519     def get_safekeeper_connstrs(self):\n1520         assert self.safekeepers is not None, \"safekeepers are not initialized\"\n1521         return \",\".join([sk_proc.args[2] for sk_proc in self.safekeepers])\n",
      "col_offset": 8,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1520,
      "line_range": [
        1520
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1523     def create_postgres(self):\n1524         assert self.tenant_id is not None, \"tenant_id is not initialized\"\n1525         assert self.timeline_id is not None, \"tenant_id is not initialized\"\n",
      "col_offset": 8,
      "end_col_offset": 73,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1524,
      "line_range": [
        1524
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1524         assert self.tenant_id is not None, \"tenant_id is not initialized\"\n1525         assert self.timeline_id is not None, \"tenant_id is not initialized\"\n1526         pgdata_dir = os.path.join(self.repo_dir, \"proposer_pgdata\")\n",
      "col_offset": 8,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1525,
      "line_range": [
        1525
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1578         env.init()\n1579         assert env.postgres is not None\n1580 \n",
      "col_offset": 8,
      "end_col_offset": 39,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1579,
      "line_range": [
        1579
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1583         res = env.postgres.safe_psql(\"select sum(i) from t\")[0][0]\n1584         assert res == 5050\n1585 \n",
      "col_offset": 8,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1584,
      "line_range": [
        1584
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1598                 sum_after = query_scalar(cur, \"SELECT SUM(key) FROM t\")\n1599                 assert sum_after == sum_before + 5000050000\n1600 \n",
      "col_offset": 16,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1599,
      "line_range": [
        1599
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1707         sk_http_noauth = sk.http_client(gen_sk_wide_token=False)\n1708     assert (sk_data_dir / str(tenant_id) / str(timeline_id_1)).is_dir()\n1709     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1708,
      "line_range": [
        1708
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1708     assert (sk_data_dir / str(tenant_id) / str(timeline_id_1)).is_dir()\n1709     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n1710     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1709,
      "line_range": [
        1709
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1709     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n1710     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n1711     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1710,
      "line_range": [
        1710
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1710     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n1711     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1712     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1711,
      "line_range": [
        1711
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1711     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1712     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n1713 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1712,
      "line_range": [
        1712
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1730     # Remove initial tenant's br1 (active)\n1731     assert sk_http.timeline_delete(tenant_id, timeline_id_1)[\"dir_existed\"]\n1732     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1731,
      "line_range": [
        1731
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1731     assert sk_http.timeline_delete(tenant_id, timeline_id_1)[\"dir_existed\"]\n1732     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n1733     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1732,
      "line_range": [
        1732
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1732     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n1733     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n1734     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1733,
      "line_range": [
        1733
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1733     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n1734     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n1735     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1734,
      "line_range": [
        1734
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1734     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n1735     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1736     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1735,
      "line_range": [
        1735
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1735     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1736     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n1737 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1736,
      "line_range": [
        1736
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1738     # Ensure repeated deletion succeeds\n1739     assert not sk_http.timeline_delete(tenant_id, timeline_id_1)[\"dir_existed\"]\n1740     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n",
      "col_offset": 4,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1739,
      "line_range": [
        1739
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1739     assert not sk_http.timeline_delete(tenant_id, timeline_id_1)[\"dir_existed\"]\n1740     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n1741     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1740,
      "line_range": [
        1740
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1740     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n1741     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n1742     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1741,
      "line_range": [
        1741
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1741     assert (sk_data_dir / str(tenant_id) / str(timeline_id_2)).is_dir()\n1742     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n1743     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1742,
      "line_range": [
        1742
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1742     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n1743     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1744     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1743,
      "line_range": [
        1743
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1743     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1744     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n1745 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1744,
      "line_range": [
        1744
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1749             with pytest.raises(sk_h.HTTPError, match=\"Forbidden|Unauthorized\"):\n1750                 assert sk_h.timeline_delete(tenant_id_other, timeline_id_other)\n1751             with pytest.raises(sk_h.HTTPError, match=\"Forbidden|Unauthorized\"):\n",
      "col_offset": 16,
      "end_col_offset": 79,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1750,
      "line_range": [
        1750
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1751             with pytest.raises(sk_h.HTTPError, match=\"Forbidden|Unauthorized\"):\n1752                 assert sk_h.tenant_delete_force(tenant_id_other)\n1753         assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n",
      "col_offset": 16,
      "end_col_offset": 64,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1752,
      "line_range": [
        1752
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1752                 assert sk_h.tenant_delete_force(tenant_id_other)\n1753         assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n1754 \n",
      "col_offset": 8,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1753,
      "line_range": [
        1753
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1755     # Remove initial tenant's br2 (inactive)\n1756     assert sk_http.timeline_delete(tenant_id, timeline_id_2)[\"dir_existed\"]\n1757     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1756,
      "line_range": [
        1756
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1756     assert sk_http.timeline_delete(tenant_id, timeline_id_2)[\"dir_existed\"]\n1757     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n1758     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_2)).exists()\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1757,
      "line_range": [
        1757
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1757     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n1758     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_2)).exists()\n1759     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1758,
      "line_range": [
        1758
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1758     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_2)).exists()\n1759     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n1760     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1759,
      "line_range": [
        1759
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1759     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).is_dir()\n1760     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1761     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1760,
      "line_range": [
        1760
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1760     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1761     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n1762 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1761,
      "line_range": [
        1761
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1763     # Remove non-existing branch, should succeed\n1764     assert not sk_http.timeline_delete(tenant_id, TimelineId(\"00\" * 16))[\"dir_existed\"]\n1765     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n",
      "col_offset": 4,
      "end_col_offset": 87,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1764,
      "line_range": [
        1764
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1764     assert not sk_http.timeline_delete(tenant_id, TimelineId(\"00\" * 16))[\"dir_existed\"]\n1765     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n1766     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_2)).exists()\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1765,
      "line_range": [
        1765
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1765     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_1)).exists()\n1766     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_2)).exists()\n1767     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).exists()\n",
      "col_offset": 4,
      "end_col_offset": 75,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1766,
      "line_range": [
        1766
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1766     assert not (sk_data_dir / str(tenant_id) / str(timeline_id_2)).exists()\n1767     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).exists()\n1768     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1767,
      "line_range": [
        1767
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1767     assert (sk_data_dir / str(tenant_id) / str(timeline_id_3)).exists()\n1768     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1769     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1768,
      "line_range": [
        1768
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1768     assert (sk_data_dir / str(tenant_id) / str(timeline_id_4)).is_dir()\n1769     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n1770 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1769,
      "line_range": [
        1769
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1772     response = sk_http.tenant_delete_force(tenant_id)\n1773     assert response[str(timeline_id_3)][\"dir_existed\"]\n1774     assert not (sk_data_dir / str(tenant_id)).exists()\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1773,
      "line_range": [
        1773
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1773     assert response[str(timeline_id_3)][\"dir_existed\"]\n1774     assert not (sk_data_dir / str(tenant_id)).exists()\n1775     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1774,
      "line_range": [
        1774
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1774     assert not (sk_data_dir / str(tenant_id)).exists()\n1775     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n1776 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1775,
      "line_range": [
        1775
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1779     # assert response == {}\n1780     assert not (sk_data_dir / str(tenant_id)).exists()\n1781     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n",
      "col_offset": 4,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1780,
      "line_range": [
        1780
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1780     assert not (sk_data_dir / str(tenant_id)).exists()\n1781     assert (sk_data_dir / str(tenant_id_other) / str(timeline_id_other)).is_dir()\n1782 \n",
      "col_offset": 4,
      "end_col_offset": 81,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1781,
      "line_range": [
        1781
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1807                 sum_after = query_scalar(cur, \"SELECT SUM(key) FROM t\")\n1808                 assert sum_after == sum_before + 5000050000\n1809 \n",
      "col_offset": 16,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1808,
      "line_range": [
        1808
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1918     )\n1919     assert lsn > Lsn(\"0/2000000\")\n1920     # Checkpoint timeline beyond lsn.\n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1919,
      "line_range": [
        1919
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1933     log.info(f\"flush_lsn on dst after pull_timeline: {dst_flush_lsn}\")\n1934     assert dst_flush_lsn >= src_flush_lsn\n1935     digests = [\n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1934,
      "line_range": [
        1934
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1938     ]\n1939     assert digests[0] == digests[1], f\"digest on src is {digests[0]} but on dst is {digests[1]}\"\n1940 \n",
      "col_offset": 4,
      "end_col_offset": 96,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1939,
      "line_range": [
        1939
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "1993     term_after = src_http.timeline_status(tenant_id, timeline_id).term\n1994     assert term_after > term_before, f\"term_after={term_after}, term_before={term_before}\"\n1995 \n",
      "col_offset": 4,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 1994,
      "line_range": [
        1994
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2037         # here we check for 5 to prevent flakiness\n2038         assert total.get(\"START_REPLICATION\", 0) <= 5\n2039 \n",
      "col_offset": 8,
      "end_col_offset": 53,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2038,
      "line_range": [
        2038
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2041         # here we check for 15 to prevent flakiness\n2042         assert total.get(\"START_WAL_PUSH\", 0) <= 15\n2043 \n",
      "col_offset": 8,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2042,
      "line_range": [
        2042
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2064     # pageserver should connect to safekeepers at least once\n2065     assert final_stats.get(\"START_REPLICATION\", 0) >= 1\n2066     # walproposer should connect to each safekeeper at least once\n",
      "col_offset": 4,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2065,
      "line_range": [
        2065
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2066     # walproposer should connect to each safekeeper at least once\n2067     assert final_stats.get(\"START_WAL_PUSH\", 0) >= 3\n2068 \n",
      "col_offset": 4,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2067,
      "line_range": [
        2067
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2154 \n2155             assert orig_digest == new_digest\n2156 \n",
      "col_offset": 12,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2155,
      "line_range": [
        2155
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2191 \n2192     assert timeline_start_lsn_after == \"0/1\"\n2193     env.safekeepers[0].stop().start()\n",
      "col_offset": 4,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2192,
      "line_range": [
        2192
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2204     log.info(f\"dump_control_file response: {res}\")\n2205     assert res[\"timelines\"][0][\"control_file\"][\"timeline_start_lsn\"] == \"0/1\"\n2206 \n",
      "col_offset": 4,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2205,
      "line_range": [
        2205
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2225     log.info(f\"bump to {bump_to} res: {res}\")\n2226     assert res.current_term >= bump_to\n2227 \n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2226,
      "line_range": [
        2226
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2230     log.info(f\"bump to None res: {res}\")\n2231     assert res.current_term > bump_to\n2232     assert res.current_term > res.previous_term\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2231,
      "line_range": [
        2231
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2231     assert res.current_term > bump_to\n2232     assert res.current_term > res.previous_term\n2233 \n",
      "col_offset": 4,
      "end_col_offset": 47,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2232,
      "line_range": [
        2232
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2236     log.info(f\"bump to 2 res: {res}\")\n2237     assert res.current_term > bump_to\n2238     assert res.current_term == res.previous_term\n",
      "col_offset": 4,
      "end_col_offset": 37,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2237,
      "line_range": [
        2237
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2237     assert res.current_term > bump_to\n2238     assert res.current_term == res.previous_term\n2239 \n",
      "col_offset": 4,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2238,
      "line_range": [
        2238
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2360 \n2361         i = random.randint(0, n_timelines - 1)\n2362         log.info(f\"Starting endpoint {i}\")\n",
      "col_offset": 12,
      "end_col_offset": 46,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 2361,
      "line_range": [
        2361
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "2365         res = endpoints[i].safe_psql(\"UPDATE t SET i = i + 1 RETURNING i\")\n2366         assert res[0][0] == check_values[i]\n2367 \n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2366,
      "line_range": [
        2366
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2398         for sk in env.safekeepers:\n2399             if random.random() < restart_chance:\n2400                 sk.stop().start()\n",
      "col_offset": 15,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 2399,
      "line_range": [
        2399
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "2404     # TODO: require eviction in each safekeeper after https://github.com/neondatabase/neon/issues/8148 is fixed\n2405     assert any(\n2406         sk.log_contains(\"successfully evicted timeline\")\n2407         and sk.log_contains(\"successfully restored evicted timeline\")\n2408         for sk in env.safekeepers\n2409     )\n2410     assert event_metrics_seen\n",
      "col_offset": 4,
      "end_col_offset": 5,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2405,
      "line_range": [
        2405,
        2406,
        2407,
        2408,
        2409
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2409     )\n2410     assert event_metrics_seen\n2411 \n",
      "col_offset": 4,
      "end_col_offset": 29,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2410,
      "line_range": [
        2410
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2423         n_evicted = sk.http_client().get_metric_value(\"safekeeper_evicted_timelines\")\n2424         assert n_evicted  # make mypy happy\n2425         assert int(n_evicted) == n_timelines\n",
      "col_offset": 8,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2424,
      "line_range": [
        2424
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2424         assert n_evicted  # make mypy happy\n2425         assert int(n_evicted) == n_timelines\n2426 \n",
      "col_offset": 8,
      "end_col_offset": 44,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2425,
      "line_range": [
        2425
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2435         n_evicted = sk.http_client().get_metric_value(\"safekeeper_evicted_timelines\")\n2436         assert n_evicted  # make mypy happy\n2437         assert int(n_evicted) < n_timelines\n",
      "col_offset": 8,
      "end_col_offset": 24,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2436,
      "line_range": [
        2436
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2436         assert n_evicted  # make mypy happy\n2437         assert int(n_evicted) < n_timelines\n2438 \n",
      "col_offset": 8,
      "end_col_offset": 43,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2437,
      "line_range": [
        2437
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2490     log.info(f\"uploaded segments before reset: {uploaded_segs}\")\n2491     assert len(uploaded_segs) > 0\n2492 \n",
      "col_offset": 4,
      "end_col_offset": 33,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2491,
      "line_range": [
        2491
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2502     log.info(f\"uploaded segments after reset: {uploaded_segs}\")\n2503     assert len(uploaded_segs) == 0\n2504 \n",
      "col_offset": 4,
      "end_col_offset": 34,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2503,
      "line_range": [
        2503
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2578             segs = src_sk.list_uploaded_segments(tenant_id, timeline_id)\n2579             assert candidate_seg in segs\n2580             return candidate_seg\n",
      "col_offset": 12,
      "end_col_offset": 40,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2579,
      "line_range": [
        2579
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "2634     segs = src_sk.list_uploaded_segments(tenant_id, timeline_id)\n2635     assert source_partial_segment in segs\n2636 \n",
      "col_offset": 4,
      "end_col_offset": 41,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 2635,
      "line_range": [
        2635
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "46         row = await self.conn.fetchrow(\"SELECT sum(amount) AS sum FROM bank_accs\")\n47         assert row[\"sum\"] == self.n_accounts * self.init_amount\n48 \n",
      "col_offset": 8,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 47,
      "line_range": [
        47
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "88         # every worker should finish at least one tx\n89         assert all(cnt > 0 for cnt in self.counters)\n90 \n",
      "col_offset": 8,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 89,
      "line_range": [
        89
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "101     while stats.running:\n102         from_uid = random.randint(0, n_accounts - 1)\n103         to_uid = (from_uid + random.randint(1, n_accounts - 1)) % n_accounts\n",
      "col_offset": 19,
      "end_col_offset": 52,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 102,
      "line_range": [
        102
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "102         from_uid = random.randint(0, n_accounts - 1)\n103         to_uid = (from_uid + random.randint(1, n_accounts - 1)) % n_accounts\n104         amount = random.randint(1, max_transfer)\n",
      "col_offset": 29,
      "end_col_offset": 62,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 103,
      "line_range": [
        103
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "103         to_uid = (from_uid + random.randint(1, n_accounts - 1)) % n_accounts\n104         amount = random.randint(1, max_transfer)\n105 \n",
      "col_offset": 17,
      "end_col_offset": 48,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 104,
      "line_range": [
        104
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "183     for it in range(iterations):\n184         assert time.monotonic() < test_timeout_at, \"test timed out\"\n185 \n",
      "col_offset": 8,
      "end_col_offset": 67,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 184,
      "line_range": [
        184
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "314             await exec_compute_query(\n315                 env, branch, f\"INSERT INTO t SELECT 1 FROM generate_series(1, {batch_insert})\"\n316             )\n",
      "col_offset": 31,
      "end_col_offset": 78,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 315,
      "line_range": [
        315
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "322             actual_sum = (await exec_compute_query(env, branch, \"SELECT SUM(i) FROM t\"))[0][0]\n323             assert actual_sum == sum, f\"Expected sum={sum}, actual={actual_sum}\"\n324         elif i % 4 == 2:\n",
      "col_offset": 12,
      "end_col_offset": 80,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 323,
      "line_range": [
        323
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "363                     self.branch,\n364                     f\"INSERT INTO query_log(index, verify_key) VALUES ({self.index}, {verify_key}) RETURNING verify_key\",\n365                     pgdir_name=f\"bgcompute{self.index}_key{verify_key}\",\n",
      "col_offset": 22,
      "end_col_offset": 71,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "LOW",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 364,
      "line_range": [
        364
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "378             # anything or only 1 xact during test run.\n379             await asyncio.sleep(random.uniform(0, self.MAX_QUERY_GAP_SECONDS))\n380         self.running = False\n",
      "col_offset": 32,
      "end_col_offset": 77,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 379,
      "line_range": [
        379
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "433         for verify_key in compute.successful_queries:\n434             assert verify_key in [row[2] for row in result]\n435 \n",
      "col_offset": 12,
      "end_col_offset": 59,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 434,
      "line_range": [
        434
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "455 \n456     bg_query = asyncio.create_task(conn.execute(f\"INSERT INTO t values ({key}, 'payload')\"))\n457 \n",
      "col_offset": 50,
      "end_col_offset": 72,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 456,
      "line_range": [
        456
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "459     # ensure that the query has not been executed yet\n460     assert not bg_query.done()\n461 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 460,
      "line_range": [
        460
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "464     await bg_query\n465     assert bg_query.done()\n466 \n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 465,
      "line_range": [
        465
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "484     result_sum = await conn.fetchval(\"SELECT sum(key) FROM t\")\n485     assert result_sum == 10\n486 \n",
      "col_offset": 4,
      "end_col_offset": 27,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 485,
      "line_range": [
        485
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "517     # it must still be not finished\n518     assert not bg_query.done()\n519     # note: destoy will kill compute_ctl, preventing it waiting for hanging sync-safekeepers.\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 518,
      "line_range": [
        518
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "559     # it must still be not finished\n560     assert not bg_query.done()\n561     # note: destoy will kill compute_ctl, preventing it waiting for hanging sync-safekeepers.\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 560,
      "line_range": [
        560
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "584     ]\n585     assert digests[0] == digests[1], f\"digest on sk1 is {digests[0]} but on sk3 is {digests[1]}\"\n586 \n",
      "col_offset": 4,
      "end_col_offset": 96,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 585,
      "line_range": [
        585
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "614     # it must still be not finished\n615     assert not bg_query.done()\n616     # Also restart ep at segment boundary to make test more interesting. Do it in immediate mode;\n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 615,
      "line_range": [
        615
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "647         for sk in safekeepers:\n648             if random.random() >= 0.5:\n649                 victims.append(sk)\n",
      "col_offset": 15,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 648,
      "line_range": [
        648
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "674         await asyncio.sleep(0.005)\n675         await conn.execute(f\"INSERT INTO t values ({i}, 'payload')\")\n676         expected_sum += i\n",
      "col_offset": 29,
      "end_col_offset": 51,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 675,
      "line_range": [
        675
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "681     res = await conn.fetchval(\"SELECT sum(key) FROM t\")\n682     assert res == expected_sum\n683 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 682,
      "line_range": [
        682
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "727     for it in range(n_iterations):\n728         active_sk = list(map(lambda _: random.random() >= 0.5, env.safekeepers))\n729         active_count = sum(active_sk)\n",
      "col_offset": 39,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 330,
        "link": "https://cwe.mitre.org/data/definitions/330.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
      "line_number": 728,
      "line_range": [
        728
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/blacklists/blacklist_calls.html#b311-random",
      "test_id": "B311",
      "test_name": "blacklist"
    },
    {
      "code": "741         for _ in range(n_txes):\n742             await conn.execute(f\"INSERT INTO t values ({i}, 'payload')\")\n743             expected_sum += i\n",
      "col_offset": 33,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 742,
      "line_range": [
        742
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "755     res = await conn.fetchval(\"SELECT sum(key) FROM t\")\n756     assert res == expected_sum\n757 \n",
      "col_offset": 4,
      "end_col_offset": 30,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_acceptor_async.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 756,
      "line_range": [
        756
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "34         exception_string = str(e)\n35         assert expected_timeout_error in exception_string, \"Should time out during waiting for WAL\"\n36         assert (\n",
      "col_offset": 8,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 35,
      "line_range": [
        35
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "35         assert expected_timeout_error in exception_string, \"Should time out during waiting for WAL\"\n36         assert (\n37             \"WalReceiver status: Not active\" in exception_string\n38         ), \"Walreceiver should not be active before any data writes\"\n39 \n",
      "col_offset": 8,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 36,
      "line_range": [
        36,
        37,
        38
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "44         exception_string = str(e)\n45         assert expected_timeout_error in exception_string, \"Should time out during waiting for WAL\"\n46         assert (\n",
      "col_offset": 8,
      "end_col_offset": 99,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 45,
      "line_range": [
        45
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "45         assert expected_timeout_error in exception_string, \"Should time out during waiting for WAL\"\n46         assert (\n47             \"WalReceiver status: Not active\" not in exception_string\n48         ), \"Should not be inactive anymore after INSERTs are made\"\n49         assert \"WalReceiver status\" in exception_string, \"But still should have some other status\"\n",
      "col_offset": 8,
      "end_col_offset": 66,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 46,
      "line_range": [
        46,
        47,
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "48         ), \"Should not be inactive anymore after INSERTs are made\"\n49         assert \"WalReceiver status\" in exception_string, \"But still should have some other status\"\n50 \n",
      "col_offset": 8,
      "end_col_offset": 98,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 49,
      "line_range": [
        49
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "90             exception_string = str(e)\n91             assert (\n92                 expected_timeout_error in exception_string\n93             ), \"Should time out during waiting for WAL\"\n94 \n",
      "col_offset": 12,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 91,
      "line_range": [
        91,
        92,
        93
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "95             for safekeeper in env.safekeepers:\n96                 assert (\n97                     str(safekeeper.id) in exception_string\n98                 ), f\"Should have safekeeper {safekeeper.id} printed in walreceiver state after WAL wait timeout\"\n99 \n",
      "col_offset": 16,
      "end_col_offset": 112,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 96,
      "line_range": [
        96,
        97,
        98
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "112             exception_string = str(e).split(\"stdout\", 1)[-1]\n113             assert (\n114                 expected_timeout_error in exception_string\n115             ), \"Should time out during waiting for WAL\"\n116 \n",
      "col_offset": 12,
      "end_col_offset": 55,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 113,
      "line_range": [
        113,
        114,
        115
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "118                 if safekeeper.id == stopped_safekeeper_id:\n119                     assert (\n120                         str(safekeeper.id) not in exception_string\n121                     ), f\"Should not have stopped safekeeper {safekeeper.id} printed in walreceiver state after 2nd WAL wait timeout\"\n122                 else:\n",
      "col_offset": 20,
      "end_col_offset": 132,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 119,
      "line_range": [
        119,
        120,
        121
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "122                 else:\n123                     assert (\n124                         str(safekeeper.id) in exception_string\n125                     ), f\"Should have safekeeper {safekeeper.id} printed in walreceiver state after 2nd WAL wait timeout\"\n126 \n",
      "col_offset": 20,
      "end_col_offset": 120,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 123,
      "line_range": [
        123,
        124,
        125
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "136             cur.execute(\n137                 f\"INSERT INTO t SELECT i, CONCAT('payload_', i) FROM generate_series({first_element_id},{last_element_id}) as i\"\n138             )\n",
      "col_offset": 18,
      "end_col_offset": 85,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_receiver.py",
      "issue_confidence": "MEDIUM",
      "issue_cwe": {
        "id": 89,
        "link": "https://cwe.mitre.org/data/definitions/89.html"
      },
      "issue_severity": "MEDIUM",
      "issue_text": "Possible SQL injection vector through string-based query construction.",
      "line_number": 137,
      "line_range": [
        137
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b608_hardcoded_sql_expressions.html",
      "test_id": "B608",
      "test_name": "hardcoded_sql_expressions"
    },
    {
      "code": "69         restored.start()\n70         assert restored.safe_psql(\"select count(*) from t\", user=\"cloud_admin\") == [(300000,)]\n71 \n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 70,
      "line_range": [
        70
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "84         with tarfile.open(fileobj=temp) as tfile:\n85             tfile.extractall(path=output_dir)\n86 \n",
      "col_offset": 12,
      "end_col_offset": 45,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 22,
        "link": "https://cwe.mitre.org/data/definitions/22.html"
      },
      "issue_severity": "HIGH",
      "issue_text": "tarfile.extractall used without any validation. Please check and discard dangerous members.",
      "line_number": 85,
      "line_range": [
        85
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b202_tarfile_unsafe_members.html",
      "test_id": "B202",
      "test_name": "tarfile_unsafe_members"
    },
    {
      "code": "105 \n106     assert isinstance(env.pageserver_remote_storage, LocalFsStorage)\n107 \n",
      "col_offset": 4,
      "end_col_offset": 68,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 106,
      "line_range": [
        106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "136         log.info(f\"original lsn: {original_lsn}, restored lsn: {restored_lsn}\")\n137         assert restored.safe_psql(\"select count(*) from t\", user=\"cloud_admin\") == [(300000,)]\n138 \n",
      "col_offset": 8,
      "end_col_offset": 94,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 137,
      "line_range": [
        137
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "164 \n165     assert isinstance(env.pageserver_remote_storage, S3Storage)\n166 \n",
      "col_offset": 4,
      "end_col_offset": 63,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 165,
      "line_range": [
        165
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "193     restored = env.endpoints.create_start(\"main\")\n194     assert restored.safe_psql(\"select count(*) from t\", user=\"cloud_admin\") == [(300000,)]\n",
      "col_offset": 4,
      "end_col_offset": 90,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_wal_restore.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 194,
      "line_range": [
        194
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "16         if not wal_redo_present:\n17             assert \"--wal-redo\" not in child.cmdline()\n18         if not defunct_present:\n",
      "col_offset": 12,
      "end_col_offset": 54,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_walredo_not_left_behind_on_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 17,
      "line_range": [
        17
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "18         if not defunct_present:\n19             assert child.status() != psutil.STATUS_ZOMBIE\n20 \n",
      "col_offset": 12,
      "end_col_offset": 57,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_walredo_not_left_behind_on_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 19,
      "line_range": [
        19
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "47     # assert tenant exists on disk\n48     assert (env.pageserver.tenant_dir(tenant_id)).exists()\n49 \n",
      "col_offset": 4,
      "end_col_offset": 58,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_walredo_not_left_behind_on_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 48,
      "line_range": [
        48
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "75     row = cur.fetchone()\n76     assert row is not None\n77     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n",
      "col_offset": 4,
      "end_col_offset": 26,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_walredo_not_left_behind_on_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 76,
      "line_range": [
        76
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "77     log.info(f\"shared_buffers is {row[0]}, table size {row[1]}\")\n78     assert int(row[0]) < int(row[1])\n79 \n",
      "col_offset": 4,
      "end_col_offset": 36,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_walredo_not_left_behind_on_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 78,
      "line_range": [
        78
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "80     cur.execute(\"SELECT count(*) FROM foo\")\n81     assert cur.fetchone() == (100000,)\n82 \n",
      "col_offset": 4,
      "end_col_offset": 38,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_walredo_not_left_behind_on_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 81,
      "line_range": [
        81
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    },
    {
      "code": "105     # check that nothing is left on disk for deleted tenant\n106     assert not env.pageserver.tenant_dir(tenant_id).exists()\n107 \n",
      "col_offset": 4,
      "end_col_offset": 60,
      "filename": "D:\\bandit\\upstream-repos\\neon\\test_runner\\regress\\test_walredo_not_left_behind_on_detach.py",
      "issue_confidence": "HIGH",
      "issue_cwe": {
        "id": 703,
        "link": "https://cwe.mitre.org/data/definitions/703.html"
      },
      "issue_severity": "LOW",
      "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
      "line_number": 106,
      "line_range": [
        106
      ],
      "more_info": "https://bandit.readthedocs.io/en/1.7.10/plugins/b101_assert_used.html",
      "test_id": "B101",
      "test_name": "assert_used"
    }
  ]
}